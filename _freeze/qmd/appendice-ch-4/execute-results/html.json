{
  "hash": "85037b94dba24887fab9605f0dd29e78",
  "result": {
    "markdown": "# Appendice: Chapter 4 supplemental material\n\n\n::: {.cell}\n\n:::\n\n\n::: {.callout-note}\nYou are reading the work-in-progress of this thesis. This chapter should be readable but is currently undergoing final polishing.\n:::\n\n\n## Data wrangling\n\nThe data wrangling processes were performed using the  [`targets`](https://github.com/ropensci/targets) R package. A graphical pipeline of the process can be visualized below.\n\nThe analyses are 100% reproducible. You can find all the code used in this thesis along with the computational notebooks at <https://github.com/danielvartan/mastersthesis/>.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(here)\nlibrary(targets)\n\ntargets::tar_visnetwork(\n  targets_only = TRUE, \n  script = here::here(\"_targets.R\"),\n  store = here::here(\"_targets\")\n  )\n#> here() starts at C:/Users/Daniel/Documents/GitHub/mastersthesis\n#> Using libcurl 7.84.0 with Schannel\n#> \n#> Attaching package: 'dplyr'\n#> \n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n#> \n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n#> \n#> ✔ Setting scopes to https://www.googleapis.com/auth/devstorage.full_control and https://www.googleapis.com/auth/cloud-platform\n#> ✔ Successfully auto-authenticated via C:/Users/Daniel/Documents/GitHub/mastersthesis/.auth/service-account_googlecloudstorager-editor.json\n#> ✔ Set default bucket name to 'brchrono'\n#> \n#> Attaching package: 'readr'\n#> \n#> The following object is masked from 'package:curl':\n#> \n#>     parse_date\n#> \n#> \n#> Attaching package: 'lubridate'\n#> \n#> The following object is masked from 'package:hms':\n#> \n#>     hms\n#> \n#> The following objects are masked from 'package:base':\n#> \n#>     date, intersect, setdiff, union\n#> \n#> \n#> Attaching package: 'mctq'\n#> \n#> The following objects are masked from 'package:lubritime':\n#> \n#>     assign_date, cycle_time, longer_duration, round_time,\n#>     shorter_duration, sum_time, vct_sum_time\n#> \n#> The following object is masked from 'package:gutils':\n#> \n#>     qplot_walk\n#> \n#> Carregando pacotes exigidos: rlang\n#> \n#> Attaching package: 'cowplot'\n#> \n#> The following object is masked from 'package:lubridate':\n#> \n#>     stamp\n#> \n#> \n#> Attaching package: 'moments'\n#> \n#> The following objects are masked from 'package:fBasics':\n#> \n#>     kurtosis, skewness\n#> \n#> Registered S3 method overwritten by 'quantmod':\n#>   method            from\n#>   as.zoo.data.frame zoo \n#> \n#> Attaching package: 'purrr'\n#> \n#> The following objects are masked from 'package:rlang':\n#> \n#>     %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,\n#>     flatten_raw, invoke, splice\n#> \n#> Loading required namespace: sf\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-2c03df847f1788f638ed\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2c03df847f1788f638ed\">{\"x\":{\"nodes\":{\"name\":[\"analyzed_data\",\"filtered_data\",\"geocoded_data\",\"raw_data\",\"tidy_data\",\"validated_data\"],\"type\":[\"stem\",\"stem\",\"stem\",\"stem\",\"stem\",\"stem\"],\"status\":[\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\",\"uptodate\"],\"seconds\":[205.79,0.96,0.18,15.81,7.83,190.17],\"bytes\":[10314171,7845430,8041643,12515733,6971839,6848655],\"branches\":[null,null,null,null,null,null],\"label\":[\"analyzed_data\",\"filtered_data\",\"geocoded_data\",\"raw_data\",\"tidy_data\",\"validated_data\"],\"color\":[\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\",\"#354823\"],\"id\":[\"analyzed_data\",\"filtered_data\",\"geocoded_data\",\"raw_data\",\"tidy_data\",\"validated_data\"],\"level\":[4,5,6,1,2,3],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\"]},\"edges\":{\"from\":[\"filtered_data\",\"raw_data\",\"tidy_data\",\"analyzed_data\",\"validated_data\"],\"to\":[\"geocoded_data\",\"tidy_data\",\"validated_data\",\"filtered_data\",\"analyzed_data\"],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":{\"type\":\"cubicBezier\",\"forceDirection\":\"horizontal\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1},\"layout\":{\"hierarchical\":{\"enabled\":true,\"direction\":\"LR\"}}},\"groups\":null,\"width\":null,\"height\":null,\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":{\"from\":1,\"to\":1},\"algorithm\":\"hierarchical\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":true,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":false,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":{\"label\":[\"Up to date\",\"Stem\"],\"color\":[\"#354823\",\"#899DA4\"],\"shape\":[\"dot\",\"dot\"]},\"nodesToDataframe\":true},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(dplyr)\nlibrary(here)\nlibrary(targets)\nlibrary(tidyr)\n\ndata <- \n  targets::tar_read(\"geocoded_data\", store = here::here(\"_targets\")) |>\n  dplyr::select(\n    age, sex, state, region, latitude, longitude, height, weight, work, study,\n    msf_sc, sjl, le_week, \n    ) |>\n  tidyr::drop_na(msf_sc, age, sex, latitude)\n```\n:::\n\n\n## Distribution of main variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(hms)\nlibrary(magrittr)\n\nsource(here::here(\"R/test_normality.R\"))\nsource(here::here(\"R/utils.R\"))\n\ncol <- \"age\"\n\nstats <- data |> \n  magrittr::extract2(col) |> \n  test_normality(\n    name = col, \n    threshold = hms::parse_hms(\"12:00:00\"), \n    remove_outliers = FALSE, \n    iqr_mult = 1.5, \n    log_transform = FALSE,\n    density_line = TRUE, \n    text_size = text_size,\n    print = TRUE\n  )\n#> # A tibble: 14 × 2\n#>   name    value           \n#>   <chr>   <chr>           \n#> 1 n       79198           \n#> 2 n_rm_na 79198           \n#> 3 n_na    0               \n#> 4 mean    31.9838074965417\n#> 5 var     85.2414919292643\n#> 6 sd      9.23263190695179\n#> # ℹ 8 more rows\n\nstats$stats |> list_as_tibble()\n```\n\n::: {#fig-ap-ch-4-age-var-distribution-1 .cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_rm_na </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_na </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:left;\"> 31.9838074965417 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> var </td>\n   <td style=\"text-align:left;\"> 85.2414919292643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:left;\"> 9.23263190695179 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:left;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_1 </td>\n   <td style=\"text-align:left;\"> 24.7222222222222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:left;\"> 30.5388888888889 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_3 </td>\n   <td style=\"text-align:left;\"> 37.61875 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:left;\"> 58.7861111111111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:left;\"> 12.8965277777778 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:left;\"> 0.665751526654394 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:left;\"> 2.82381488030798 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-age-var-distribution-1.png){#fig-ap-ch-4-age-var-distribution-2 width=576}\n:::\n:::\n\n\n## Geographic distribution\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(gutils)\nlibrary(here)\n\nsource(here::here(\"R/plot_brazil_uf_map.R\"))\n\ngutils:::assert_internet()\n\nbrazil_uf_map <- \n  data |> \n  plot_brazil_uf_map(option = \"viridis\", text_size = 10)\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-brazil-uf-map-1.png){#fig-ap-ch-4-brazil-uf-map width=576}\n:::\n:::\n\n\n## Age pyramid\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\n\nsource(here::here(\"R/plot_age_pyramid.R\"))\n\nage_pyramid <- \n  data |> \n  plot_age_pyramid(\n    interval = 10, \n    na_rm = TRUE, \n    text_size = text_size\n  )\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-age-pyramid-1.png){#fig-ap-ch-4-age-pyramid width=576}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n## Correlation matrix\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\n\nsource(here::here(\"R/plot_ggcorrplot.R\"))\n\ncols <- c(\"sex\", \"age\", \"latitude\", \"longitude\", \"msf_sc\", \"sjl\", \"le_week\")\n\nggcorrplot <-\n  data |>\n  plot_ggcorrplot(\n    cols = cols, \n    na_rm = TRUE, \n    text_size = text_size, \n    hc_order = TRUE\n    )\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-correlation-matrix-1.png){#fig-ap-ch-4-correlation-matrix width=576}\n:::\n:::\n\n\n## Age series\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(latex2exp)\n\nsource(here::here(\"R/plot_age_series.R\"))\n\ncol <- \"msf_sc\"\ny_lab <- latex2exp::TeX(\"Local time ($MSF_{sc}$)\")\n\ndata |>\n  dplyr::filter(age <= 50) |>\n  plot_age_series(\n    col = col, \n    y_lab = y_lab, \n    line_width = 2, \n    boundary = 0.5, \n    point_size = 1,\n    error_bar_width = 0.5, \n    error_bar_linewidth = 0.5, \n    error_bar = TRUE,\n    text_size = text_size\n    )\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-age-series-1.png){#fig-ap-ch-4-age-series width=576}\n:::\n:::\n\n\n## Chronotype\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(latex2exp)\n\nsource(here::here(\"R/plot_chronotype.R\"))\n\ncol <- \"msf_sc\"\ny_lab <- latex2exp::TeX(\"Local time ($MSF_{sc}$)\")\n\ndata |>\n  plot_chronotype(\n    col = col, \n    x_lab = \"Frequency (%)\",\n    y_lab = y_lab,\n    col_width = 0.8, \n    col_border = 0.6, \n    text_size = text_size,\n    legend_position = \"right\",\n    chronotype_cuts = FALSE\n  )\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-chronotype-1.png){#fig-ap-ch-4-chronotype width=576}\n:::\n:::\n\n\n## Latitude series\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(latex2exp)\n\nsource(here::here(\"R/plot_latitude_series.R\"))\n\ncol <- \"msf_sc\"\ny_lab <- latex2exp::TeX(\"$MSF_{sc} \\\\pm SEM$\")\n\ndata |>\n  dplyr::filter(age <= 50) |>\n  plot_latitude_series(\n    col = col, \n    y_lab = y_lab, \n    line_width = 2, \n    point_size = 3,\n    error_bar_width = 0.5, \n    error_bar_linewidth = 1, \n    error_bar = TRUE,\n    text_size = text_size\n  )\n```\n\n::: {.cell-output-display}\n![](appendice-ch-4_files/figure-html/fig-ap-ch-4-latitude-series-1.png){#fig-ap-ch-4-latitude-series width=576}\n:::\n:::\n\n\n## Statistics\n\n### Numerical variables\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(magrittr)\n\nsource(here::here(\"R/stats_sum.R\"))\nsource(here::here(\"R/utils.R\"))\n\ncol <- \"age\"\n\ndata |>\n  magrittr::extract2(col) |>\n  stats_sum(print = FALSE) |>\n  list_as_tibble()\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_rm_na </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_na </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:left;\"> 31.9838074965417 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> var </td>\n   <td style=\"text-align:left;\"> 85.2414919292643 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:left;\"> 9.23263190695179 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:left;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_1 </td>\n   <td style=\"text-align:left;\"> 24.7222222222222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:left;\"> 30.5388888888889 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_3 </td>\n   <td style=\"text-align:left;\"> 37.61875 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:left;\"> 58.7861111111111 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:left;\"> 12.8965277777778 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:left;\"> 0.665751526654394 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:left;\"> 2.82381488030798 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n### Sex\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# See <https://sidra.ibge.gov.br> to learn more.\n\nlibrary(dplyr)\nlibrary(gutils)\nlibrary(sidrar)\nlibrary(stringr)\n\ngutils:::assert_internet()\n\n# Brazil's 2010 census data\ncensus_data <- \n  sidrar::get_sidra(x = 1378) %>% # Don't change the pipe\n  dplyr::filter(\n    Sexo %in% c(\"Homens\", \"Mulheres\", \"Total\"),\n    stringr::str_detect(Idade, \"^(1[8-9]|[2-9][0-9]+) (ano|anos)$\"),\n    .[[13]] == \"Total\", \n    .[[19]] == \"Total\"\n    ) |>\n  dplyr::transmute(\n    sex = dplyr::case_when(\n      Sexo == \"Homens\" ~ \"Male\",\n      Sexo == \"Mulheres\" ~ \"Female\",\n      Sexo == \"Total\" ~ \"Total\"\n    ),\n    value = Valor\n  ) |>\n  dplyr::group_by(sex) |>\n  dplyr::summarise(n = sum(value)) |>\n  dplyr::ungroup()\n\ncensus_data <- \n  dplyr::bind_rows(\n    census_data |>\n      dplyr::filter(sex != \"Total\") |>\n      dplyr::mutate(\n        n_rel = n / sum(n[sex != \"Total\"]),\n        n_per = round(n_rel * 100, 3)\n      ),\n    census_data |>\n      dplyr::filter(sex == \"Total\") |>\n      dplyr::mutate(n_rel = 1, n_per = 100)\n  ) |>\n  dplyr::as_tibble() |>\n  dplyr::arrange(sex)\n\ncount <- data |>\n  dplyr::select(sex) |>\n  dplyr::group_by(sex) |>\n  dplyr::summarise(n = dplyr::n()) |>\n  dplyr::ungroup() |>\n  dplyr::mutate(\n    n_rel = n / sum(n),\n    n_per = round(n_rel * 100, 3)\n  ) |>\n  dplyr::arrange(dplyr::desc(n_rel)) |>\n  dplyr::bind_rows(\n    dplyr::tibble(\n      sex = \"Total\",\n      n = nrow(tidyr::drop_na(data, sex)),\n      n_rel = 1, \n      n_per = 100\n    )\n  )\n\ncount <- \n  dplyr::left_join(\n    count, census_data, \n    by = \"sex\", \n    suffix = c(\"_sample\", \"_census\")\n  ) |>\n  dplyr::mutate(\n    n_rel_diff = n_rel_sample - n_rel_census,\n    n_per_diff = n_per_sample - n_per_census\n  ) |>\n  dplyr::relocate(\n    sex, n_sample, n_census, n_rel_sample, n_rel_census, n_rel_diff,\n    n_per_sample, n_per_census, n_per_diff\n  )\n\n## Difference from the sample to the census\ncount\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> n_sample </th>\n   <th style=\"text-align:right;\"> n_census </th>\n   <th style=\"text-align:right;\"> n_rel_sample </th>\n   <th style=\"text-align:right;\"> n_rel_census </th>\n   <th style=\"text-align:right;\"> n_rel_diff </th>\n   <th style=\"text-align:right;\"> n_per_sample </th>\n   <th style=\"text-align:right;\"> n_per_census </th>\n   <th style=\"text-align:right;\"> n_per_diff </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 52463 </td>\n   <td style=\"text-align:right;\"> 69631672 </td>\n   <td style=\"text-align:right;\"> 0.662 </td>\n   <td style=\"text-align:right;\"> 0.518 </td>\n   <td style=\"text-align:right;\"> 0.144 </td>\n   <td style=\"text-align:right;\"> 66.243 </td>\n   <td style=\"text-align:right;\"> 51.793 </td>\n   <td style=\"text-align:right;\"> 14.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 26735 </td>\n   <td style=\"text-align:right;\"> 64809723 </td>\n   <td style=\"text-align:right;\"> 0.338 </td>\n   <td style=\"text-align:right;\"> 0.482 </td>\n   <td style=\"text-align:right;\"> -0.144 </td>\n   <td style=\"text-align:right;\"> 33.757 </td>\n   <td style=\"text-align:right;\"> 48.207 </td>\n   <td style=\"text-align:right;\"> -14.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 79198 </td>\n   <td style=\"text-align:right;\"> 134441395 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 1.000 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 100.000 </td>\n   <td style=\"text-align:right;\"> 100.000 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\ncount |> dplyr::select(sex, n_per_sample, n_per_census, n_per_diff)\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> n_per_sample </th>\n   <th style=\"text-align:right;\"> n_per_census </th>\n   <th style=\"text-align:right;\"> n_per_diff </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 66.243 </td>\n   <td style=\"text-align:right;\"> 51.793 </td>\n   <td style=\"text-align:right;\"> 14.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 33.757 </td>\n   <td style=\"text-align:right;\"> 48.207 </td>\n   <td style=\"text-align:right;\"> -14.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 100.000 </td>\n   <td style=\"text-align:right;\"> 100.000 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nsum(count$n_per_diff)\n#> [1] -7.105427e-15\n```\n:::\n\n\n### Sex and Age\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(dplyr)\nlibrary(magrittr)\n\nsource(here::here(\"R/stats_sum.R\"))\nsource(here::here(\"R/utils.R\"))\n\nvalue <- \"Male\"\n\ndata |>\n  dplyr::filter(sex == value) |>\n  magrittr::extract2(\"age\") |>\n  stats_sum(print = FALSE) |>\n  list_as_tibble()\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:left;\"> 26735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_rm_na </td>\n   <td style=\"text-align:left;\"> 26735 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_na </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:left;\"> 32.4343759740665 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> var </td>\n   <td style=\"text-align:left;\"> 80.9906211885464 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:left;\"> 8.99947893983571 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:left;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_1 </td>\n   <td style=\"text-align:left;\"> 25.5388888888889 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:left;\"> 31.2583333333333 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_3 </td>\n   <td style=\"text-align:left;\"> 37.9319444444444 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:left;\"> 58.7722222222222 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:left;\"> 12.3930555555556 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:left;\"> 0.617696405622681 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:left;\"> 2.84390555184727 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# See <https://sidra.ibge.gov.br> to learn more.\n\nlibrary(dplyr)\nlibrary(gutils)\nlibrary(sidrar)\nlibrary(stats)\nlibrary(stringr)\n\ngutils:::assert_internet()\n\n# Brazil's 2010 census data\ncensus_data <- \n  sidrar::get_sidra(x = 1378) %>% # Don't change the pipe\n  dplyr::filter(\n    Sexo %in% c(\"Homens\", \"Mulheres\", \"Total\"),\n    stringr::str_detect(Idade, \"^(1[8-9]|[2-9][0-9]+) (ano|anos)$\"),\n    .[[13]] == \"Total\", \n    .[[19]] == \"Total\"\n    ) |>\n  dplyr::transmute(\n    sex = dplyr::case_when(\n      Sexo == \"Homens\" ~ \"Male\",\n      Sexo == \"Mulheres\" ~ \"Female\",\n      Sexo == \"Total\" ~ \"Total\"\n    ),\n    age = as.numeric(stringr::str_extract(Idade, \"\\\\d+\")),\n    value = Valor\n  ) |>\n  dplyr::group_by(sex) |>\n  dplyr::summarise(\n    mean = stats::weighted.mean(age, value),\n    sd = sqrt(Hmisc::wtd.var(age, value))\n  ) |> \n  dplyr::ungroup() |>\n  dplyr::mutate(\n    min = c(18, 18, 18),\n    max = c(100, 100, 100)\n  ) |>\n  dplyr::relocate(sex, mean, sd, min, max) |>\n  dplyr::as_tibble()\n\ncount <- data |>\n  dplyr::select(sex, age) |>\n  dplyr::group_by(sex) |>\n  dplyr::mutate(sex = as.character(sex)) |>\n  dplyr::summarise(\n    mean = mean(age, na.rm = TRUE), \n    sd = stats::sd(age, na.rm = TRUE),\n    min = min(age, na.rm = TRUE), \n    max = max(age, na.rm = TRUE)\n    ) |>\n  dplyr::ungroup() |>\n  dplyr::bind_rows(\n    dplyr::tibble(\n      sex = \"Total\",\n      mean = mean(data$age, na.rm = TRUE), \n      sd = stats::sd(data$age, na.rm = TRUE),\n      min = min(data$age, na.rm = TRUE), \n      max = max(data$age, na.rm = TRUE)\n    )\n  )\n  \ncount <- \n  dplyr::left_join(\n    count, \n    census_data, \n    by = \"sex\", \n    suffix = c(\"_sample\", \"_census\")\n  ) |>\n  dplyr::mutate(mean_diff = mean_sample - mean_census) |>\n  dplyr::relocate(\n    sex, mean_sample, mean_census, mean_diff, sd_sample, sd_census, \n    min_sample, min_census, max_sample, max_census\n  )\n\ncount\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> mean_sample </th>\n   <th style=\"text-align:right;\"> mean_census </th>\n   <th style=\"text-align:right;\"> mean_diff </th>\n   <th style=\"text-align:right;\"> sd_sample </th>\n   <th style=\"text-align:right;\"> sd_census </th>\n   <th style=\"text-align:right;\"> min_sample </th>\n   <th style=\"text-align:right;\"> min_census </th>\n   <th style=\"text-align:right;\"> max_sample </th>\n   <th style=\"text-align:right;\"> max_census </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 31.754 </td>\n   <td style=\"text-align:right;\"> 41.645 </td>\n   <td style=\"text-align:right;\"> -9.890 </td>\n   <td style=\"text-align:right;\"> 9.341 </td>\n   <td style=\"text-align:right;\"> 16.907 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 58.786 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 32.434 </td>\n   <td style=\"text-align:right;\"> 40.373 </td>\n   <td style=\"text-align:right;\"> -7.938 </td>\n   <td style=\"text-align:right;\"> 8.999 </td>\n   <td style=\"text-align:right;\"> 16.200 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 58.772 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 31.984 </td>\n   <td style=\"text-align:right;\"> 41.032 </td>\n   <td style=\"text-align:right;\"> -9.048 </td>\n   <td style=\"text-align:right;\"> 9.233 </td>\n   <td style=\"text-align:right;\"> 16.582 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 58.786 </td>\n   <td style=\"text-align:right;\"> 100 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n\ncount |> \n  dplyr::select(\n    sex, mean_sample, mean_census, mean_diff, sd_sample, sd_census\n    )\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> mean_sample </th>\n   <th style=\"text-align:right;\"> mean_census </th>\n   <th style=\"text-align:right;\"> mean_diff </th>\n   <th style=\"text-align:right;\"> sd_sample </th>\n   <th style=\"text-align:right;\"> sd_census </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Female </td>\n   <td style=\"text-align:right;\"> 31.754 </td>\n   <td style=\"text-align:right;\"> 41.645 </td>\n   <td style=\"text-align:right;\"> -9.890 </td>\n   <td style=\"text-align:right;\"> 9.341 </td>\n   <td style=\"text-align:right;\"> 16.907 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Male </td>\n   <td style=\"text-align:right;\"> 32.434 </td>\n   <td style=\"text-align:right;\"> 40.373 </td>\n   <td style=\"text-align:right;\"> -7.938 </td>\n   <td style=\"text-align:right;\"> 8.999 </td>\n   <td style=\"text-align:right;\"> 16.200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 31.984 </td>\n   <td style=\"text-align:right;\"> 41.032 </td>\n   <td style=\"text-align:right;\"> -9.048 </td>\n   <td style=\"text-align:right;\"> 9.233 </td>\n   <td style=\"text-align:right;\"> 16.582 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n\nsum(count$mean_diff)\n#> [1] -26.87654\n```\n:::\n\n\n### Longitudinal range\n\n#### Sample\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(dplyr)\nlibrary(magrittr)\n\nsource(here::here(\"R/stats_sum.R\"))\nsource(here::here(\"R/utils.R\"))\n\nstats <- \n  data |>\n  magrittr::extract2(\"longitude\") |>\n  stats_sum(print = FALSE)\n\nabs(stats$max - stats$min)\n#> [1] 33.023\nstats |> list_as_tibble()\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_rm_na </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_na </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:left;\"> -45.9455401815147 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> var </td>\n   <td style=\"text-align:left;\"> 18.9406905927715 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:left;\"> 4.35209037047388 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:left;\"> -67.9869962 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_1 </td>\n   <td style=\"text-align:left;\"> -48.4296364 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:left;\"> -46.9249578 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_3 </td>\n   <td style=\"text-align:left;\"> -43.7756411 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:left;\"> -34.9639996 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:left;\"> 4.6539953 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:left;\"> 0.0156480710174436 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:left;\"> 5.78918700160139 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n#### Brazil\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(measurements)\n\nchange_sign <- function(x) x * (-1)\n\n## Ponta do Seixas, PB (7° 09′ 18″ S, 34° 47′ 34″ O)\nmin <- \n  measurements::conv_unit(\"34 47 34\", from = \"deg_min_sec\", to = \"dec_deg\") |>\n  as.numeric() |>\n  change_sign()\n\n## Nascente do rio Moa, AC (7° 32′ 09″ S, 73° 59′ 26″ O)\nmax <- \n  measurements::conv_unit(\"73 59 26\", from = \"deg_min_sec\", to = \"dec_deg\") |>\n  as.numeric() |>\n  change_sign()\n\nmin\n#> [1] -34.79278\nmax\n#> [1] -73.99056\nabs(max - min)\n#> [1] 39.19778\n```\n:::\n\n\n### Latitudinal range\n\n#### Sample\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(dplyr)\nlibrary(magrittr)\n\nsource(here::here(\"R/stats_sum.R\"))\nsource(here::here(\"R/utils.R\"))\n\nstats <- \n  data |>\n  magrittr::extract2(\"latitude\") |>\n  stats_sum(print = FALSE)\n\nabs(stats$max - stats$min)\n#> [1] 32.91596\nstats |> list_as_tibble()\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> name </th>\n   <th style=\"text-align:left;\"> value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> n </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_rm_na </td>\n   <td style=\"text-align:left;\"> 79198 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> n_na </td>\n   <td style=\"text-align:left;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean </td>\n   <td style=\"text-align:left;\"> -20.8338507528991 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> var </td>\n   <td style=\"text-align:left;\"> 40.2956396934244 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> sd </td>\n   <td style=\"text-align:left;\"> 6.34788466289554 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> min </td>\n   <td style=\"text-align:left;\"> -30.1087672 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_1 </td>\n   <td style=\"text-align:left;\"> -23.6820636 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> median </td>\n   <td style=\"text-align:left;\"> -23.6820636 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_3 </td>\n   <td style=\"text-align:left;\"> -19.9026404 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> max </td>\n   <td style=\"text-align:left;\"> 2.8071961 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> iqr </td>\n   <td style=\"text-align:left;\"> 3.7794232 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> skewness </td>\n   <td style=\"text-align:left;\"> 1.40629570823769 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> kurtosis </td>\n   <td style=\"text-align:left;\"> 4.67433697579443 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n\n\n#### Brazil\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(measurements)\n\nchange_sign <- function(x) x * (-1)\n\n## Arroio Chuí, RS (33° 45′ 07″ S, 53° 23′ 50″ O)\nmin <- \n  measurements::conv_unit(\"33 45 07\", from = \"deg_min_sec\", to = \"dec_deg\") |>\n  as.numeric() |>\n  change_sign()\n\n## Nascente do rio Ailã, RR (5° 16′ 19″ N, 60° 12′ 45″ O)\nmax <- \n  measurements::conv_unit(\"5 16 19\", from = \"deg_min_sec\", to = \"dec_deg\") |>\n  as.numeric()\n\nmin\n#> [1] -33.75194\nmax\n#> [1] 5.271944\nabs(max - min)\n#> [1] 39.02389\n```\n:::\n\n\n### Region\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# See <https://sidra.ibge.gov.br> to learn more.\n\nlibrary(dplyr)\nlibrary(gutils)\nlibrary(sidrar)\nlibrary(stats)\nlibrary(stringr)\n\ngutils:::assert_internet()\n\n# Brazil's 2022 census data\ncensus_data <- \n  sidrar::get_sidra(x = 4714, variable = 93, geo = \"Region\") |>\n  dplyr::select(dplyr::all_of(c(\"Valor\", \"Grande Região\"))) |>\n  dplyr::transmute(\n    col = `Grande Região`,\n    n = Valor,\n    n_rel = n / sum(n),\n    n_per = round(n_rel * 100, 3)\n    ) |>\n  dplyr::mutate(\n    col = dplyr::case_when(\n      col == \"Norte\" ~ \"North\",\n      col == \"Nordeste\" ~ \"Northeast\",\n      col == \"Centro-Oeste\" ~ \"Midwest\",\n      col == \"Sudeste\" ~ \"Southeast\",\n      col == \"Sul\" ~ \"South\"\n    )\n  ) |>\n  dplyr::as_tibble() |>\n  dplyr::arrange(dplyr::desc(n_rel))\n\ncount <- data |> \n  magrittr::extract2(\"region\") |>\n  stats_sum(print = FALSE) |>\n  magrittr::extract2(\"count\") |>\n  dplyr::mutate(\n    n_rel = n / sum(n),\n    n_per = round(n_rel * 100, 3)\n    ) |>\n  dplyr::arrange(dplyr::desc(n_rel))\n\ncount <- \n  dplyr::left_join(\n    count, census_data, by = \"col\", suffix = c(\"_sample\", \"_census\")\n  ) |>\n  dplyr::mutate(\n    n_rel_diff = n_rel_sample - n_rel_census,\n    n_per_diff = n_per_sample - n_per_census\n  ) |>\n  dplyr::relocate(\n    col, n_sample, n_census, n_rel_sample, n_rel_census, n_rel_diff,\n    n_per_sample, n_per_census, n_per_diff\n  )\n\n## Difference from the sample to the census\ncount\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> col </th>\n   <th style=\"text-align:right;\"> n_sample </th>\n   <th style=\"text-align:right;\"> n_census </th>\n   <th style=\"text-align:right;\"> n_rel_sample </th>\n   <th style=\"text-align:right;\"> n_rel_census </th>\n   <th style=\"text-align:right;\"> n_rel_diff </th>\n   <th style=\"text-align:right;\"> n_per_sample </th>\n   <th style=\"text-align:right;\"> n_per_census </th>\n   <th style=\"text-align:right;\"> n_per_diff </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Southeast </td>\n   <td style=\"text-align:right;\"> 47966 </td>\n   <td style=\"text-align:right;\"> 84847187 </td>\n   <td style=\"text-align:right;\"> 0.606 </td>\n   <td style=\"text-align:right;\"> 0.418 </td>\n   <td style=\"text-align:right;\"> 0.188 </td>\n   <td style=\"text-align:right;\"> 60.565 </td>\n   <td style=\"text-align:right;\"> 41.784 </td>\n   <td style=\"text-align:right;\"> 18.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:right;\"> 13560 </td>\n   <td style=\"text-align:right;\"> 29933315 </td>\n   <td style=\"text-align:right;\"> 0.171 </td>\n   <td style=\"text-align:right;\"> 0.147 </td>\n   <td style=\"text-align:right;\"> 0.024 </td>\n   <td style=\"text-align:right;\"> 17.122 </td>\n   <td style=\"text-align:right;\"> 14.741 </td>\n   <td style=\"text-align:right;\"> 2.381 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northeast </td>\n   <td style=\"text-align:right;\"> 9138 </td>\n   <td style=\"text-align:right;\"> 54644582 </td>\n   <td style=\"text-align:right;\"> 0.115 </td>\n   <td style=\"text-align:right;\"> 0.269 </td>\n   <td style=\"text-align:right;\"> -0.154 </td>\n   <td style=\"text-align:right;\"> 11.538 </td>\n   <td style=\"text-align:right;\"> 26.910 </td>\n   <td style=\"text-align:right;\"> -15.372 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:right;\"> 6563 </td>\n   <td style=\"text-align:right;\"> 16287809 </td>\n   <td style=\"text-align:right;\"> 0.083 </td>\n   <td style=\"text-align:right;\"> 0.080 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 8.287 </td>\n   <td style=\"text-align:right;\"> 8.021 </td>\n   <td style=\"text-align:right;\"> 0.266 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North </td>\n   <td style=\"text-align:right;\"> 1971 </td>\n   <td style=\"text-align:right;\"> 17349619 </td>\n   <td style=\"text-align:right;\"> 0.025 </td>\n   <td style=\"text-align:right;\"> 0.085 </td>\n   <td style=\"text-align:right;\"> -0.061 </td>\n   <td style=\"text-align:right;\"> 2.489 </td>\n   <td style=\"text-align:right;\"> 8.544 </td>\n   <td style=\"text-align:right;\"> -6.055 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\ncount |> dplyr::select(col, n_per_sample, n_per_census, n_per_diff)\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> col </th>\n   <th style=\"text-align:right;\"> n_per_sample </th>\n   <th style=\"text-align:right;\"> n_per_census </th>\n   <th style=\"text-align:right;\"> n_per_diff </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Southeast </td>\n   <td style=\"text-align:right;\"> 60.565 </td>\n   <td style=\"text-align:right;\"> 41.784 </td>\n   <td style=\"text-align:right;\"> 18.781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> South </td>\n   <td style=\"text-align:right;\"> 17.122 </td>\n   <td style=\"text-align:right;\"> 14.741 </td>\n   <td style=\"text-align:right;\"> 2.381 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northeast </td>\n   <td style=\"text-align:right;\"> 11.538 </td>\n   <td style=\"text-align:right;\"> 26.910 </td>\n   <td style=\"text-align:right;\"> -15.372 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Midwest </td>\n   <td style=\"text-align:right;\"> 8.287 </td>\n   <td style=\"text-align:right;\"> 8.021 </td>\n   <td style=\"text-align:right;\"> 0.266 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> North </td>\n   <td style=\"text-align:right;\"> 2.489 </td>\n   <td style=\"text-align:right;\"> 8.544 </td>\n   <td style=\"text-align:right;\"> -6.055 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nsum(count$n_per_diff)\n#> [1] 0.001\n```\n:::\n\n\n### State\n\n::: {.callout-note}\n## TODO\n\nCompare with 2022 census.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(here)\nlibrary(dplyr)\nlibrary(magrittr)\n\nsource(here::here(\"R/stats_sum.R\"))\n\ndata |> \n  magrittr::extract2(\"state\") |>\n  stats_sum(print = FALSE) |>\n  magrittr::extract2(\"count\") |>\n  dplyr::mutate(\n    n_rel = n / sum(n),\n    n_per = round(n_rel * 100, 3)\n    ) |>\n  dplyr::arrange(dplyr::desc(n_rel))\n```\n\n::: {.cell-output-display}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> col </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> n_rel </th>\n   <th style=\"text-align:right;\"> n_per </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> São Paulo </td>\n   <td style=\"text-align:right;\"> 26379 </td>\n   <td style=\"text-align:right;\"> 0.333 </td>\n   <td style=\"text-align:right;\"> 33.308 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Minas Gerais </td>\n   <td style=\"text-align:right;\"> 10115 </td>\n   <td style=\"text-align:right;\"> 0.128 </td>\n   <td style=\"text-align:right;\"> 12.772 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rio de Janeiro </td>\n   <td style=\"text-align:right;\"> 9381 </td>\n   <td style=\"text-align:right;\"> 0.118 </td>\n   <td style=\"text-align:right;\"> 11.845 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Paraná </td>\n   <td style=\"text-align:right;\"> 5517 </td>\n   <td style=\"text-align:right;\"> 0.070 </td>\n   <td style=\"text-align:right;\"> 6.966 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rio Grande do Sul </td>\n   <td style=\"text-align:right;\"> 4097 </td>\n   <td style=\"text-align:right;\"> 0.052 </td>\n   <td style=\"text-align:right;\"> 5.173 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Santa Catarina </td>\n   <td style=\"text-align:right;\"> 3946 </td>\n   <td style=\"text-align:right;\"> 0.050 </td>\n   <td style=\"text-align:right;\"> 4.982 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Goiás </td>\n   <td style=\"text-align:right;\"> 2674 </td>\n   <td style=\"text-align:right;\"> 0.034 </td>\n   <td style=\"text-align:right;\"> 3.376 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bahia </td>\n   <td style=\"text-align:right;\"> 2522 </td>\n   <td style=\"text-align:right;\"> 0.032 </td>\n   <td style=\"text-align:right;\"> 3.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Espírito Santo </td>\n   <td style=\"text-align:right;\"> 2091 </td>\n   <td style=\"text-align:right;\"> 0.026 </td>\n   <td style=\"text-align:right;\"> 2.640 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Distrito Federal </td>\n   <td style=\"text-align:right;\"> 2087 </td>\n   <td style=\"text-align:right;\"> 0.026 </td>\n   <td style=\"text-align:right;\"> 2.635 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pernambuco </td>\n   <td style=\"text-align:right;\"> 1550 </td>\n   <td style=\"text-align:right;\"> 0.020 </td>\n   <td style=\"text-align:right;\"> 1.957 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ceará </td>\n   <td style=\"text-align:right;\"> 1398 </td>\n   <td style=\"text-align:right;\"> 0.018 </td>\n   <td style=\"text-align:right;\"> 1.765 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mato Grosso do Sul </td>\n   <td style=\"text-align:right;\"> 1014 </td>\n   <td style=\"text-align:right;\"> 0.013 </td>\n   <td style=\"text-align:right;\"> 1.280 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pará </td>\n   <td style=\"text-align:right;\"> 938 </td>\n   <td style=\"text-align:right;\"> 0.012 </td>\n   <td style=\"text-align:right;\"> 1.184 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rio Grande do Norte </td>\n   <td style=\"text-align:right;\"> 789 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.996 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mato Grosso </td>\n   <td style=\"text-align:right;\"> 788 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.995 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Paraíba </td>\n   <td style=\"text-align:right;\"> 773 </td>\n   <td style=\"text-align:right;\"> 0.010 </td>\n   <td style=\"text-align:right;\"> 0.976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Maranhão </td>\n   <td style=\"text-align:right;\"> 652 </td>\n   <td style=\"text-align:right;\"> 0.008 </td>\n   <td style=\"text-align:right;\"> 0.823 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sergipe </td>\n   <td style=\"text-align:right;\"> 533 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.673 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Alagoas </td>\n   <td style=\"text-align:right;\"> 526 </td>\n   <td style=\"text-align:right;\"> 0.007 </td>\n   <td style=\"text-align:right;\"> 0.664 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rondônia </td>\n   <td style=\"text-align:right;\"> 401 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.506 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Piauí </td>\n   <td style=\"text-align:right;\"> 395 </td>\n   <td style=\"text-align:right;\"> 0.005 </td>\n   <td style=\"text-align:right;\"> 0.499 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tocantins </td>\n   <td style=\"text-align:right;\"> 268 </td>\n   <td style=\"text-align:right;\"> 0.003 </td>\n   <td style=\"text-align:right;\"> 0.338 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Acre </td>\n   <td style=\"text-align:right;\"> 132 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.167 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Roraima </td>\n   <td style=\"text-align:right;\"> 119 </td>\n   <td style=\"text-align:right;\"> 0.002 </td>\n   <td style=\"text-align:right;\"> 0.150 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Amapá </td>\n   <td style=\"text-align:right;\"> 113 </td>\n   <td style=\"text-align:right;\"> 0.001 </td>\n   <td style=\"text-align:right;\"> 0.143 </td>\n  </tr>\n</tbody>\n</table>\n:::\n:::\n",
    "supporting": [
      "appendice-ch-4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<link href=\"../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}