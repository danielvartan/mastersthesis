<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Appendix E — Hypothesis Test A – Is latitude associated with chronotype?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/supplementary-material-6.html" rel="next">
<link href="../qmd/supplementary-material-4.html" rel="prev">
<link href="../images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Appendix E — Hypothesis Test A – Is latitude associated with chronotype?">
<meta property="og:description" content="">
<meta property="og:site_name" content="Is latitude associated with chronotype?">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/supplementary-material-1.html">Appendices</a></li><li class="breadcrumb-item"><a href="../qmd/supplementary-material-5.html"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Hypothesis Test A</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Is latitude associated with chronotype?</a> 
        <div class="sidebar-tools-main">
    <a href="../index.pdf" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-file-earmark-pdf-fill"></i></a>
    <a href="https://github.com/danielvartan/mastersthesis/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Preliminary sections</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/epigraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epigraph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/vernacular-abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/foreign-abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumo</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">On chronobiology</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">On complexity science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">On the latitude hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Is latitude associated with chronotype?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Question, Objective and Hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Sample Balance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Hypothesis Test A</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Hypothesis Test B</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Comparative Assessment of QualoCEP and Google Geocoding API Performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Overview of General Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Critique of Leocadio-Miguel et al.&nbsp;(2017)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/supplementary-material-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Works and Activities Developed During the Thesis</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">E.1</span> Overview</a></li>
  <li><a href="#setting-the-enviroment" id="toc-setting-the-enviroment" class="nav-link" data-scroll-target="#setting-the-enviroment"><span class="header-section-number">E.2</span> Setting the Enviroment</a></li>
  <li><a href="#loading-and-processing-the-data" id="toc-loading-and-processing-the-data" class="nav-link" data-scroll-target="#loading-and-processing-the-data"><span class="header-section-number">E.3</span> Loading and Processing the Data</a></li>
  <li><a href="#conducting-a-power-analysis" id="toc-conducting-a-power-analysis" class="nav-link" data-scroll-target="#conducting-a-power-analysis"><span class="header-section-number">E.4</span> Conducting a Power Analysis</a></li>
  <li><a href="#examining-distributions" id="toc-examining-distributions" class="nav-link" data-scroll-target="#examining-distributions"><span class="header-section-number">E.5</span> Examining Distributions</a></li>
  <li><a href="#examining-correlations" id="toc-examining-correlations" class="nav-link" data-scroll-target="#examining-correlations"><span class="header-section-number">E.6</span> Examining Correlations</a></li>
  <li>
<a href="#building-the-restricted-model" id="toc-building-the-restricted-model" class="nav-link" data-scroll-target="#building-the-restricted-model"><span class="header-section-number">E.7</span> Building the Restricted Model</a>
  <ul class="collapse">
<li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model"><span class="header-section-number">E.7.1</span> Fitting the Model</a></li>
  <li><a href="#evaluating-the-model-fit" id="toc-evaluating-the-model-fit" class="nav-link" data-scroll-target="#evaluating-the-model-fit"><span class="header-section-number">E.7.2</span> Evaluating the Model Fit</a></li>
  <li><a href="#conducting-model-diagnostics" id="toc-conducting-model-diagnostics" class="nav-link" data-scroll-target="#conducting-model-diagnostics"><span class="header-section-number">E.7.3</span> Conducting Model Diagnostics</a></li>
  </ul>
</li>
  <li>
<a href="#building-the-full-model" id="toc-building-the-full-model" class="nav-link" data-scroll-target="#building-the-full-model"><span class="header-section-number">E.8</span> Building the Full Model</a>
  <ul class="collapse">
<li><a href="#fitting-the-model-1" id="toc-fitting-the-model-1" class="nav-link" data-scroll-target="#fitting-the-model-1"><span class="header-section-number">E.8.1</span> Fitting the Model</a></li>
  <li><a href="#evaluating-the-model-fit-1" id="toc-evaluating-the-model-fit-1" class="nav-link" data-scroll-target="#evaluating-the-model-fit-1"><span class="header-section-number">E.8.2</span> Evaluating the Model Fit</a></li>
  <li><a href="#conducting-model-diagnostics-1" id="toc-conducting-model-diagnostics-1" class="nav-link" data-scroll-target="#conducting-model-diagnostics-1"><span class="header-section-number">E.8.3</span> Conducting Model Diagnostics</a></li>
  </ul>
</li>
  <li>
<a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing"><span class="header-section-number">E.9</span> Hypothesis Testing</a>
  <ul class="collapse">
<li><a href="#f-test" id="toc-f-test" class="nav-link" data-scroll-target="#f-test"><span class="header-section-number">E.9.1</span> F-test</a></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size"><span class="header-section-number">E.9.2</span> Effect Size</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">E.10</span> Conclusion</a></li>
  <li><a href="#final-remarks" id="toc-final-remarks" class="nav-link" data-scroll-target="#final-remarks"><span class="header-section-number">E.11</span> Final Remarks</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/danielvartan/mastersthesis/edit/main/qmd/supplementary-material-5.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/mastersthesis/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://doi.org/10.17605/OSF.IO/YGKTS"><i class="bi bi-link-45deg"></i>{{&lt; iconify simple-icons:osf &gt;}}</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/supplementary-material-1.html">Appendices</a></li><li class="breadcrumb-item"><a href="../qmd/supplementary-material-5.html"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Hypothesis Test A</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix E — Hypothesis Test A</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><!-- %:::% .common h1 begin %:::% --><!-- %:::% .common h1 end %:::% --><section id="overview" class="level2" data-number="E.1"><h2 data-number="E.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">E.1</span> Overview</h2>
<p>This document focuses on testing the thesis hypothesis (<strong>Test A</strong>) using the methods described in the supplemental material titled <em>Methods</em>.</p>
<p>The assumptions addressed here are those relevant to general linear models, with further information available in the supplemental material titled <em>Overview of General Linear Models</em>.</p>
<p>As with all analyses in this thesis, the process is fully reproducible and was conducted using the <a href="https://www.r-project.org/">R programming language</a> <span class="citation" data-cites="rcoreteam">(<a href="references.html#ref-rcoreteam" role="doc-biblioref">R Core Team, n.d.</a>)</span> along with the <a href="https://quarto.org/">Quarto</a> publishing system <span class="citation" data-cites="allaire">(<a href="references.html#ref-allaire" role="doc-biblioref">Allaire et al., n.d.</a>)</span>.</p>
</section><section id="setting-the-enviroment" class="level2" data-number="E.2"><h2 data-number="E.2" class="anchored" data-anchor-id="setting-the-enviroment">
<span class="header-section-number">E.2</span> Setting the Enviroment</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cli.r-lib.org">cli</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://geobosh.github.io/fBasicsDoc/">fBasics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggplotify">ggplotify</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grDevices</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hms.tidyverse.org/">hms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://danielvartan.github.io/lubritime/">lubritime</a></span><span class="op">)</span> <span class="co"># github.com/danielvartan/lubritime</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">methods</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip">parsnip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/danielvartan/prettycheck/">prettycheck</a></span><span class="op">)</span> <span class="co"># github.com/danielvartan/prettycheck</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">psychometric</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pwrss</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org">rlang</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://danielvartan.github.io/rutils/">rutils</a></span><span class="op">)</span> <span class="co"># github.com/danielvartan/rutils</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tjfarrar/skedastic">skedastic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflows">workflows</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"cohens_f_squared.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"normality_summary.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"panel_tabset_coef_dfbetas.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"panel_tabset_var_distribution.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"panel_tabset_var_homoscedasticity.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"plot_box_plot.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"plot_ggally.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"plot_hist.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"plot_qq.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"stats_summary.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"test_normality.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"utils-checks.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"utils-plots.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"utils-stats.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="loading-and-processing-the-data" class="level2" data-number="E.3"><h2 data-number="E.3" class="anchored" data-anchor-id="loading-and-processing-the-data">
<span class="header-section-number">E.3</span> Loading and Processing the Data</h2>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 1</dt>
<dd>
<strong>Predictor is known</strong>. Either the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> are known ahead of time, or they are the observed values of random vectors <span class="math inline">\(Z_{1}, \dots , Z_{n}\)</span> on whose values we condition before computing the joint distribution of (<span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span>) <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 736</a>)</span>.
</dd>
</dl>
</div>
</div>
</div>
<p><strong>Assumption 1</strong> is satisfied, as the predictors are known.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_make.html">tar_make</a></span><span class="op">(</span>script <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"_targets.R"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This data processing is performed solely for the purpose of the analysis. The variables undergo numerical transformations to streamline the modeling process and minimize potential errors.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html">tar_read</a></span><span class="op">(</span><span class="st">"weighted_data"</span>, store <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"_targets"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">msf_sc</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">longitude</span>, <span class="va">ghi_month</span>, <span class="va">ghi_annual</span>, </span>
<span>    <span class="va">march_equinox_daylight</span>, <span class="va">june_solstice_daylight</span>,</span>
<span>    <span class="va">december_solstice_daylight</span>, <span class="va">cell_weight</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"_daylight"</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span> <span class="va">.x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    msf_sc <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span></span>
<span>        <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/hms.html">as_hms</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">msf_sc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/parse_hms.html">parse_hm</a></span><span class="op">(</span><span class="st">"12:00"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>          <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/hms.html">as_hms</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">msf_sc</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/parse_hms.html">parse_hm</a></span><span class="op">(</span><span class="st">"12:00"</span><span class="op">)</span>,</span>
<span>        na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span> <span class="op">~</span> <span class="va">msf_sc</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># TRUE</span></span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">msf_sc</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu">lubritime</span><span class="fu">:::</span><span class="fu">link_to_timeline</span><span class="op">(</span></span>
<span>          threshold <span class="op">=</span> <span class="fu">hms</span><span class="fu">::</span><span class="fu"><a href="https://hms.tidyverse.org/reference/parse_hms.html">parse_hms</a></span><span class="op">(</span><span class="st">"12:00:00"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">cell_weight</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; The data contains 65823 observations of the following 9 variables:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - msf_sc: n = 65823, Mean = 16120.91, SD = 5172.84, Median = 15685.71, MAD =</span></span>
<span><span class="co">#&gt; 5210.28, range: [1542.86, 30578.57], Skewness = 0.27, Kurtosis = -0.25, 0%</span></span>
<span><span class="co">#&gt; missing</span></span>
<span><span class="co">#&gt;   - age: n = 65823, Mean = 32.11, SD = 9.26, Median = 30.70, MAD = 9.42,</span></span>
<span><span class="co">#&gt; range: [18, 58.95], Skewness = 0.66, Kurtosis = -0.19, 0% missing</span></span>
<span><span class="co">#&gt;   - sex: 2 levels, namely Female (n = 43728, 66.43%) and Male (n = 22095,</span></span>
<span><span class="co">#&gt; 33.57%)</span></span>
<span><span class="co">#&gt;   - longitude: n = 65823, Mean = -45.81, SD = 4.05, Median = -46.59, MAD =</span></span>
<span><span class="co">#&gt; 3.87, range: [-57.11, -34.81], Skewness = 0.65, Kurtosis = 0.47, 0% missing</span></span>
<span><span class="co">#&gt;   - ghi_month: n = 65823, Mean = 5103.14, SD = 545.25, Median = 5050.00, MAD =</span></span>
<span><span class="co">#&gt; 593.04, range: [3508, 6699], Skewness = 0.03, Kurtosis = -0.04, 0% missing</span></span>
<span><span class="co">#&gt;   - ghi_annual: n = 65823, Mean = 4766.14, SD = 412.12, Median = 4726.00, MAD</span></span>
<span><span class="co">#&gt; = 453.68, range: [3639, 6061], Skewness = 0.29, Kurtosis = -0.35, 0% missing</span></span>
<span><span class="co">#&gt;   - march_equinox_daylight: n = 65823, Mean = 43607.03, SD = 9.15, Median =</span></span>
<span><span class="co">#&gt; 43609.35, MAD = 5.11, range: [43588.57, 43642.80], Skewness = -0.02,</span></span>
<span><span class="co">#&gt; Kurtosis = 0.41, 0% missing</span></span>
<span><span class="co">#&gt;   - june_solstice_daylight: n = 65823, Mean = 39058.59, SD = 1384.27, Median =</span></span>
<span><span class="co">#&gt; 38622.60, MAD = 549.10, range: [35740.28, 43710.78], Skewness = 1.31,</span></span>
<span><span class="co">#&gt; Kurtosis = 1.65, 0% missing</span></span>
<span><span class="co">#&gt;   - december_solstice_daylight: n = 65823, Mean = 48318.08, SD = 1420.94,</span></span>
<span><span class="co">#&gt; Median = 48762.49, MAD = 568.08, range: [43582.40, 51774.49], Skewness =</span></span>
<span><span class="co">#&gt; -1.28, Kurtosis = 1.59, 0% missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="conducting-a-power-analysis" class="level2" data-number="E.4"><h2 data-number="E.4" class="anchored" data-anchor-id="conducting-a-power-analysis">
<span class="header-section-number">E.4</span> Conducting a Power Analysis</h2>
<p>The results indicate that at least <span class="math inline">\(1\,895\)</span> observations per variable are required to achieve a power of <span class="math inline">\(0.99\)</span> (<span class="math inline">\(1 - \beta\)</span>, the probability of <strong>not</strong> committing a <a href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors">type II error</a>) and a significance level (<span class="math inline">\(\alpha\)</span>) of <span class="math inline">\(0.01\)</span> (<span class="math inline">\(0.99\)</span> probability of <strong>not</strong> committing a <a href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors">type I error</a>). The dataset contains <span class="math inline">\(65\,823\)</span> observations, which exceeds this requirement.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pre_pwr</span> <span class="op">&lt;-</span> <span class="fu">pwrss</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwrss/man/4-Linear-Regression-Rsquared.html">pwrss.f.reg</a></span><span class="op">(</span></span>
<span>  f2 <span class="op">=</span> <span class="fl">0.02</span>, <span class="co"># Minimal Effect Size (MES).</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>, <span class="co"># Number of predictors (-msf_sc, -cell_weight).</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;  Linear Regression (F test) </span></span>
<span><span class="co">#&gt;  R-squared Deviation from 0 (zero) </span></span>
<span><span class="co">#&gt;  H0: r2 = 0 </span></span>
<span><span class="co">#&gt;  HA: r2 &gt; 0 </span></span>
<span><span class="co">#&gt;  ------------------------------ </span></span>
<span><span class="co">#&gt;   Statistical power = 0.99 </span></span>
<span><span class="co">#&gt;   n = 1895 </span></span>
<span><span class="co">#&gt;  ------------------------------ </span></span>
<span><span class="co">#&gt;  Numerator degrees of freedom = 8 </span></span>
<span><span class="co">#&gt;  Denominator degrees of freedom = 1885.6 </span></span>
<span><span class="co">#&gt;  Non-centrality parameter = 37.893 </span></span>
<span><span class="co">#&gt;  Type I error rate = 0.01 </span></span>
<span><span class="co">#&gt;  Type II error rate = 0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pwrss</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pwrss/man/0-Generic-F-Test.html">power.f.test</a></span><span class="op">(</span></span>
<span>  ncp <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">ncp</span>,</span>
<span>  df1 <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">df1</span>,</span>
<span>  df2 <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">df2</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">pre_pwr</span><span class="op">$</span><span class="va">parms</span><span class="op">$</span><span class="va">alpha</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-power-analysis" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-power-analysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.1: Power analysis for the hypothesis test.
</figcaption><div aria-describedby="fig-sm-5-power-analysis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt;  power ncp.alt ncp.null alpha df1    df2 f.crit
#&gt;   0.99  37.893        0  0.01   8 1885.6 2.5207</code></pre>
</div>
<p>Source: Created by the author.</p>
</div>
</figure>
</div>
</section><section id="examining-distributions" class="level2" data-number="E.5"><h2 data-number="E.5" class="anchored" data-anchor-id="examining-distributions">
<span class="header-section-number">E.5</span> Examining Distributions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">MSF<sub>sc</sub> (Chronotype proxy) (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Age (years)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Longitude (decimal degrees)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Monthly average global horizontal irradiance (Wh/m²)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Annual average global horizontal irradiance (Wh/m²)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Daylight on the March equinox (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Daylight on the June solstice (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Daylight on the December solstice (seconds)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'msf_sc'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'MSF~sc~ (Chronotype proxy) (seconds)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-msf-sc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.1: Statistics for the <code>msf_sc</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"MSF~sc~ (Chronotype proxy) (seconds)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"16120.9142049783"},{"1":"var","2":"26758237.3943164"},{"1":"sd","2":"5172.83649406362"},{"1":"min","2":"1542.85714285714"},{"1":"q_1","2":"12428.5714285714"},{"1":"median","2":"15685.7142857143"},{"1":"q_3","2":"19564.2857142857"},{"1":"max","2":"30578.5714285714"},{"1":"iqr","2":"7135.71428571428"},{"1":"range","2":"29035.7142857143"},{"1":"skewness","2":"0.273327278961834"},{"1":"kurtosis","2":"2.7470660103674"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'msf_sc'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'MSF~sc~ (Chronotype proxy) (seconds)'</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-msf-sc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.2: Histogram of the <code>msf_sc</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'msf_sc'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-msf-sc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.3: Boxplot of the <code>msf_sc</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'age'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Age (years)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.2: Statistics for the <code>age</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Age (years)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"32.1094393297176"},{"1":"var","2":"85.7009226439564"},{"1":"sd","2":"9.25747928131392"},{"1":"min","2":"18"},{"1":"q_1","2":"24.8319444444444"},{"1":"median","2":"30.7027777777778"},{"1":"q_3","2":"37.7444444444444"},{"1":"max","2":"58.95"},{"1":"iqr","2":"12.9125"},{"1":"range","2":"40.95"},{"1":"skewness","2":"0.657015779867489"},{"1":"kurtosis","2":"2.81410947240948"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'age'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Age (years)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.4: Histogram of the <code>age</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'age'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.5: Boxplot of the <code>age</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'longitude'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Longitude (decimal degrees)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.3: Statistics for the <code>longitude</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Longitude (decimal degrees)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"-45.8058465268"},{"1":"var","2":"16.3727972792103"},{"1":"sd","2":"4.04633133581647"},{"1":"min","2":"-57.1092366"},{"1":"q_1","2":"-48.3811173"},{"1":"median","2":"-46.5943245"},{"1":"q_3","2":"-43.3873918"},{"1":"max","2":"-34.812473"},{"1":"iqr","2":"4.9937255"},{"1":"range","2":"22.2967636"},{"1":"skewness","2":"0.645044723697085"},{"1":"kurtosis","2":"3.47241073004291"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'longitude'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Longitude (decimal degrees)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.6: Histogram of the <code>longitude</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'longitude'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.7: Boxplot of the <code>longitude</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_month'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Monthly average global horizontal irradiance (Wh/m²)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.4: Statistics for the <code>ghi_month</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Monthly average global horizontal irradiance (Wh/m²)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"5103.14440241253"},{"1":"var","2":"297300.484373843"},{"1":"sd","2":"545.252679382543"},{"1":"min","2":"3508"},{"1":"q_1","2":"4723"},{"1":"median","2":"5050"},{"1":"q_3","2":"5528"},{"1":"max","2":"6699"},{"1":"iqr","2":"805"},{"1":"range","2":"3191"},{"1":"skewness","2":"0.0280252226133493"},{"1":"kurtosis","2":"2.95926389736137"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_month'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Monthly average global horizontal irradiance (Wh/m²)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.8: Histogram of the <code>ghi_month</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_month'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.9: Boxplot of the <code>ghi_month</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_annual'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Annual average global horizontal irradiance (Wh/m²)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-ghi-annual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.5: Statistics for the <code>ghi_annual</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Annual average global horizontal irradiance (Wh/m²)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"4766.13508955836"},{"1":"var","2":"169839.855926341"},{"1":"sd","2":"412.116313589187"},{"1":"min","2":"3639"},{"1":"q_1","2":"4434"},{"1":"median","2":"4726"},{"1":"q_3","2":"5080"},{"1":"max","2":"6061"},{"1":"iqr","2":"646"},{"1":"range","2":"2422"},{"1":"skewness","2":"0.291100793912465"},{"1":"kurtosis","2":"2.64900266455452"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_annual'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Annual average global horizontal irradiance (Wh/m²)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-ghi-annual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.10: Histogram of the <code>ghi_annual</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'ghi_annual'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-ghi-annual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.11: Boxplot of the <code>ghi_annual</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'march_equinox_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the March equinox (seconds)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-march-equinox-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.6: Statistics for the <code>march_equinox_daylight</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Daylight on the March equinox (seconds)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"43607.0339650669"},{"1":"var","2":"83.641875231517"},{"1":"sd","2":"9.14559321375694"},{"1":"min","2":"43588.5702495575"},{"1":"q_1","2":"43602.8584272861"},{"1":"median","2":"43609.3511488438"},{"1":"q_3","2":"43610.5456066132"},{"1":"max","2":"43642.8005850315"},{"1":"iqr","2":"7.68717932701111"},{"1":"range","2":"54.2303354740143"},{"1":"skewness","2":"-0.0183228021884021"},{"1":"kurtosis","2":"3.40889961043131"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'march_equinox_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the March equinox (seconds)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-march-equinox-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.12: Histogram of the <code>march_equinox_daylight</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'march_equinox_daylight'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-march-equinox-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.13: Boxplot of the <code>march_equinox_daylight</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'june_solstice_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the June solstice (seconds)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-june-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.7: Statistics for the <code>june_solstice_daylight</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Daylight on the June solstice (seconds)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"39058.5901909606"},{"1":"var","2":"1916198.00853231"},{"1":"sd","2":"1384.26804071044"},{"1":"min","2":"35740.282869339"},{"1":"q_1","2":"38448.6738941669"},{"1":"median","2":"38622.6008374691"},{"1":"q_3","2":"39337.7613533735"},{"1":"max","2":"43710.776468277"},{"1":"iqr","2":"889.087459206581"},{"1":"range","2":"7970.49359893799"},{"1":"skewness","2":"1.31145514605356"},{"1":"kurtosis","2":"4.64550014773706"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'june_solstice_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the June solstice (seconds)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-june-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.14: Histogram of the <code>june_solstice_daylight</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'june_solstice_daylight'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-june-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.15: Boxplot of the <code>june_solstice_daylight</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'december_solstice_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the December solstice (seconds)'</span>,</span>
<span>    as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-var-distribution-stats-december-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-var-distribution-stats-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.8: Statistics for the <code>december_solstice_daylight</code> variable.
</figcaption><div aria-describedby="tbl-sm-5-var-distribution-stats-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Daylight on the December solstice (seconds)"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"48318.0833197336"},{"1":"var","2":"2019072.60761452"},{"1":"sd","2":"1420.94074739748"},{"1":"min","2":"43582.4024820328"},{"1":"q_1","2":"48023.4326939583"},{"1":"median","2":"48762.4883482456"},{"1":"q_3","2":"48942.7451415062"},{"1":"max","2":"51774.4867081642"},{"1":"iqr","2":"919.312447547913"},{"1":"range","2":"8192.08422613144"},{"1":"skewness","2":"-1.28469989488043"},{"1":"kurtosis","2":"4.59159438526667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'december_solstice_daylight'</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Daylight on the December solstice (seconds)'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-histogram-december-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-histogram-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.16: Histogram of the <code>december_solstice_daylight</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-histogram-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_box_plot</span><span class="op">(</span></span>
<span>    col <span class="op">=</span> <span class="st">'december_solstice_daylight'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-var-distribution-box-plot-december-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-var-distribution-box-plot-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.17: Boxplot of the <code>december_solstice_daylight</code> variable.
</figcaption><div aria-describedby="fig-sm-5-var-distribution-box-plot-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section><section id="examining-correlations" class="level2" data-number="E.6"><h2 data-number="E.6" class="anchored" data-anchor-id="examining-correlations">
<span class="header-section-number">E.6</span> Examining Correlations</h2>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">plot_ggally</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"msf_sc"</span>,</span>
<span>      <span class="st">"age"</span>,</span>
<span>      <span class="st">"sex"</span>,</span>
<span>      <span class="st">"longitude"</span>,</span>
<span>      <span class="st">"ghi_month"</span>,</span>
<span>      <span class="st">"ghi_annual"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sex</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.18: Correlation matrix of the main predictors.
</figcaption><div aria-describedby="fig-sm-5-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Source: Created by the author.</p>
</div>
</figure>
</div>
</section><section id="building-the-restricted-model" class="level2" data-number="E.7"><h2 data-number="E.7" class="anchored" data-anchor-id="building-the-restricted-model">
<span class="header-section-number">E.7</span> Building the Restricted Model</h2>
<section id="fitting-the-model" class="level3" data-number="E.7.1"><h3 data-number="E.7.1" class="anchored" data-anchor-id="fitting-the-model">
<span class="header-section-number">E.7.1</span> Fitting the Model</h3>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">msf_sc</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">longitude</span> <span class="op">+</span> <span class="va">ghi_month</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">workflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_case_weights.html">add_case_weights</a></span><span class="op">(</span><span class="va">cell_weight</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_formula.html">add_formula</a></span><span class="op">(</span><span class="va">form</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">workflow</span></span>
<span><span class="co">#&gt; ══ Workflow ═════════════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; Preprocessor: Formula</span></span>
<span><span class="co">#&gt; Model: linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; msf_sc ~ age + sex + longitude + ghi_month</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Case Weights ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; cell_weight</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: lm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">workflow</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">fit_restricted</span> <span class="op">&lt;-</span> <span class="va">fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-fit-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.9: Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"19427.76044","3":"389.03209","4":"49.9387","5":"0"},{"1":"age","2":"-124.87537","3":"1.72711","4":"-72.3032","5":"0"},{"1":"sexMale","2":"358.48562","3":"39.07149","4":"9.1751","5":"0"},{"1":"longitude","2":"-71.86988","3":"4.86851","4":"-14.7622","5":"0"},{"1":"ghi_month","2":"-0.52019","3":"0.03995","4":"-13.0206","5":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-fit-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.10: Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"r.squared","2":"0.085165"},{"1":"adj.r.squared","2":"0.085110"},{"1":"sigma","2":"4537.445247"},{"1":"statistic","2":"1531.808410"},{"1":"p.value","2":"0.000000"},{"1":"df","2":"4.000000"},{"1":"logLik","2":"-664455.894930"},{"1":"AIC","2":"1328923.789859"},{"1":"BIC","2":"1328978.358207"},{"1":"deviance","2":"1355087927709.431885"},{"1":"df.residual","2":"65818.000000"},{"1":"nobs","2":"65823.000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data, weights = weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -44246  -2705   -316   2430  52017 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 19427.76     389.03   49.94   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; age          -124.88       1.73  -72.30   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sexMale       358.49      39.07    9.18   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; longitude     -71.87       4.87  -14.76   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ghi_month      -0.52       0.04  -13.02   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4540 on 65818 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0852, Adjusted R-squared:  0.0851 </span></span>
<span><span class="co">#&gt; F-statistic: 1.53e+03 on 4 and 65818 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span></span>
<span><span class="va">fit_engine_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span>, weights <span class="op">=</span> <span class="va">cell_weight</span><span class="op">)</span></span>
<span><span class="va">fit_engine_restricted</span> <span class="op">&lt;-</span> <span class="va">fit_engine_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">fit_engine_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; We fitted a linear model (estimated using OLS) to predict msf_sc with age,</span></span>
<span><span class="co">#&gt; sex, longitude and ghi_month (formula: msf_sc ~ age + sex + longitude +</span></span>
<span><span class="co">#&gt; ghi_month). The model explains a statistically significant and weak</span></span>
<span><span class="co">#&gt; proportion of variance (R2 = 0.09, F(4, 65818) = 1531.81, p &lt; .001, adj. R2</span></span>
<span><span class="co">#&gt; = 0.09). The model's intercept, corresponding to age = 0, sex = Female,</span></span>
<span><span class="co">#&gt; longitude = 0 and ghi_month = 0, is at 19427.76 (95% CI [18665.26,</span></span>
<span><span class="co">#&gt; 20190.26], t(65818) = 49.94, p &lt; .001). Within this model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - The effect of age is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -124.88, 95% CI [-128.26, -121.49], t(65818) = -72.30, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; -0.27, 95% CI [-0.28, -0.26])</span></span>
<span><span class="co">#&gt;   - The effect of sex [Male] is statistically significant and positive (beta =</span></span>
<span><span class="co">#&gt; 358.49, 95% CI [281.91, 435.07], t(65818) = 9.18, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; 0.07, 95% CI [0.05, 0.08])</span></span>
<span><span class="co">#&gt;   - The effect of longitude is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -71.87, 95% CI [-81.41, -62.33], t(65818) = -14.76, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; -0.07, 95% CI [-0.08, -0.06])</span></span>
<span><span class="co">#&gt;   - The effect of ghi month is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -0.52, 95% CI [-0.60, -0.44], t(65818) = -13.02, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; -0.06, 95% CI [-0.07, -0.05])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized parameters were obtained by fitting the model on a standardized</span></span>
<span><span class="co">#&gt; version of the dataset. 95% Confidence Intervals (CIs) and p-values were</span></span>
<span><span class="co">#&gt; computed using a Wald t-distribution approximation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="evaluating-the-model-fit" class="level3" data-number="E.7.2"><h3 data-number="E.7.2" class="anchored" data-anchor-id="evaluating-the-model-fit">
<span class="header-section-number">E.7.2</span> Evaluating the Model Fit</h3>
<section id="predictions" class="level4" data-number="E.7.2.1"><h4 data-number="E.7.2.1" class="anchored" data-anchor-id="predictions">
<span class="header-section-number">E.7.2.1</span> Predictions</h4>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">limits</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_engine</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">limits</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">.pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span>  <span class="co">#   alpha = 0.2</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">lwr</span> <span class="op">~</span> <span class="va">msf_sc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      ymax <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">upr</span> <span class="op">~</span> <span class="va">msf_sc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lwr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observed"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Predicted"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.19: Relation between observed and predicted values. The red line is a 45-degree line originating from the plane’s origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <a href="http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/">prediction interval</a>.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="posterior-predictive-checks" class="level4" data-number="E.7.2.2"><h4 data-number="E.7.2.2" class="anchored" data-anchor-id="posterior-predictive-checks">
<span class="header-section-number">E.7.2.2</span> Posterior Predictive Checks</h4>
<p>Posterior predictive checks are a Bayesian technique used to assess model fit by comparing observed data to data simulated from the <a href="https://en.wikipedia.org/wiki/Posterior_predictive_distribution">posterior predictive distribution</a> (i.e., the distribution of potential unobserved values given the observed data). These checks help identify systematic discrepancies between the observed and simulated data, providing insight into whether the chosen model (or distributional family) is appropriate. Ideally, the model-predicted lines should closely match the observed data patterns.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">PP_CHECK</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"MSFsc (Chronotype proxy) (s)"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-fit-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-fit-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.20: Posterior predictive checks for the model. The red line represents the observed data, while the black lines represent the model-predicted data.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-fit-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="conducting-model-diagnostics" class="level3" data-number="E.7.3"><h3 data-number="E.7.3" class="anchored" data-anchor-id="conducting-model-diagnostics">
<span class="header-section-number">E.7.3</span> Conducting Model Diagnostics</h3>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It’s important to note that objective assumption tests (e.g., Anderson–Darling test) is not advisable for larger samples, since they can be overly sensitive to minor deviations. Additionally, they might overlook visual patterns that are not captured by a single metric <span class="citation" data-cites="shatz2024 kozak2018 schucany2006">(<a href="references.html#ref-kozak2018" role="doc-biblioref">Kozak &amp; Piepho, 2018</a>; <a href="references.html#ref-schucany2006" role="doc-biblioref">Schucany &amp; Ng, 2006</a>; <a href="references.html#ref-shatz2024" role="doc-biblioref">Shatz, 2024</a>)</span>.</p>
<p>I included those tests here <strong>just for reference</strong>. However, for the reason above, all assumptions were diagnosed by <strong>visual assessment</strong>.</p>
<p>For a straightforward critique of normality tests specifically, refer to <a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90">this</a> article by <span class="citation" data-cites="greener2020">Greener (<a href="references.html#ref-greener2020" role="doc-biblioref">2020</a>)</span>.</p>
</div>
</div>
</div>
<section id="normality" class="level4" data-number="E.7.3.1"><h4 data-number="E.7.3.1" class="anchored" data-anchor-id="normality">
<span class="header-section-number">E.7.3.1</span> Normality</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 2</dt>
<dd>
<strong>Normality</strong>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the conditional distribution of <span class="math inline">\(Y_{i}\)</span> given the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is a normal distribution <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Normality of the error term distribution <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 2</strong> is satisfied, as the residuals shown a fairly normal distribution by visual inspection.</p>
<section id="visual-inspection" class="level5" data-number="E.7.3.1.1"><h5 data-number="E.7.3.1.1" class="anchored" data-anchor-id="visual-inspection">
<span class="header-section-number">E.7.3.1.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span>, name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.21: Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable"</span>, y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.22: Boxplot of model residuals with outliers highlighted in red.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span>, name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.11: Summary statistics of model residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Residuals"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"-54.9569892419084"},{"1":"var","2":"25157728.0619692"},{"1":"sd","2":"5015.74800622691"},{"1":"min","2":"-16212.388379373"},{"1":"q_1","2":"-3610.73607764143"},{"1":"median","2":"-437.134292946821"},{"1":"q_3","2":"3237.22333472098"},{"1":"max","2":"18057.9971081138"},{"1":"iqr","2":"6847.9594123624"},{"1":"range","2":"34270.3854874868"},{"1":"skewness","2":"0.258692925838423"},{"1":"kurtosis","2":"2.82008795139112"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="tests" class="level5" data-number="E.7.3.1.2"><h5 data-number="E.7.3.1.2" class="anchored" data-anchor-id="tests">
<span class="header-section-number">E.7.3.1.2</span> Tests</h5>
<p>It’s important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don’t recommend using them when testing for normality <span class="citation" data-cites="dagostino1990">(<a href="references.html#ref-dagostino1990" role="doc-biblioref">D’Agostino &amp; Belanger, 1990</a>)</span>. Learn more about normality tests in <span class="citation" data-cites="thode2002">Thode (<a href="references.html#ref-thode2002" role="doc-biblioref">2002</a>)</span>.</p>
<p>I also recommend checking the original papers for each test to understand their assumptions and limitations:</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test">Anderson-Darling test</a>: <span class="citation" data-cites="anderson1952">Anderson &amp; Darling (<a href="references.html#ref-anderson1952" role="doc-biblioref">1952</a>)</span>; <span class="citation" data-cites="anderson1954">Anderson &amp; Darling (<a href="references.html#ref-anderson1954" role="doc-biblioref">1954</a>)</span>.</li>
<li>Bonett-Seier test: <span class="citation" data-cites="bonett2002">Bonett &amp; Seier (<a href="references.html#ref-bonett2002" role="doc-biblioref">2002</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion">Cramér-von Mises test</a>: <span class="citation" data-cites="cramer1928">Cramér (<a href="references.html#ref-cramer1928" role="doc-biblioref">1928</a>)</span>; <span class="citation" data-cites="anderson1962">Anderson (<a href="references.html#ref-anderson1962" role="doc-biblioref">1962</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test">D’Agostino test</a>: <span class="citation" data-cites="dagostino1971">D’Agostino (<a href="references.html#ref-dagostino1971" role="doc-biblioref">1971</a>)</span>; <span class="citation" data-cites="dagostino1973">D’Agostino &amp; Pearson (<a href="references.html#ref-dagostino1973" role="doc-biblioref">1973</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test">Jarque–Bera test</a>: <span class="citation" data-cites="jarque1980">Jarque &amp; Bera (<a href="references.html#ref-jarque1980" role="doc-biblioref">1980</a>)</span>; <span class="citation" data-cites="bera1981">Bera &amp; Jarque (<a href="references.html#ref-bera1981" role="doc-biblioref">1981</a>)</span>; <span class="citation" data-cites="jarque1987">Jarque &amp; Bera (<a href="references.html#ref-jarque1987" role="doc-biblioref">1987</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Lilliefors_test">Lilliefors (K-S) test</a>: <span class="citation" data-cites="smirnov1948">Smirnov (<a href="references.html#ref-smirnov1948" role="doc-biblioref">1948</a>)</span>; <span class="citation" data-cites="kolmogorov1933">Kolmogorov (<a href="references.html#ref-kolmogorov1933" role="doc-biblioref">1933</a>)</span>; <span class="citation" data-cites="massey1951">Massey (<a href="references.html#ref-massey1951" role="doc-biblioref">1951</a>)</span>; <span class="citation" data-cites="lilliefors1967">Lilliefors (<a href="references.html#ref-lilliefors1967" role="doc-biblioref">1967</a>)</span>; <span class="citation" data-cites="dallal1986">Dallal &amp; Wilkinson (<a href="references.html#ref-dallal1986" role="doc-biblioref">1986</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson chi-square test</a>: <span class="citation" data-cites="pearson1900">Pearson (<a href="references.html#ref-pearson1900" role="doc-biblioref">1900</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test">Shapiro-Francia test</a>: <span class="citation" data-cites="shapiro1972">Shapiro &amp; Francia (<a href="references.html#ref-shapiro1972" role="doc-biblioref">1972</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a>: <span class="citation" data-cites="shapiro1965">Shapiro &amp; Wilk (<a href="references.html#ref-shapiro1965" role="doc-biblioref">1965</a>)</span>.</li>
</ul>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The data is normally distributed} \\
\text{H}_{a}: \text{The data is not normally distributed}
\end{cases}
\]</span></p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_summary</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.12: Summary of statistical tests conducted to assess the normality of the residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["test"],"name":[1],"type":["chr"],"align":["left"]},{"label":["statistic_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["statistic_2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p_value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Anderson-Darling","2":"125.705493","3":"NA","4":"3.7000e-24"},{"1":"Bonett-Seier","2":"4034.717824","3":"-7.7971","4":"6.4393e-15"},{"1":"Cramer-von Mises","2":"21.198262","3":"NA","4":"7.3700e-10"},{"1":"D'Agostino Omnibus Test","2":"NA","3":"NA","4":"NA"},{"1":"D'Agostino Skewness Test","2":"26.664726","3":"NA","4":"0.0000e+00"},{"1":"D'Agostino Kurtosis Test","2":"NA","3":"NA","4":"NA"},{"1":"Jarque–Bera","2":"822.942362","3":"2.0000","4":"0.0000e+00"},{"1":"Lilliefors (K-S)","2":"0.030786","3":"NA","4":"1.7682e-162"},{"1":"Pearson chi-square","2":"1597.474150","3":"NA","4":"9.3881e-232"},{"1":"Shapiro-Francia","2":"NA","3":"NA","4":"NA"},{"1":"Shapiro-Wilk","2":"NA","3":"NA","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="linearity" class="level4" data-number="E.7.3.2"><h4 data-number="E.7.3.2" class="anchored" data-anchor-id="linearity">
<span class="header-section-number">E.7.3.2</span> Linearity</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 3</dt>
<dd>
<strong>Linear mean</strong>. There is a vector of parameters <span class="math inline">\(\beta = (\beta_{0}, \dots, \beta_{p - 1})\)</span> such that the conditional mean of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> has the form
</dd>
</dl>
<p><span class="math display">\[
z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, n\)</span> <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.</p>
<p>(Linearity of the phenomenon measured <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<p>It is important to clarify that the linear assumption pertains to <strong>linearity in the parameters</strong> or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="citation" data-cites="cohen2002">(<a href="references.html#ref-cohen2002" role="doc-biblioref">Cohen et al., 2002</a>)</span>.</p>
</div>
</div>
</div>
<p><strong>Assumption 3</strong> is satisfied, as the relationship between the variables is fairly linear.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span> </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted values"</span>, y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-residual-diag-fitted-values-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.23: Residual plot showing the relationship between fitted values and residuals. The dashed black line represent zero residuals, indicating an ideal model fit. The red line indicate the conditional mean of residuals.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_fit_spread.html">ols_plot_resid_fit_spread</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">layers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">constructor</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  </span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">plots</span><span class="op">$</span><span class="va">fm_plot</span>, <span class="va">plots</span><span class="op">$</span><span class="va">rsd_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-residual-diag-linearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.24: Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. “Proportion Less” indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>The <a href="https://en.wikipedia.org/wiki/Ramsey_RESET_test">Ramsey’s RESET test</a> indicates that the model has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</p>
<p>Learn more about the Ramsey’s RESET test in: <span class="citation" data-cites="ramsey1969">Ramsey (<a href="references.html#ref-ramsey1969" role="doc-biblioref">1969</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The model has no omitted variables} \\
\text{H}_{a}: \text{The model has omitted variables}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 155, df1 = 2, df2 = 65816, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"regressor"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 48.1, df1 = 10, df2 = 65808, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="homoscedasticity-common-variance" class="level4" data-number="E.7.3.3"><h4 data-number="E.7.3.3" class="anchored" data-anchor-id="homoscedasticity-common-variance">
<span class="header-section-number">E.7.3.3</span> Homoscedasticity (Common Variance)</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 4</dt>
<dd>
<strong>Common variance</strong> (homoscedasticity). There is as parameter <span class="math inline">\(\sigma^{2}\)</span> such the conditional variance of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is <span class="math inline">\(\sigma^{2}\)</span> for <span class="math inline">\(i = 1, \dots, n\)</span>.
</dd>
</dl>
<p>(Constant variance of the error terms <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 4</strong> is satisfied. When comparing the standardized residuals (<span class="math inline">\(\sqrt{|\text{Standardized Residuals}|}\)</span>) spread to the fitted values, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</p>
<section id="visual-inspection-1" class="level5" data-number="E.7.3.3.1"><h5 data-number="E.7.3.3.1" class="anchored" data-anchor-id="visual-inspection-1">
<span class="header-section-number">E.7.3.3.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Fitted values"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{|Standardized \\ Residuals|}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-homoscedasticity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.25: Relation between the fitted values of the model and its standardized residuals.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">MSF<sub>sc</sub> (Chronotype proxy) (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Age (years)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Longitude (decimal degrees)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Monthly average global horizontal irradiance (Wh/m²)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'MSF~sc~  (Chronotype proxy) (seconds)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-homoscedasticity-msf-sc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-homoscedasticity-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.13: Relation between <code>msf_sc</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-homoscedasticity-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Age (years)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-homoscedasticity-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-homoscedasticity-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.14: Relation between <code>age</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-homoscedasticity-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Longitude (decimal degrees)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-homoscedasticity-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-homoscedasticity-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.15: Relation between <code>longitude</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-homoscedasticity-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ghi_month</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Monthly average global horizontal irradiance (Wh/m²)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-homoscedasticity-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-homoscedasticity-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.16: Relation between <code>ghi_month</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-homoscedasticity-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section><section id="breusch-pagan-test" class="level5" data-number="E.7.3.3.2"><h5 data-number="E.7.3.3.2" class="anchored" data-anchor-id="breusch-pagan-test">
<span class="header-section-number">E.7.3.3.2</span> Breusch-Pagan Test</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test">Breusch-Pagan test</a> test indicates that the residuals exhibit constant variance.</p>
<p>Learn more about the Breusch-Pagan test in: <span class="citation" data-cites="breusch1979">Breusch &amp; Pagan (<a href="references.html#ref-breusch1979" role="doc-biblioref">1979</a>)</span> and <span class="citation" data-cites="koenker1981">Koenker (<a href="references.html#ref-koenker1981" role="doc-biblioref">1981</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The variance is constant} \\
\text{H}_{a}: \text{The variance is not constant}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># With studentising modification of Koenker</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 1123, df = 4, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 1545, df = 4, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the studentized modification of Koenker.</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"187.76","2":"1.608e-39","3":"4","4":"Koenker (studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"169.81","2":"1.1506e-35","3":"4","4":"Breusch-Pagan (non-studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html">ncvTest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Non-constant Variance Score Test </span></span>
<span><span class="co">#&gt; Variance formula: ~ fitted.values </span></span>
<span><span class="co">#&gt; Chisquare = 8204.7, Df = 1, p = &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Data                </span></span>
<span><span class="co">#&gt;  ----------------------------------</span></span>
<span><span class="co">#&gt;  Response : msf_sc </span></span>
<span><span class="co">#&gt;  Variables: fitted values of msf_sc </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    78.5315 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    7.8731e-19</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="independence" class="level4" data-number="E.7.3.4"><h4 data-number="E.7.3.4" class="anchored" data-anchor-id="independence">
<span class="header-section-number">E.7.3.4</span> Independence</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 5</dt>
<dd>
<strong>Independence</strong>. The random variables <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> are independent given the observed <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Independence of the error terms <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 5</strong> is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic (<span class="math inline">\(1.5\)</span> to <span class="math inline">\(2.5\)</span>). It’s also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see <span class="citation" data-cites="hair2019">Hair (<a href="references.html#ref-hair2019" role="doc-biblioref">2019, p. 291</a>)</span> for more information).</p>
<p>Many authors don’t consider autocorrelation tests for linear regression models, as they are more relevant for time series data. They were include here just for reference.</p>
<section id="visual-inspection-2" class="level5" data-number="E.7.3.4.1"><h5 data-number="E.7.3.4.1" class="anchored" data-anchor-id="visual-inspection-2">
<span class="header-section-number">E.7.3.4.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tsdisplay.html">ggtsdisplay</a></span><span class="op">(</span>lag.max<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-independence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.26: Time series plot of the residuals along with its AutoCorrelation Function (ACF) and Partial AutoCorrelation Function (PACF).
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="correlations" class="level5" data-number="E.7.3.4.2"><h5 data-number="E.7.3.4.2" class="anchored" data-anchor-id="correlations">
<span class="header-section-number">E.7.3.4.2</span> Correlations</h5>
<p><span class="quarto-unresolved-ref">?tbl-model-residual-diag-independence-1</span> shows the relative importance of independent variables in determining the response variable. It highlights how much each variable uniquely contributes to the R-squared value, beyond what is explained by the other predictors.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_correlations.html">ols_correlations</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-independence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.17: Correlations between the dependent variable and the independent variables, along with the zero-order, part, and partial correlations. The zero-order correlation represents the Pearson correlation coefficient between the dependent and independent variables. Part correlations indicate how much the R-squared would decrease if a specific variable were removed from the model, while partial correlations reflect the portion of variance in the response variable that is explained by a specific independent variable, beyond the influence of other predictors in the model.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Zero-order"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Partial"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Part"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.225843","2":"-0.28090","3":"-0.27995","_rn_":"age"},{"1":"0.039388","2":"0.17005","3":"0.16505","_rn_":"sexMale"},{"1":"-0.068086","2":"-0.17040","3":"-0.16540","_rn_":"longitude"},{"1":"-0.049365","2":"-0.16807","3":"-0.16308","_rn_":"ghi_month"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="newey-west-estimator" class="level5" data-number="E.7.3.4.3"><h5 data-number="E.7.3.4.3" class="anchored" data-anchor-id="newey-west-estimator">
<span class="header-section-number">E.7.3.4.3</span> Newey-West Estimator</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator">Newey-West estimator</a> is a method used to estimate the <a href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a> of the coefficients in a regression model when the residuals are autocorrelated.</p>
<p>Learn more about the Newey-West estimator in: <span class="citation" data-cites="newey1987">Newey &amp; West (<a href="references.html#ref-newey1987" role="doc-biblioref">1987</a>)</span> and <span class="citation" data-cites="newey1994">Newey &amp; West (<a href="references.html#ref-newey1994" role="doc-biblioref">1994</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/NeweyWest.html">NeweyWest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;             (Intercept)         age     sexMale longitude   ghi_month</span></span>
<span><span class="co">#&gt; (Intercept)  386230.754 -627.665938 -3949.06138 4052.0281 -34.3290554</span></span>
<span><span class="co">#&gt; age            -627.666   11.376222    10.79844    1.9351   0.0679683</span></span>
<span><span class="co">#&gt; sexMale       -3949.061   10.798444  3917.64422   -3.1561   0.4120212</span></span>
<span><span class="co">#&gt; longitude      4052.028    1.935117    -3.15610   64.4732  -0.2237990</span></span>
<span><span class="co">#&gt; ghi_month       -34.329    0.067968     0.41202   -0.2238   0.0042088</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="durbin-watson-test" class="level5" data-number="E.7.3.4.4"><h5 data-number="E.7.3.4.4" class="anchored" data-anchor-id="durbin-watson-test">
<span class="header-section-number">E.7.3.4.4</span> Durbin-Watson Test</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic">Durbin-Watson test</a> is a statistical test used to detect the presence of autocorrelation at lag <span class="math inline">\(1\)</span> in the residuals from a regression analysis. The test statistic ranges from <span class="math inline">\(0\)</span> to <span class="math inline">\(4\)</span>, with a value of <span class="math inline">\(2\)</span> indicating no autocorrelation. Values less than <span class="math inline">\(2\)</span> indicate positive autocorrelation, while values greater than <span class="math inline">\(2\)</span> indicate negative autocorrelation <span class="citation" data-cites="fox2016">(<a href="references.html#ref-fox2016" role="doc-biblioref">Fox, 2016</a>)</span>.</p>
<p>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between <span class="math inline">\(1.5\)</span> and <span class="math inline">\(2.5\)</span> suggests little to no autocorrelation.</p>
<p>Learn more about the Durbin-Watson test in: <span class="citation" data-cites="durbin1950">Durbin &amp; Watson (<a href="references.html#ref-durbin1950" role="doc-biblioref">1950</a>)</span>; <span class="citation" data-cites="durbin1951">Durbin &amp; Watson (<a href="references.html#ref-durbin1951" role="doc-biblioref">1951</a>)</span>; and <span class="citation" data-cites="durbin1971">Durbin &amp; Watson (<a href="references.html#ref-durbin1971" role="doc-biblioref">1971</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} \\
\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/durbinWatsonTest.html">durbinWatsonTest</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="co">#&gt;  lag Autocorrelation D-W Statistic p-value</span></span>
<span><span class="co">#&gt;    1        0.036042        1.9279       0</span></span>
<span><span class="co">#&gt;  Alternative hypothesis: rho != 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="ljung-box-test" class="level5" data-number="E.7.3.4.5"><h5 data-number="E.7.3.4.5" class="anchored" data-anchor-id="ljung-box-test">
<span class="header-section-number">E.7.3.4.5</span> Ljung-Box Test</h5>
<p>The Ljung–Box test is a statistical test used to determine whether any autocorrelations within a time series are significantly different from zero. Rather than testing randomness at individual lags, it assesses the “overall” randomness across multiple lags.</p>
<p>Learn more about the <a href="https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test">Ljung-Box test</a> in: <span class="citation" data-cites="box1970">Box &amp; Pierce (<a href="references.html#ref-box1970" role="doc-biblioref">1970</a>)</span> and <span class="citation" data-cites="ljung1978">Ljung &amp; Box (<a href="references.html#ref-ljung1978" role="doc-biblioref">1978</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Residuals are independently distributed} \\
\text{H}_{a}: \text{Residuals are not independently distributed}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Ljung-Box"</span>, lag <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Box-Ljung test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::residuals(fit_engine)</span></span>
<span><span class="co">#&gt; X-squared = 1078, df = 10, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="colinearitymulticollinearity" class="level4" data-number="E.7.3.5"><h4 data-number="E.7.3.5" class="anchored" data-anchor-id="colinearitymulticollinearity">
<span class="header-section-number">E.7.3.5</span> Colinearity/Multicollinearity</h4>
<p>No high degree of colinearity was observed among the independent variables.</p>
<section id="variance-inflation-factor-vif" class="level5" data-number="E.7.3.5.1"><h5 data-number="E.7.3.5.1" class="anchored" data-anchor-id="variance-inflation-factor-vif">
<span class="header-section-number">E.7.3.5.1</span> Variance Inflation Factor (VIF)</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Variance_inflation_factor">Variance Inflation Factor (VIF)</a> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value (<span class="math inline">\(\text{VIF}_{i} = 1/\text{TO}L\)</span>). High VIF values (larger than ~5 <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 265</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span>panel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">VIF</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.27: Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.
</figcaption><div aria-describedby="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_vif_tol</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.18: Variance Inflation Factors (VIF) and tolerance values for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Variables"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Tolerance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"age","2":"0.99263","3":"1.0074"},{"1":"sexMale","2":"0.99862","3":"1.0014"},{"1":"longitude","2":"0.82335","3":"1.2146"},{"1":"ghi_month","2":"0.81861","3":"1.2216"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_collinearity.html">check_collinearity</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-colinearity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.19: Variance Inflation Factors (VIF) and tolerance values for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["VIF"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_high"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE_factor"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Tolerance"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_high"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"age","2":"1.0034","3":"1.0003","4":"1.0332","5":"1.0017","6":"0.99666","7":"0.967879515","8":"0.99966"},{"1":"sex","2":"1.0004","3":"1.0000","4":"70959.9826","5":"1.0002","6":"0.99960","7":"0.000014092","8":"1.00000"},{"1":"longitude","2":"1.4869","3":"1.4721","4":"1.5023","5":"1.2194","6":"0.67252","7":"0.665666640","8":"0.67930"},{"1":"ghi_month","2":"1.4904","3":"1.4755","4":"1.5058","5":"1.2208","6":"0.67095","7":"0.664104889","8":"0.67773"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="condition-index" class="level5" data-number="E.7.3.5.2"><h5 data-number="E.7.3.5.2" class="anchored" data-anchor-id="condition-index">
<span class="header-section-number">E.7.3.5.2</span> Condition Index</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Condition_number">condition index</a> is a measure of multicollinearity in a regression model. It is based on the <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvalues</a> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="citation" data-cites="belsley2004">(<a href="references.html#ref-belsley2004" role="doc-biblioref">Belsley et al., 2004, pp. 112–114</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_eigen_cindex</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-residual-diag-colinearity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.20: Condition indexes and eigenvalues for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Eigenvalue"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition Index"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intercept"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sexMale"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["longitude"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ghi_month"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.3217122","2":"1.0000","3":"0.00013401","4":"0.0038262","5":"0.01639310","6":"0.00033207","7":"0.00048007"},{"1":"0.6028779","2":"2.6774","3":"0.00011219","4":"0.0034526","5":"0.98286857","6":"0.00028634","7":"0.00039792"},{"1":"0.0602885","2":"8.4666","3":"0.00282348","4":"0.9510061","5":"0.00023805","6":"0.00723840","7":"0.01721218"},{"1":"0.0133900","2":"17.9654","3":"0.00122247","4":"0.0130970","5":"0.00016760","6":"0.22414428","7":"0.35917424"},{"1":"0.0017313","2":"49.9628","3":"0.99570784","4":"0.0286180","5":"0.00033269","6":"0.76799891","7":"0.62273559"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="measures-of-influence" class="level4" data-number="E.7.3.6"><h4 data-number="E.7.3.6" class="anchored" data-anchor-id="measures-of-influence">
<span class="header-section-number">E.7.3.6</span> Measures of Influence</h4>
<p>In this section, I check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Leverage points</dt>
<dd>
Leverage is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence the model estimates <span class="citation" data-cites="struck2024 hair2019 nahhas2024">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 262</a>; <a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>; <a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
</dl>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Influence points</dt>
<dd>
Influence is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="citation" data-cites="struck2024 nahhas2024">(<a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>; <a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
</dl>
</div>
</div>
</div>
<section id="standardized-residuals" class="level5" data-number="E.7.3.6.1"><h5 data-number="E.7.3.6.1" class="anchored" data-anchor-id="standardized-residuals">
<span class="header-section-number">E.7.3.6.1</span> Standardized Residuals</h5>
<p>Standardized residuals are a rescaling of the residual to a common basis by dividing each residual by the standard deviation of the residuals <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 264</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         1         2         3         4         5         6 </span></span>
<span><span class="co">#&gt;  1.163752  1.907417 -0.052837  0.153255  0.896756  0.314862</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">std</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">std</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Standardized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.28: Standardized residuals for each observation.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="studentized-residuals" class="level5" data-number="E.7.3.6.2"><h5 data-number="E.7.3.6.2" class="anchored" data-anchor-id="studentized-residuals">
<span class="header-section-number">E.7.3.6.2</span> Studentized Residuals</h5>
<p><a href="https://en.wikipedia.org/wiki/Studentized_residual">Studentized residuals</a> are a commonly used variant of the standardized residual. It differs from other methods in how it calculates the standard deviation used in standardization. To minimize the effect of any observation on the standardization process, the standard deviation of the residual for observation <span class="math inline">\(i\)</span> is computed from regression estimates omitting the <span class="math inline">\(i\)</span>th observation in the calculation of the regression estimates <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 264</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         1         2         3         4         5         6 </span></span>
<span><span class="co">#&gt;  1.163755  1.907455 -0.052837  0.153253  0.896755  0.314860</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">std</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">std</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.29: Studentized residuals for each observation.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">std</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Predicted value"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.30: Relation between studentized residuals and fitted values.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">2</span>, print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.31: Relation between studentized residuals and their leverage points.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="hat-values" class="level5" data-number="E.7.3.6.3"><h5 data-number="E.7.3.6.3" class="anchored" data-anchor-id="hat-values">
<span class="header-section-number">E.7.3.6.3</span> Hat Values</h5>
<p>The hat value indicates how distinct an observation’s predictor values are from those of other observations. Observations with high hat values have high leverage and may be, though not necessarily, influential. There is no fixed threshold for what constitutes a “large” hat value; instead, the focus must be on observations with hat values significantly higher than the rest <span class="citation" data-cites="nahhas2024 hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>; <a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; 0.000101465 0.000052680 0.000018723 0.000281159 0.000092030 0.000093417</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  hat <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">hat</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">hat</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Hat value"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.32: Hat values for each observation.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="cooks-distance" class="level5" data-number="E.7.3.6.4"><h5 data-number="E.7.3.6.4" class="anchored" data-anchor-id="cooks-distance">
<span class="header-section-number">E.7.3.6.4</span> Cook’s Distance</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s D</a> measures each observation’s influence on the model’s fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>A common practice is to flag observations with a Cook’s distance of 1.0 or greater. However, a threshold of <span class="math inline">\(4 / (n - k - 1)\)</span>, where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(k\)</span> is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>Learn more about Cook’s D in: <span class="citation" data-cites="cook1977">Cook (<a href="references.html#ref-cook1977" role="doc-biblioref">1977</a>)</span>; <span class="citation" data-cites="cook1979">Cook (<a href="references.html#ref-cook1979" role="doc-biblioref">1979</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;              1              2              3              4              5 </span></span>
<span><span class="co">#&gt; 0.000027485903 0.000038334624 0.000000010454 0.000001321087 0.000014802922 </span></span>
<span><span class="co">#&gt;              6 </span></span>
<span><span class="co">#&gt; 0.000001852406</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fl">2</span>, print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.33: Cook’s distance for each observation along with a threshold line at <span class="math inline">\(4 / (n - k - 1)\)</span>.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">OUTLIERS</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Leverage"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residuals"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gray25"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"blue"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"#1b6ca8"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"darkgray"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.34: Relation between studentized residuals and their leverage points. The blue line represents the <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s distance</a>. Any points outside the contour lines are influential observations.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="influence-on-prediction-dffits" class="level5" data-number="E.7.3.6.5"><h5 data-number="E.7.3.6.5" class="anchored" data-anchor-id="influence-on-prediction-dffits">
<span class="header-section-number">E.7.3.6.5</span> Influence on Prediction (DFFITS)</h5>
<p><a href="https://en.wikipedia.org/wiki/DFFITS">DFFITS</a> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.</p>
<p>The best rule of thumb is to classify as influential any standardized values that exceed <span class="math inline">\(2 \sqrt{(p / n)}\)</span>, where <span class="math inline">\(p\)</span> is the number of independent variables + 1 and <span class="math inline">\(n\)</span> is the sample size <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>)</span>.</p>
<p>Learn more about DDFITS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="references.html#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="references.html#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt;  0.01172307  0.01384488 -0.00022863  0.00257009  0.00860316  0.00304334</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dffits.html">ols_plot_dffits</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.35: Standardized DFFITS (difference in fits) for each observation.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="influence-on-parameter-estimates-dfbetas" class="level5" data-number="E.7.3.6.6"><h5 data-number="E.7.3.6.6" class="anchored" data-anchor-id="influence-on-parameter-estimates-dfbetas">
<span class="header-section-number">E.7.3.6.6</span> Influence on Parameter Estimates (DFBETAS)</h5>
<p><a href="https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence">DFBETAS</a> are a measure of the change in a regression coefficient when an observation is omitted from the regression analysis. <strong>The value of the DFBETA is in terms of the coefficient itself</strong> <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>)</span>. A cutoff for what is considered a large DFBETAS value is <span class="math inline">\(2 / \sqrt{n}\)</span>, where <span class="math inline">\(n\)</span> is the number of observations. <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.</p>
<p>Learn more about DFBETAS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="references.html#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="references.html#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept)         age   sexMale    longitude     ghi_month</span></span>
<span><span class="co">#&gt; 1    -2.03641 -0.01035496 0.1660408 -0.037824009  0.0001380335</span></span>
<span><span class="co">#&gt; 2     1.78098 -0.00865264 0.2434880 -0.002714440 -0.0002994375</span></span>
<span><span class="co">#&gt; 3    -0.03682  0.00021258 0.0045601 -0.000083841  0.0000039305</span></span>
<span><span class="co">#&gt; 4     0.43148 -0.00238505 0.0345007  0.007259700 -0.0000036283</span></span>
<span><span class="co">#&gt; 5    -0.31752 -0.00836078 0.1416904 -0.017301463 -0.0000277009</span></span>
<span><span class="co">#&gt; 6    -0.60088 -0.00167663 0.0495628 -0.010621353  0.0000356531</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Intercept</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">age</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">sexMale</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">longitude</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">ghi_month</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Intercept coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-influence-intercept" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-influence-intercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.21: Standardized DFBETAS values for each observation concerning the <code>Intercept</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-influence-intercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'age coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-influence-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-influence-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.22: Standardized DFBETAS values for each observation concerning the <code>age</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-influence-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'sexMale coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-influence-sexmale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-influence-sexmale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.23: Standardized DFBETAS values for each observation concerning the <code>sexMale</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-influence-sexmale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'longitude coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-influence-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-influence-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.24: Standardized DFBETAS values for each observation concerning the <code>longitude</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-influence-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'ghi_month coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-restricted-model-diag-influence-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-restricted-model-diag-influence-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.25: Standardized DFBETAS values for each observation concerning the <code>ghi_month</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-restricted-model-diag-influence-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section><section id="hadis-measure" class="level5" data-number="E.7.3.6.7"><h5 data-number="E.7.3.6.7" class="anchored" data-anchor-id="hadis-measure">
<span class="header-section-number">E.7.3.6.7</span> Hadi’s Measure</h5>
<p>Hadi’s measure of influence is based on the idea that influential observations can occur in either the response variable, the predictors, or both.</p>
<p>Learn more about Hadi’s measure in: <span class="citation" data-cites="chatterjee2012">Chatterjee &amp; Hadi (<a href="references.html#ref-chatterjee2012" role="doc-biblioref">2012</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_hadi.html">ols_plot_hadi</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Hadi's measure"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.36: Hadi’s influence measure for each observation.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_pot.html">ols_plot_resid_pot</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-restricted-model-diag-influence-13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-restricted-model-diag-influence-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.37: Potential-residual plot classifying unusual observations as high-leverage points, outliers, or a combination of both.
</figcaption><div aria-describedby="fig-sm-5-restricted-model-diag-influence-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section></section></section><section id="building-the-full-model" class="level2" data-number="E.8"><h2 data-number="E.8" class="anchored" data-anchor-id="building-the-full-model">
<span class="header-section-number">E.8</span> Building the Full Model</h2>
<section id="fitting-the-model-1" class="level3" data-number="E.8.1"><h3 data-number="E.8.1" class="anchored" data-anchor-id="fitting-the-model-1">
<span class="header-section-number">E.8.1</span> Fitting the Model</h3>
<!-- See: <https://stats.stackexchange.com/questions/25804/why-would-r-return-na-as-a-lm-coefficient> -->
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"msf_sc ~ "</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>          <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"longitude"</span>, <span class="st">"ghi_month"</span>, </span>
<span>          <span class="st">"ghi_annual"</span>, <span class="st">"march_equinox_daylight"</span>, <span class="st">"june_solstice_daylight"</span>,</span>
<span>          <span class="st">"december_solstice_daylight"</span></span>
<span>        <span class="op">)</span>, </span>
<span>        collapse <span class="op">=</span> <span class="st">" + "</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span>, weights <span class="op">=</span> <span class="va">cell_weight</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = form, data = data, weights = cell_weight)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                (Intercept)                         age  </span></span>
<span><span class="co">#&gt;               -9295025.714                    -125.992  </span></span>
<span><span class="co">#&gt;                    sexMale                   longitude  </span></span>
<span><span class="co">#&gt;                    358.605                     -86.360  </span></span>
<span><span class="co">#&gt;                  ghi_month                  ghi_annual  </span></span>
<span><span class="co">#&gt;                     -0.351                       0.612  </span></span>
<span><span class="co">#&gt;     march_equinox_daylight      june_solstice_daylight  </span></span>
<span><span class="co">#&gt;                    471.322                    -129.040  </span></span>
<span><span class="co">#&gt; december_solstice_daylight  </span></span>
<span><span class="co">#&gt;                   -128.373</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">workflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_case_weights.html">add_case_weights</a></span><span class="op">(</span><span class="va">cell_weight</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_formula.html">add_formula</a></span><span class="op">(</span><span class="va">form</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">workflow</span></span>
<span><span class="co">#&gt; ══ Workflow ═════════════════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; Preprocessor: Formula</span></span>
<span><span class="co">#&gt; Model: linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; msf_sc ~ age + sex + longitude + ghi_month + ghi_annual + march_equinox_daylight + </span></span>
<span><span class="co">#&gt;     june_solstice_daylight + december_solstice_daylight</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Case Weights ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; cell_weight</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: lm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">workflow</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">fit_full</span> <span class="op">&lt;-</span> <span class="va">fit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-fit-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.26: Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.
</figcaption><div aria-describedby="tbl-sm-5-full-model-fit-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-9295025.71407","3":"1046596.22889","4":"-8.8812","5":"0.00000"},{"1":"age","2":"-125.99177","3":"1.72671","4":"-72.9665","5":"0.00000"},{"1":"sexMale","2":"358.60479","3":"39.01280","4":"9.1920","5":"0.00000"},{"1":"longitude","2":"-86.35980","3":"8.58312","4":"-10.0616","5":"0.00000"},{"1":"ghi_month","2":"-0.35055","3":"0.17591","4":"-1.9928","5":"0.04629"},{"1":"ghi_annual","2":"0.61162","3":"0.27341","4":"2.2370","5":"0.02529"},{"1":"march_equinox_daylight","2":"471.32197","3":"64.77800","4":"7.2760","5":"0.00000"},{"1":"june_solstice_daylight","2":"-129.04030","3":"20.81319","4":"-6.1999","5":"0.00000"},{"1":"december_solstice_daylight","2":"-128.37336","3":"20.66850","4":"-6.2111","5":"0.00000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/adorn_rounding.html">adorn_rounding</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-fit-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.27: Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.
</figcaption><div aria-describedby="tbl-sm-5-full-model-fit-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"r.squared","2":"0.088031"},{"1":"adj.r.squared","2":"0.087921"},{"1":"sigma","2":"4530.469562"},{"1":"statistic","2":"794.119525"},{"1":"p.value","2":"0.000000"},{"1":"df","2":"8.000000"},{"1":"logLik","2":"-664352.623229"},{"1":"AIC","2":"1328725.246457"},{"1":"BIC","2":"1328816.193703"},{"1":"deviance","2":"1350842514862.813477"},{"1":"df.residual","2":"65814.000000"},{"1":"nobs","2":"65823.000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data, weights = weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Weighted Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -45209  -2714   -330   2413  52269 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                                Estimate   Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)                -9295025.714  1046596.229   -8.88</span></span>
<span><span class="co">#&gt; age                            -125.992        1.727  -72.97</span></span>
<span><span class="co">#&gt; sexMale                         358.605       39.013    9.19</span></span>
<span><span class="co">#&gt; longitude                       -86.360        8.583  -10.06</span></span>
<span><span class="co">#&gt; ghi_month                        -0.351        0.176   -1.99</span></span>
<span><span class="co">#&gt; ghi_annual                        0.612        0.273    2.24</span></span>
<span><span class="co">#&gt; march_equinox_daylight          471.322       64.778    7.28</span></span>
<span><span class="co">#&gt; june_solstice_daylight         -129.040       20.813   -6.20</span></span>
<span><span class="co">#&gt; december_solstice_daylight     -128.373       20.668   -6.21</span></span>
<span><span class="co">#&gt;                                    Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                         &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; age                                 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; sexMale                             &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; longitude                           &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ghi_month                             0.046 *  </span></span>
<span><span class="co">#&gt; ghi_annual                            0.025 *  </span></span>
<span><span class="co">#&gt; march_equinox_daylight     0.00000000000035 ***</span></span>
<span><span class="co">#&gt; june_solstice_daylight     0.00000000056823 ***</span></span>
<span><span class="co">#&gt; december_solstice_daylight 0.00000000052941 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4530 on 65814 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.088,  Adjusted R-squared:  0.0879 </span></span>
<span><span class="co">#&gt; F-statistic:  794 on 8 and 65814 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span></span>
<span><span class="va">fit_engine_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">form</span>, data <span class="op">=</span> <span class="va">data</span>, weights <span class="op">=</span> <span class="va">cell_weight</span><span class="op">)</span></span>
<span><span class="va">fit_engine_full</span> <span class="op">&lt;-</span> <span class="va">fit_engine_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">report</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">fit_engine_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; We fitted a linear model (estimated using OLS) to predict msf_sc with age,</span></span>
<span><span class="co">#&gt; sex, longitude, ghi_month, ghi_annual, march_equinox_daylight,</span></span>
<span><span class="co">#&gt; june_solstice_daylight and december_solstice_daylight (formula: msf_sc ~ age</span></span>
<span><span class="co">#&gt; + sex + longitude + ghi_month + ghi_annual + march_equinox_daylight +</span></span>
<span><span class="co">#&gt; june_solstice_daylight + december_solstice_daylight). The model explains a</span></span>
<span><span class="co">#&gt; statistically significant and weak proportion of variance (R2 = 0.09, F(8,</span></span>
<span><span class="co">#&gt; 65814) = 794.12, p &lt; .001, adj. R2 = 0.09). The model's intercept,</span></span>
<span><span class="co">#&gt; corresponding to age = 0, sex = Female, longitude = 0, ghi_month = 0,</span></span>
<span><span class="co">#&gt; ghi_annual = 0, march_equinox_daylight = 0, june_solstice_daylight = 0 and</span></span>
<span><span class="co">#&gt; december_solstice_daylight = 0, is at -9.30e+06 (95% CI [-1.13e+07,</span></span>
<span><span class="co">#&gt; -7.24e+06], t(65814) = -8.88, p &lt; .001). Within this model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   - The effect of age is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -125.99, 95% CI [-129.38, -122.61], t(65814) = -72.97, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; -0.27, 95% CI [-0.28, -0.27])</span></span>
<span><span class="co">#&gt;   - The effect of sex [Male] is statistically significant and positive (beta =</span></span>
<span><span class="co">#&gt; 358.60, 95% CI [282.14, 435.07], t(65814) = 9.19, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; 0.07, 95% CI [0.05, 0.08])</span></span>
<span><span class="co">#&gt;   - The effect of longitude is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -86.36, 95% CI [-103.18, -69.54], t(65814) = -10.06, p &lt; .001; Std. beta =</span></span>
<span><span class="co">#&gt; -0.08, 95% CI [-0.10, -0.06])</span></span>
<span><span class="co">#&gt;   - The effect of ghi month is statistically significant and negative (beta =</span></span>
<span><span class="co">#&gt; -0.35, 95% CI [-0.70, -5.77e-03], t(65814) = -1.99, p = 0.046; Std. beta =</span></span>
<span><span class="co">#&gt; -0.04, 95% CI [-0.08, -6.57e-04])</span></span>
<span><span class="co">#&gt;   - The effect of ghi annual is statistically significant and positive (beta =</span></span>
<span><span class="co">#&gt; 0.61, 95% CI [0.08, 1.15], t(65814) = 2.24, p = 0.025; Std. beta = 0.05, 95%</span></span>
<span><span class="co">#&gt; CI [6.57e-03, 0.10])</span></span>
<span><span class="co">#&gt;   - The effect of march equinox daylight is statistically significant and</span></span>
<span><span class="co">#&gt; positive (beta = 471.32, 95% CI [344.36, 598.29], t(65814) = 7.28, p &lt; .001;</span></span>
<span><span class="co">#&gt; Std. beta = 1.00, 95% CI [0.73, 1.26])</span></span>
<span><span class="co">#&gt;   - The effect of june solstice daylight is statistically significant and</span></span>
<span><span class="co">#&gt; negative (beta = -129.04, 95% CI [-169.83, -88.25], t(65814) = -6.20, p &lt;</span></span>
<span><span class="co">#&gt; .001; Std. beta = -45.89, 95% CI [-60.40, -31.39])</span></span>
<span><span class="co">#&gt;   - The effect of december solstice daylight is statistically significant and</span></span>
<span><span class="co">#&gt; negative (beta = -128.37, 95% CI [-168.88, -87.86], t(65814) = -6.21, p &lt;</span></span>
<span><span class="co">#&gt; .001; Std. beta = -46.78, 95% CI [-61.54, -32.02])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized parameters were obtained by fitting the model on a standardized</span></span>
<span><span class="co">#&gt; version of the dataset. 95% Confidence Intervals (CIs) and p-values were</span></span>
<span><span class="co">#&gt; computed using a Wald t-distribution approximation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="evaluating-the-model-fit-1" class="level3" data-number="E.8.2"><h3 data-number="E.8.2" class="anchored" data-anchor-id="evaluating-the-model-fit-1">
<span class="header-section-number">E.8.2</span> Evaluating the Model Fit</h3>
<section id="predictions-1" class="level4" data-number="E.8.2.1"><h4 data-number="E.8.2.1" class="anchored" data-anchor-id="predictions-1">
<span class="header-section-number">E.8.2.1</span> Predictions</h4>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">limits</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_engine</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">limits</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">.pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span>  <span class="co">#   alpha = 0.2</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">lwr</span> <span class="op">~</span> <span class="va">msf_sc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      ymax <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/loess.html">loess</a></span><span class="op">(</span><span class="va">upr</span> <span class="op">~</span> <span class="va">msf_sc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lwr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observed"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Predicted"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.38: Relation between observed and predicted values. The red line is a 45-degree line originating from the plane’s origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <a href="http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/">prediction interval</a>.
</figcaption><div aria-describedby="fig-sm-5-full-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="posterior-predictive-checks-1" class="level4" data-number="E.8.2.2"><h4 data-number="E.8.2.2" class="anchored" data-anchor-id="posterior-predictive-checks-1">
<span class="header-section-number">E.8.2.2</span> Posterior Predictive Checks</h4>
<p>Posterior predictive checks are a Bayesian technique used to assess model fit by comparing observed data to data simulated from the <a href="https://en.wikipedia.org/wiki/Posterior_predictive_distribution">posterior predictive distribution</a> (i.e., the distribution of potential unobserved values given the observed data). These checks help identify systematic discrepancies between the observed and simulated data, providing insight into whether the chosen model (or distributional family) is appropriate. Ideally, the model-predicted lines should closely match the observed data patterns.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">PP_CHECK</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"MSFsc (Chronotype proxy) (s)"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-fit-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-fit-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.39: Posterior predictive checks for the model. The red line represents the observed data, while the black lines represent the model-predicted data.
</figcaption><div aria-describedby="fig-sm-5-full-model-fit-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="conducting-model-diagnostics-1" class="level3" data-number="E.8.3"><h3 data-number="E.8.3" class="anchored" data-anchor-id="conducting-model-diagnostics-1">
<span class="header-section-number">E.8.3</span> Conducting Model Diagnostics</h3>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It’s important to note that objective assumption tests (e.g., Anderson–Darling test) is not advisable for larger samples, since they can be overly sensitive to minor deviations. Additionally, they might overlook visual patterns that are not captured by a single metric <span class="citation" data-cites="shatz2024 kozak2018 schucany2006">(<a href="references.html#ref-kozak2018" role="doc-biblioref">Kozak &amp; Piepho, 2018</a>; <a href="references.html#ref-schucany2006" role="doc-biblioref">Schucany &amp; Ng, 2006</a>; <a href="references.html#ref-shatz2024" role="doc-biblioref">Shatz, 2024</a>)</span>.</p>
<p>I included those tests here <strong>just for reference</strong>. However, for the reason above, all assumptions were diagnosed by <strong>visual assessment</strong>.</p>
<p>For a straightforward critique of normality tests specifically, refer to <a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90">this</a> article by <span class="citation" data-cites="greener2020">Greener (<a href="references.html#ref-greener2020" role="doc-biblioref">2020</a>)</span>.</p>
</div>
</div>
</div>
<section id="normality-1" class="level4" data-number="E.8.3.1"><h4 data-number="E.8.3.1" class="anchored" data-anchor-id="normality-1">
<span class="header-section-number">E.8.3.1</span> Normality</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 2</dt>
<dd>
<strong>Normality</strong>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the conditional distribution of <span class="math inline">\(Y_{i}\)</span> given the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is a normal distribution <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Normality of the error term distribution <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 2</strong> is satisfied, as the residuals shown a fairly normal distribution by visual inspection.</p>
<section id="visual-inspection-3" class="level5" data-number="E.8.3.1.1"><h5 data-number="E.8.3.1.1" class="anchored" data-anchor-id="visual-inspection-3">
<span class="header-section-number">E.8.3.1.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span>, name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.40: Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.
</figcaption><div aria-describedby="fig-sm-5-full-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">.resid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>    outlier.shape <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Variable"</span>, y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.41: Boxplot of model residuals with outliers highlighted in red.
</figcaption><div aria-describedby="fig-sm-5-full-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_summary</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span>, name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-normality-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.28: Summary statistics of model residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-normality-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Residuals"},{"1":"n","2":"65823"},{"1":"n_rm_na","2":"65823"},{"1":"n_na","2":"0"},{"1":"mean","2":"-75.9975903752711"},{"1":"var","2":"25122457.9455256"},{"1":"sd","2":"5012.23083521954"},{"1":"min","2":"-16558.5432120522"},{"1":"q_1","2":"-3630.08369523186"},{"1":"median","2":"-455.484861892053"},{"1":"q_3","2":"3214.49091199721"},{"1":"max","2":"18145.5314022569"},{"1":"iqr","2":"6844.57460722907"},{"1":"range","2":"34704.0746143091"},{"1":"skewness","2":"0.259577635604339"},{"1":"kurtosis","2":"2.82253722606512"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="tests-1" class="level5" data-number="E.8.3.1.2"><h5 data-number="E.8.3.1.2" class="anchored" data-anchor-id="tests-1">
<span class="header-section-number">E.8.3.1.2</span> Tests</h5>
<p>It’s important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don’t recommend using them when testing for normality <span class="citation" data-cites="dagostino1990">(<a href="references.html#ref-dagostino1990" role="doc-biblioref">D’Agostino &amp; Belanger, 1990</a>)</span>. Learn more about normality tests in <span class="citation" data-cites="thode2002">Thode (<a href="references.html#ref-thode2002" role="doc-biblioref">2002</a>)</span>.</p>
<p>I also recommend checking the original papers for each test to understand their assumptions and limitations:</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test">Anderson-Darling test</a>: <span class="citation" data-cites="anderson1952">Anderson &amp; Darling (<a href="references.html#ref-anderson1952" role="doc-biblioref">1952</a>)</span>; <span class="citation" data-cites="anderson1954">Anderson &amp; Darling (<a href="references.html#ref-anderson1954" role="doc-biblioref">1954</a>)</span>.</li>
<li>Bonett-Seier test: <span class="citation" data-cites="bonett2002">Bonett &amp; Seier (<a href="references.html#ref-bonett2002" role="doc-biblioref">2002</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion">Cramér-von Mises test</a>: <span class="citation" data-cites="cramer1928">Cramér (<a href="references.html#ref-cramer1928" role="doc-biblioref">1928</a>)</span>; <span class="citation" data-cites="anderson1962">Anderson (<a href="references.html#ref-anderson1962" role="doc-biblioref">1962</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test">D’Agostino test</a>: <span class="citation" data-cites="dagostino1971">D’Agostino (<a href="references.html#ref-dagostino1971" role="doc-biblioref">1971</a>)</span>; <span class="citation" data-cites="dagostino1973">D’Agostino &amp; Pearson (<a href="references.html#ref-dagostino1973" role="doc-biblioref">1973</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test">Jarque–Bera test</a>: <span class="citation" data-cites="jarque1980">Jarque &amp; Bera (<a href="references.html#ref-jarque1980" role="doc-biblioref">1980</a>)</span>; <span class="citation" data-cites="bera1981">Bera &amp; Jarque (<a href="references.html#ref-bera1981" role="doc-biblioref">1981</a>)</span>; <span class="citation" data-cites="jarque1987">Jarque &amp; Bera (<a href="references.html#ref-jarque1987" role="doc-biblioref">1987</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Lilliefors_test">Lilliefors (K-S) test</a>: <span class="citation" data-cites="smirnov1948">Smirnov (<a href="references.html#ref-smirnov1948" role="doc-biblioref">1948</a>)</span>; <span class="citation" data-cites="kolmogorov1933">Kolmogorov (<a href="references.html#ref-kolmogorov1933" role="doc-biblioref">1933</a>)</span>; <span class="citation" data-cites="massey1951">Massey (<a href="references.html#ref-massey1951" role="doc-biblioref">1951</a>)</span>; <span class="citation" data-cites="lilliefors1967">Lilliefors (<a href="references.html#ref-lilliefors1967" role="doc-biblioref">1967</a>)</span>; <span class="citation" data-cites="dallal1986">Dallal &amp; Wilkinson (<a href="references.html#ref-dallal1986" role="doc-biblioref">1986</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson chi-square test</a>: <span class="citation" data-cites="pearson1900">Pearson (<a href="references.html#ref-pearson1900" role="doc-biblioref">1900</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test">Shapiro-Francia test</a>: <span class="citation" data-cites="shapiro1972">Shapiro &amp; Francia (<a href="references.html#ref-shapiro1972" role="doc-biblioref">1972</a>)</span>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test">Shapiro-Wilk test</a>: <span class="citation" data-cites="shapiro1965">Shapiro &amp; Wilk (<a href="references.html#ref-shapiro1965" role="doc-biblioref">1965</a>)</span>.</li>
</ul>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The data is normally distributed} \\
\text{H}_{a}: \text{The data is not normally distributed}
\end{cases}
\]</span></p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_summary</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-normality-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.29: Summary of statistical tests conducted to assess the normality of the residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-normality-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["test"],"name":[1],"type":["chr"],"align":["left"]},{"label":["statistic_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["statistic_2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p_value"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Anderson-Darling","2":"125.620760","3":"NA","4":"3.7000e-24"},{"1":"Bonett-Seier","2":"4030.354151","3":"-7.4305","4":"1.0814e-13"},{"1":"Cramer-von Mises","2":"21.201648","3":"NA","4":"7.3700e-10"},{"1":"D'Agostino Omnibus Test","2":"NA","3":"NA","4":"NA"},{"1":"D'Agostino Skewness Test","2":"26.753061","3":"NA","4":"0.0000e+00"},{"1":"D'Agostino Kurtosis Test","2":"NA","3":"NA","4":"NA"},{"1":"Jarque–Bera","2":"825.571900","3":"2.0000","4":"0.0000e+00"},{"1":"Lilliefors (K-S)","2":"0.030683","3":"NA","4":"2.3195e-161"},{"1":"Pearson chi-square","2":"1595.170396","3":"NA","4":"2.6375e-231"},{"1":"Shapiro-Francia","2":"NA","3":"NA","4":"NA"},{"1":"Shapiro-Wilk","2":"NA","3":"NA","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="linearity-1" class="level4" data-number="E.8.3.2"><h4 data-number="E.8.3.2" class="anchored" data-anchor-id="linearity-1">
<span class="header-section-number">E.8.3.2</span> Linearity</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 3</dt>
<dd>
<strong>Linear mean</strong>. There is a vector of parameters <span class="math inline">\(\beta = (\beta_{0}, \dots, \beta_{p - 1})\)</span> such that the conditional mean of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> has the form
</dd>
</dl>
<p><span class="math display">\[
z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, n\)</span> <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.</p>
<p>(Linearity of the phenomenon measured <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<p>It is important to clarify that the linear assumption pertains to <strong>linearity in the parameters</strong> or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="citation" data-cites="cohen2002">(<a href="references.html#ref-cohen2002" role="doc-biblioref">Cohen et al., 2002</a>)</span>.</p>
</div>
</div>
</div>
<p><strong>Assumption 3</strong> is satisfied, as the relationship between the variables is fairly linear.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fl">0</span>, </span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span> </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted values"</span>, y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-residual-diag-fitted-values-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.42: Residual plot showing the relationship between fitted values and residuals. The dashed black line represent zero residuals, indicating an ideal model fit. The red line indicate the conditional mean of residuals.
</figcaption><div aria-describedby="fig-sm-5-full-model-residual-diag-fitted-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_fit_spread.html">ols_plot_resid_fit_spread</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  <span class="va">q</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">layers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">constructor</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"red"</span></span>
<span>  </span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">plots</span><span class="op">$</span><span class="va">fm_plot</span>, <span class="va">plots</span><span class="op">$</span><span class="va">rsd_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-residual-diag-linearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.43: Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. “Proportion Less” indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.
</figcaption><div aria-describedby="fig-sm-5-full-model-residual-diag-linearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>The <a href="https://en.wikipedia.org/wiki/Ramsey_RESET_test">Ramsey’s RESET test</a> indicates that the model has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</p>
<p>Learn more about the Ramsey’s RESET test in: <span class="citation" data-cites="ramsey1969">Ramsey (<a href="references.html#ref-ramsey1969" role="doc-biblioref">1969</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The model has no omitted variables} \\
\text{H}_{a}: \text{The model has omitted variables}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 147, df1 = 2, df2 = 65812, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/resettest.html">resettest</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"regressor"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  RESET test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; RESET = 30.3, df1 = 18, df2 = 65796, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="homoscedasticity-common-variance-1" class="level4" data-number="E.8.3.3"><h4 data-number="E.8.3.3" class="anchored" data-anchor-id="homoscedasticity-common-variance-1">
<span class="header-section-number">E.8.3.3</span> Homoscedasticity (Common Variance)</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 4</dt>
<dd>
<strong>Common variance</strong> (homoscedasticity). There is as parameter <span class="math inline">\(\sigma^{2}\)</span> such the conditional variance of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is <span class="math inline">\(\sigma^{2}\)</span> for <span class="math inline">\(i = 1, \dots, n\)</span>.
</dd>
</dl>
<p>(Constant variance of the error terms <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 4</strong> is satisfied. When comparing the standardized residuals (<span class="math inline">\(\sqrt{|\text{Standardized Residuals}|}\)</span>) spread to the fitted values, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</p>
<section id="visual-inspection-4" class="level5" data-number="E.8.3.3.1"><h5 data-number="E.8.3.3.1" class="anchored" data-anchor-id="visual-inspection-4">
<span class="header-section-number">E.8.3.3.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Fitted values"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{|Standardized \\ Residuals|}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-homoscedasticity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.44: Relation between the fitted values of the model and its standardized residuals.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-homoscedasticity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">MSF<sub>sc</sub> (Chronotype proxy) (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Age (years)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Longitude (decimal degrees)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Monthly average global horizontal irradiance (Wh/m²)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Annual average global horizontal irradiance (Wh/m²)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Daylight on the March equinox (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">Daylight on the June solstice (seconds)</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-8" role="tab" aria-controls="tabset-4-8" aria-selected="false">Daylight on the December solstice (seconds)</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'MSF~sc~ (Chronotype proxy) (seconds)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-msf-sc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.30: Relation between <code>msf_sc</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-msf-sc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Age (years)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.31: Relation between <code>age</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Longitude (decimal degrees)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.32: Relation between <code>longitude</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ghi_month</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Monthly average global horizontal irradiance (Wh/m²)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.33: Relation between <code>ghi_month</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">ghi_annual</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Annual average global horizontal irradiance (Wh/m²)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-ghi-annual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.34: Relation between <code>ghi_annual</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">march_equinox_daylight</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Daylight on the March equinox (seconds)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-march-equinox-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.35: Relation between <code>march_equinox_daylight</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">june_solstice_daylight</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Daylight on the June solstice (seconds)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-june-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.36: Relation between <code>june_solstice_daylight</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-140-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-4-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-8-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span></span>
<span>      <span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">december_solstice_daylight</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">'Daylight on the December solstice (seconds)'</span>,</span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">'$\\sqrt{|Standardized \\ Residuals|}$'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-homoscedasticity-december-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-homoscedasticity-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.37: Relation between <code>december_solstice_daylight</code> and the model standardized residuals.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-homoscedasticity-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section><section id="breusch-pagan-test-1" class="level5" data-number="E.8.3.3.2"><h5 data-number="E.8.3.3.2" class="anchored" data-anchor-id="breusch-pagan-test-1">
<span class="header-section-number">E.8.3.3.2</span> Breusch-Pagan Test</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test">Breusch-Pagan test</a> test indicates that the residuals exhibit constant variance.</p>
<p>Learn more about the Breusch-Pagan test in: <span class="citation" data-cites="breusch1979">Breusch &amp; Pagan (<a href="references.html#ref-breusch1979" role="doc-biblioref">1979</a>)</span> and <span class="citation" data-cites="koenker1981">Koenker (<a href="references.html#ref-koenker1981" role="doc-biblioref">1981</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{The variance is constant} \\
\text{H}_{a}: \text{The variance is not constant}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># With studentising modification of Koenker</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 1142, df = 8, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span>studentize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  fit_engine</span></span>
<span><span class="co">#&gt; BP = 1576, df = 8, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the studentized modification of Koenker.</span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"197.7","2":"1.9517e-38","3":"8","4":"Koenker (studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">skedastic</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/skedastic/man/breusch_pagan.html">breusch_pagan</a></span><span class="op">(</span>koenker <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["statistic"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["parameter"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["method"],"name":[4],"type":["chr"],"align":["left"]},{"label":["alternative"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"178.61","2":"2.0172e-34","3":"8","4":"Breusch-Pagan (non-studentised)","5":"greater"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/ncvTest.html">ncvTest</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Non-constant Variance Score Test </span></span>
<span><span class="co">#&gt; Variance formula: ~ fitted.values </span></span>
<span><span class="co">#&gt; Chisquare = 8393, Df = 1, p = &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Data                </span></span>
<span><span class="co">#&gt;  ----------------------------------</span></span>
<span><span class="co">#&gt;  Response : msf_sc </span></span>
<span><span class="co">#&gt;  Variables: fitted values of msf_sc </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    72.4950 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    1.6746e-17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="independence-1" class="level4" data-number="E.8.3.4"><h4 data-number="E.8.3.4" class="anchored" data-anchor-id="independence-1">
<span class="header-section-number">E.8.3.4</span> Independence</h4>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Assumption 5</dt>
<dd>
<strong>Independence</strong>. The random variables <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> are independent given the observed <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> <span class="citation" data-cites="degroot2012">(<a href="references.html#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Independence of the error terms <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</div>
</div>
</div>
<p><strong>Assumption 5</strong> is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic (<span class="math inline">\(1.5\)</span> to <span class="math inline">\(2.5\)</span>). It’s also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see <span class="citation" data-cites="hair2019">Hair (<a href="references.html#ref-hair2019" role="doc-biblioref">2019, p. 291</a>)</span> for more information).</p>
<p>Many authors don’t consider autocorrelation tests for linear regression models, as they are more relevant for time series data. However, I include them here just for reference.</p>
<section id="visual-inspection-5" class="level5" data-number="E.8.3.4.1"><h5 data-number="E.8.3.4.1" class="anchored" data-anchor-id="visual-inspection-5">
<span class="header-section-number">E.8.3.4.1</span> Visual Inspection</h5>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">forecast</span><span class="fu">::</span><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/tsdisplay.html">ggtsdisplay</a></span><span class="op">(</span>lag.max<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-independence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.45: Time series plot of the residuals along with its AutoCorrelation Function (ACF) and Partial AutoCorrelation Function (PACF).
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-148-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="correlations-1" class="level5" data-number="E.8.3.4.2"><h5 data-number="E.8.3.4.2" class="anchored" data-anchor-id="correlations-1">
<span class="header-section-number">E.8.3.4.2</span> Correlations</h5>
<p><span class="quarto-unresolved-ref">?tbl-model-residual-diag-independence-1</span> shows the relative importance of independent variables in determining the response variable. It highlights how much each variable uniquely contributes to the R-squared value, beyond what is explained by the other predictors.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_correlations.html">ols_correlations</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-independence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.38: Correlations between the dependent variable and the independent variables, along with the zero-order, part, and partial correlations. The zero-order correlation represents the Pearson correlation coefficient between the dependent and independent variables. Part correlations indicate how much the R-squared would decrease if a specific variable were removed from the model, while partial correlations reflect the portion of variance in the response variable that is explained by a specific independent variable, beyond the influence of other predictors in the model.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-independence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Zero-order"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Partial"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Part"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.225843","2":"-0.28404","3":"-0.28290","_rn_":"age"},{"1":"0.039388","2":"0.17448","3":"0.16922","_rn_":"sexMale"},{"1":"-0.068086","2":"-0.16980","3":"-0.16455","_rn_":"longitude"},{"1":"-0.049365","2":"-0.16754","3":"-0.16229","_rn_":"ghi_month"},{"1":"-0.054811","2":"0.16755","3":"0.16230","_rn_":"ghi_annual"},{"1":"0.070242","2":"0.16853","3":"0.16328","_rn_":"march_equinox_daylight"},{"1":"-0.061979","2":"-0.16825","3":"-0.16300","_rn_":"june_solstice_daylight"},{"1":"0.062235","2":"-0.16825","3":"-0.16300","_rn_":"december_solstice_daylight"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="newey-west-estimator-1" class="level5" data-number="E.8.3.4.3"><h5 data-number="E.8.3.4.3" class="anchored" data-anchor-id="newey-west-estimator-1">
<span class="header-section-number">E.8.3.4.3</span> Newey-West Estimator</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator">Newey-West estimator</a> is a method used to estimate the <a href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a> of the coefficients in a regression model when the residuals are autocorrelated.</p>
<p>Learn more about the Newey-West estimator in: <span class="citation" data-cites="newey1987">Newey &amp; West (<a href="references.html#ref-newey1987" role="doc-biblioref">1987</a>)</span> and <span class="citation" data-cites="newey1994">Newey &amp; West (<a href="references.html#ref-newey1994" role="doc-biblioref">1994</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">sandwich</span><span class="fu">::</span><span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/NeweyWest.html">NeweyWest</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="durbin-watson-test-1" class="level5" data-number="E.8.3.4.4"><h5 data-number="E.8.3.4.4" class="anchored" data-anchor-id="durbin-watson-test-1">
<span class="header-section-number">E.8.3.4.4</span> Durbin-Watson Test</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic">Durbin-Watson test</a> is a statistical test used to detect the presence of autocorrelation at lag <span class="math inline">\(1\)</span> in the residuals from a regression analysis. The test statistic ranges from <span class="math inline">\(0\)</span> to <span class="math inline">\(4\)</span>, with a value of <span class="math inline">\(2\)</span> indicating no autocorrelation. Values less than <span class="math inline">\(2\)</span> indicate positive autocorrelation, while values greater than <span class="math inline">\(2\)</span> indicate negative autocorrelation <span class="citation" data-cites="fox2016">(<a href="references.html#ref-fox2016" role="doc-biblioref">Fox, 2016</a>)</span>.</p>
<p>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between <span class="math inline">\(1.5\)</span> and <span class="math inline">\(2.5\)</span> suggests little to no autocorrelation.</p>
<p>Learn more about the Durbin-Watson test in: <span class="citation" data-cites="durbin1950">Durbin &amp; Watson (<a href="references.html#ref-durbin1950" role="doc-biblioref">1950</a>)</span>; <span class="citation" data-cites="durbin1951">Durbin &amp; Watson (<a href="references.html#ref-durbin1951" role="doc-biblioref">1951</a>)</span>; and <span class="citation" data-cites="durbin1971">Durbin &amp; Watson (<a href="references.html#ref-durbin1971" role="doc-biblioref">1971</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} \\
\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/durbinWatsonTest.html">durbinWatsonTest</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="co">#&gt;  lag Autocorrelation D-W Statistic p-value</span></span>
<span><span class="co">#&gt;    1        0.036365        1.9272       0</span></span>
<span><span class="co">#&gt;  Alternative hypothesis: rho != 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="ljung-box-test-1" class="level5" data-number="E.8.3.4.5"><h5 data-number="E.8.3.4.5" class="anchored" data-anchor-id="ljung-box-test-1">
<span class="header-section-number">E.8.3.4.5</span> Ljung-Box Test</h5>
<p>The Ljung–Box test is a statistical test used to determine whether any autocorrelations within a time series are significantly different from zero. Rather than testing randomness at individual lags, it assesses the “overall” randomness across multiple lags.</p>
<p>Learn more about the <a href="https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test">Ljung-Box test</a> in: <span class="citation" data-cites="box1970">Box &amp; Pierce (<a href="references.html#ref-box1970" role="doc-biblioref">1970</a>)</span> and <span class="citation" data-cites="ljung1978">Ljung &amp; Box (<a href="references.html#ref-ljung1978" role="doc-biblioref">1978</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Residuals are independently distributed} \\
\text{H}_{a}: \text{Residuals are not independently distributed}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Ljung-Box"</span>, lag <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Box-Ljung test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::residuals(fit_engine)</span></span>
<span><span class="co">#&gt; X-squared = 1078, df = 10, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="colinearitymulticollinearity-1" class="level4" data-number="E.8.3.5"><h4 data-number="E.8.3.5" class="anchored" data-anchor-id="colinearitymulticollinearity-1">
<span class="header-section-number">E.8.3.5</span> Colinearity/Multicollinearity</h4>
<p>Daylight duration for the March equinox, June solstice, and December solstice exhibited high multicollinearity, with a variance inflation factor (VIF) greater than <span class="math inline">\(1000\)</span>. However, since these variables are grouped as latitude proxies, this does not significantly impact the analysis. The primary focus is on the combined effect of the group, rather than the individual contributions of each variable.</p>
<section id="variance-inflation-factor-vif-1" class="level5" data-number="E.8.3.5.1"><h5 data-number="E.8.3.5.1" class="anchored" data-anchor-id="variance-inflation-factor-vif-1">
<span class="header-section-number">E.8.3.5.1</span> Variance Inflation Factor (VIF)</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Variance_inflation_factor">Variance Inflation Factor (VIF)</a> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value (<span class="math inline">\(\text{VIF}_{i} = 1/\text{TO}L\)</span>). High VIF values (larger than ~5 <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 265</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span>panel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">VIF</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.46: Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.
</figcaption><div aria-describedby="fig-model-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-153-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_vif_tol</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-colinearity-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.39: Variance Inflation Factors (VIF) and tolerance values for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-colinearity-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Variables"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Tolerance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"age","2":"0.98842233885","3":"1.0117"},{"1":"sexMale","2":"0.99825741227","3":"1.0017"},{"1":"longitude","2":"0.16219483403","3":"6.1654"},{"1":"ghi_month","2":"0.03948627933","3":"25.3253"},{"1":"ghi_annual","2":"0.02808710089","3":"35.6035"},{"1":"march_equinox_daylight","2":"0.00085403681","3":"1170.9097"},{"1":"june_solstice_daylight","2":"0.00000036417","3":"2745940.8905"},{"1":"december_solstice_daylight","2":"0.00000035019","3":"2855592.7652"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine_2</span> <span class="op">|&gt;</span> <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_collinearity.html">check_collinearity</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-colinearity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.40: Variance Inflation Factors (VIF) and tolerance values for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["VIF"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["VIF_CI_high"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SE_factor"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Tolerance"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Tolerance_CI_high"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"age","2":"1.0060","3":"1.0016","4":"1.0218","5":"1.0030","6":"0.99405288790","7":"0.97868741935","8":"0.99835907775"},{"1":"sex","2":"1.0005","3":"1.0000","4":"4915.8527","5":"1.0002","6":"0.99952700597","7":"0.00020342351","8":"0.99999999995"},{"1":"longitude","2":"4.6358","3":"4.5732","4":"4.6996","5":"2.1531","6":"0.21571061690","7":"0.21278532540","8":"0.21866495343"},{"1":"ghi_month","2":"28.9834","3":"28.5516","4":"29.4219","5":"5.3836","6":"0.03450250945","7":"0.03398826959","8":"0.03502424763"},{"1":"ghi_annual","2":"40.6411","3":"40.0326","4":"41.2590","5":"6.3750","6":"0.02460565868","7":"0.02423712129","8":"0.02497965641"},{"1":"march_equinox_daylight","2":"1352.3350","3":"1331.8412","4":"1373.1444","5":"36.7741","6":"0.00073946176","7":"0.00072825553","8":"0.00075084029"},{"1":"june_solstice_daylight","2":"3954293.4312","3":"3894346.1816","4":"4015163.4729","5":"1988.5405","6":"0.00000025289","7":"0.00000024906","8":"0.00000025678"},{"1":"december_solstice_daylight","2":"4093437.2567","3":"4031380.5814","4":"4156449.1976","5":"2023.2245","6":"0.00000024429","7":"0.00000024059","8":"0.00000024805"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="condition-index-1" class="level5" data-number="E.8.3.5.2"><h5 data-number="E.8.3.5.2" class="anchored" data-anchor-id="condition-index-1">
<span class="header-section-number">E.8.3.5.2</span> Condition Index</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Condition_number">condition index</a> is a measure of multicollinearity in a regression model. It is based on the <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvalues</a> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="citation" data-cites="belsley2004">(<a href="references.html#ref-belsley2004" role="doc-biblioref">Belsley et al., 2004, pp. 112–114</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_eigen_cindex</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-residual-diag-colinearity-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.41: Condition indexes and eigenvalues for each predictor variable.
</figcaption><div aria-describedby="tbl-sm-5-full-model-residual-diag-colinearity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Eigenvalue"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Condition Index"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intercept"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["sexMale"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["longitude"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["ghi_month"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["ghi_annual"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["march_equinox_daylight"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["june_solstice_daylight"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["december_solstice_daylight"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"8.27236463853201","2":"1.0000","3":"0.0000000000039383","4":"0.001037256","5":"0.0038390958","6":"0.000018111","7":"0.0000064284","8":"0.0000030157","9":"0.00000000000054598","10":"0.0000000000066363","11":"0.0000000000043916"},{"1":"0.63422743269517","2":"3.6115","3":"0.0000000000026098","4":"0.000620606","5":"0.9955433370","6":"0.000012434","7":"0.0000042343","8":"0.0000019735","9":"0.00000000000036184","10":"0.0000000000043223","11":"0.0000000000029518"},{"1":"0.06961237335220","2":"10.9011","3":"0.0000000000477083","4":"0.951594620","5":"0.0001103257","6":"0.000153152","7":"0.0002345094","8":"0.0000928392","9":"0.00000000000659910","10":"0.0000000001147441","11":"0.0000000000373927"},{"1":"0.01932538625241","2":"20.6895","3":"0.0000000002364192","4":"0.030701283","5":"0.0000979151","6":"0.023118308","7":"0.0071273971","8":"0.0021048448","9":"0.00000000003341896","10":"0.0000000001469719","11":"0.0000000014396728"},{"1":"0.00359235580126","2":"47.9872","3":"0.0000000068900590","4":"0.011880556","5":"0.0001082790","6":"0.161708988","7":"0.0181020324","8":"0.0010475426","9":"0.00000000095420981","10":"0.0000000152764052","11":"0.0000000059113802"},{"1":"0.00069783652239","2":"108.8775","3":"0.0000000003581951","4":"0.001630656","5":"0.0002190282","6":"0.084133581","7":"0.0409104517","8":"0.0003100152","9":"0.00000000006165399","10":"0.0000003183667396","11":"0.0000001733397016"},{"1":"0.00017997189372","2":"214.3939","3":"0.0000000048161665","4":"0.000036021","5":"0.0000074378","6":"0.006013273","7":"0.7900155300","8":"0.7285433413","9":"0.00000000069971349","10":"0.0000001042013172","11":"0.0000000058316530"},{"1":"0.00000000492274","2":"40993.1457","3":"0.0357303492626030","4":"0.000995245","5":"0.0000730587","6":"0.018595089","7":"0.1299083498","8":"0.1808022104","9":"0.00000578111288528","10":"0.0131751183129473","11":"0.0127955453754058"},{"1":"0.00000000002811","2":"542482.3627","3":"0.9642696383823008","4":"0.001503758","5":"0.0000015227","6":"0.706247065","7":"0.0136910669","8":"0.0870942173","9":"0.99999421713061165","10":"0.9868244435699161","11":"0.9872042680574504"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="measures-of-influence-1" class="level4" data-number="E.8.3.6"><h4 data-number="E.8.3.6" class="anchored" data-anchor-id="measures-of-influence-1">
<span class="header-section-number">E.8.3.6</span> Measures of Influence</h4>
<p>In this section, I check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Leverage points</dt>
<dd>
Leverage is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence the model estimates <span class="citation" data-cites="struck2024 hair2019 nahhas2024">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 262</a>; <a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>; <a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
</dl>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<dl>
<dt>Influence points</dt>
<dd>
Influence is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="citation" data-cites="struck2024 nahhas2024">(<a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>; <a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.
</dd>
</dl>
</div>
</div>
</div>
<section id="standardized-residuals-1" class="level5" data-number="E.8.3.6.1"><h5 data-number="E.8.3.6.1" class="anchored" data-anchor-id="standardized-residuals-1">
<span class="header-section-number">E.8.3.6.1</span> Standardized Residuals</h5>
<p>Standardized residuals are a rescaling of the residual to a common basis by dividing each residual by the standard deviation of the residuals <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 264</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         1         2         3         4         5         6 </span></span>
<span><span class="co">#&gt;  1.157130  1.939795 -0.046571  0.168478  0.740576  0.265454</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">std</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">std</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Standardized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.47: Standardized residuals for each observation.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-158-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="studentized-residuals-1" class="level5" data-number="E.8.3.6.2"><h5 data-number="E.8.3.6.2" class="anchored" data-anchor-id="studentized-residuals-1">
<span class="header-section-number">E.8.3.6.2</span> Studentized Residuals</h5>
<p><a href="https://en.wikipedia.org/wiki/Studentized_residual">Studentized residuals</a> are a commonly used variant of the standardized residual. It differs from other methods in how it calculates the standard deviation used in standardization. To minimize the effect of any observation on the standardization process, the standard deviation of the residual for observation <span class="math inline">\(i\)</span> is computed from regression estimates omitting the <span class="math inline">\(i\)</span>th observation in the calculation of the regression estimates <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 264</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         1         2         3         4         5         6 </span></span>
<span><span class="co">#&gt;  1.157133  1.939836 -0.046571  0.168477  0.740574  0.265452</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">std</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">std</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.48: Studentized residuals for each observation.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-161-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    std <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">std</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Predicted value"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.49: Relation between studentized residuals and fitted values.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-162-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">2</span>, print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residual"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.50: Relation between studentized residuals and their leverage points.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-163-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="hat-values-1" class="level5" data-number="E.8.3.6.3"><h5 data-number="E.8.3.6.3" class="anchored" data-anchor-id="hat-values-1">
<span class="header-section-number">E.8.3.6.3</span> Hat Values</h5>
<p>The hat value indicates how distinct an observation’s predictor values are from those of other observations. Observations with high hat values have high leverage and may be, though not necessarily, influential. There is no fixed threshold for what constitutes a “large” hat value; instead, the focus must be on observations with hat values significantly higher than the rest <span class="citation" data-cites="nahhas2024 hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>; <a href="references.html#ref-nahhas2024" role="doc-biblioref">Nahhas, 2024</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; 0.000138980 0.000072244 0.000024614 0.000336677 0.000270506 0.000161557</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  hat <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">hatvalues</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">hat</span>, ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">hat</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Observation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Hat value"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.51: Hat values for each observation.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-168-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="cooks-distance-1" class="level5" data-number="E.8.3.6.4"><h5 data-number="E.8.3.6.4" class="anchored" data-anchor-id="cooks-distance-1">
<span class="header-section-number">E.8.3.6.4</span> Cook’s Distance</h5>
<p>The <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s D</a> measures each observation’s influence on the model’s fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>A common practice is to flag observations with a Cook’s distance of 1.0 or greater. However, a threshold of <span class="math inline">\(4 / (n - k - 1)\)</span>, where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(k\)</span> is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019</a>)</span>.</p>
<p>Learn more about Cook’s D in: <span class="citation" data-cites="cook1977">Cook (<a href="references.html#ref-cook1977" role="doc-biblioref">1977</a>)</span>; <span class="citation" data-cites="cook1979">Cook (<a href="references.html#ref-cook1979" role="doc-biblioref">1979</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;               1               2               3               4 </span></span>
<span><span class="co">#&gt; 0.0000206792949 0.0000302066720 0.0000000059316 0.0000010621891 </span></span>
<span><span class="co">#&gt;               5               6 </span></span>
<span><span class="co">#&gt; 0.0000164888688 0.0000012651172</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fl">2</span>, print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">q</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span></span>
<span><span class="va">q</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.52: Cook’s distance for each observation along with a threshold line at <span class="math inline">\(4 / (n - k - 1)\)</span>.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-171-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diag_sum_plots</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span></span>
<span>    panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rutils</span><span class="fu">::</span><span class="fu"><a href="https://danielvartan.github.io/rutils/reference/shush.html">shush</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">diag_sum_plots</span><span class="op">$</span><span class="va">OUTLIERS</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Leverage"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Studentized residuals"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"gray25"</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_build.html">ggplot_build</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"blue"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"#1b6ca8"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span> <span class="op">==</span> <span class="st">"darkgray"</span> <span class="op">~</span> <span class="st">"black"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">plot</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">colour</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot_gtable.html">ggplot_gtable</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">ggplotify</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggplotify/man/as.ggplot.html">as.ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.53: Relation between studentized residuals and their leverage points. The blue line represents the <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cook’s distance</a>. Any points outside the contour lines are influential observations.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-172-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="influence-on-prediction-dffits-1" class="level5" data-number="E.8.3.6.5"><h5 data-number="E.8.3.6.5" class="anchored" data-anchor-id="influence-on-prediction-dffits-1">
<span class="header-section-number">E.8.3.6.5</span> Influence on Prediction (DFFITS)</h5>
<p><a href="https://en.wikipedia.org/wiki/DFFITS">DFFITS</a> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.</p>
<p>The best rule of thumb is to classify as influential any standardized values that exceed <span class="math inline">\(2 \sqrt{(p / n)}\)</span>, where <span class="math inline">\(p\)</span> is the number of independent variables + 1 and <span class="math inline">\(n\)</span> is the sample size <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>)</span>.</p>
<p>Learn more about DDFITS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="references.html#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="references.html#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt;  0.01364238  0.01648853 -0.00023105  0.00309185  0.01218190  0.00337430</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dffits.html">ols_plot_dffits</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.54: Standardized DFFITS (difference in fits) for each observation.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-176-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section><section id="influence-on-parameter-estimates-dfbetas-1" class="level5" data-number="E.8.3.6.6"><h5 data-number="E.8.3.6.6" class="anchored" data-anchor-id="influence-on-parameter-estimates-dfbetas-1">
<span class="header-section-number">E.8.3.6.6</span> Influence on Parameter Estimates (DFBETAS)</h5>
<p><a href="https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence">DFBETAS</a> are a measure of the change in a regression coefficient when an observation is omitted from the regression analysis. <strong>The value of the DFBETA is in terms of the coefficient itself</strong> <span class="citation" data-cites="hair2019">(<a href="references.html#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 261</a>)</span>. A cutoff for what is considered a large DFBETAS value is <span class="math inline">\(2 / \sqrt{n}\)</span>, where <span class="math inline">\(n\)</span> is the number of observations. <span class="citation" data-cites="struck2024">(<a href="references.html#ref-struck2024" role="doc-biblioref">Struck, 2024</a>)</span>.</p>
<p>Learn more about DFBETAS in: <span class="citation" data-cites="welsch1977">Welsch &amp; Kuh (<a href="references.html#ref-welsch1977" role="doc-biblioref">1977</a>)</span> and <span class="citation" data-cites="belsley2004">Belsley et al. (<a href="references.html#ref-belsley2004" role="doc-biblioref">2004</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbeta</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept)         age   sexMale   longitude    ghi_month   ghi_annual</span></span>
<span><span class="co">#&gt; 1    5272.817 -0.01032975 0.1666267  0.00908022  0.000619594 -0.000835073</span></span>
<span><span class="co">#&gt; 2    8197.574 -0.00831645 0.2493352  0.04912629  0.000456312 -0.001639406</span></span>
<span><span class="co">#&gt; 3     -36.158  0.00018499 0.0039827 -0.00021996 -0.000014877  0.000028971</span></span>
<span><span class="co">#&gt; 4    1064.618 -0.00258514 0.0380752  0.01657280  0.000019275 -0.000088010</span></span>
<span><span class="co">#&gt; 5   -1481.541 -0.00744737 0.1173640  0.01215231 -0.000082787  0.000397341</span></span>
<span><span class="co">#&gt; 6    1032.327 -0.00146816 0.0422426  0.00381652  0.000187072 -0.000233942</span></span>
<span><span class="co">#&gt;   march_equinox_daylight june_solstice_daylight december_solstice_daylight</span></span>
<span><span class="co">#&gt; 1              -0.350541             0.11504341                 0.11427259</span></span>
<span><span class="co">#&gt; 2              -0.500785             0.15678061                 0.15573063</span></span>
<span><span class="co">#&gt; 3               0.001255            -0.00021287                -0.00021398</span></span>
<span><span class="co">#&gt; 4              -0.073695             0.02470963                 0.02452618</span></span>
<span><span class="co">#&gt; 5              -0.019068             0.02669212                 0.02628100</span></span>
<span><span class="co">#&gt; 6              -0.077533             0.02699459                 0.02679533</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Intercept</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">age</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">sexMale</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">longitude</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">ghi_month</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">ghi_annual</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">march_equinox_daylight</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-8" role="tab" aria-controls="tabset-5-8" aria-selected="false">june_solstice_daylight</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-9" role="tab" aria-controls="tabset-5-9" aria-selected="false">december_solstice_daylight</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Intercept coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-intercept" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-intercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.42: Standardized DFBETAS values for each observation concerning the <code>Intercept</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-intercept-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'age coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.43: Standardized DFBETAS values for each observation concerning the <code>age</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-181-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'sexMale coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-sexmale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-sexmale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.44: Standardized DFBETAS values for each observation concerning the <code>sexMale</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-sexmale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-182-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'longitude coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-longitude" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.45: Standardized DFBETAS values for each observation concerning the <code>longitude</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-longitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-183-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'ghi_month coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-ghi-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.46: Standardized DFBETAS values for each observation concerning the <code>ghi_month</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-ghi-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-184-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'ghi_annual coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-ghi-annual" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.47: Standardized DFBETAS values for each observation concerning the <code>ghi_annual</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-ghi-annual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-185-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'march_equinox_daylight coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-march-equinox-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.48: Standardized DFBETAS values for each observation concerning the <code>march_equinox_daylight</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-march-equinox-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-186-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-8-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'june_solstice_daylight coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-june-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.49: Standardized DFBETAS values for each observation concerning the <code>june_solstice_daylight</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-june-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-187-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tabset-5-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-9-tab">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plots</span><span class="op">$</span><span class="va">plots</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'december_solstice_daylight coefficient'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-full-model-diag-influence-december-solstice-daylight" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-full-model-diag-influence-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.50: Standardized DFBETAS values for each observation concerning the <code>december_solstice_daylight</code> coefficient.
</figcaption><div aria-describedby="tbl-sm-5-full-model-diag-influence-december-solstice-daylight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-188-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section><section id="hadis-measure-1" class="level5" data-number="E.8.3.6.7"><h5 data-number="E.8.3.6.7" class="anchored" data-anchor-id="hadis-measure-1">
<span class="header-section-number">E.8.3.6.7</span> Hadi’s Measure</h5>
<p>Hadi’s measure of influence is based on the idea that influential observations can occur in either the response variable, the predictors, or both.</p>
<p>Learn more about Hadi’s measure in: <span class="citation" data-cites="chatterjee2012">Chatterjee &amp; Hadi (<a href="references.html#ref-chatterjee2012" role="doc-biblioref">2012</a>)</span>.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_hadi.html">ols_plot_hadi</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Hadi's measure"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.55: Hadi’s influence measure for each observation.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-189-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_pot.html">ols_plot_resid_pot</a></span><span class="op">(</span>print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-sm-5-full-model-diag-influence-13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-sm-5-full-model-diag-influence-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;E.56: Potential-residual plot classifying unusual observations as high-leverage points, outliers, or a combination of both.
</figcaption><div aria-describedby="fig-sm-5-full-model-diag-influence-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="supplementary-material-5_files/figure-html/unnamed-chunk-190-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section></section></section><section id="hypothesis-testing" class="level2" data-number="E.9"><h2 data-number="E.9" class="anchored" data-anchor-id="hypothesis-testing">
<span class="header-section-number">E.9</span> Hypothesis Testing</h2>
<p>Following the criteria outlined in the methodology supplementary material, we now address the hypothesis for this test:</p>
<dl>
<dt><strong>Hypothesis</strong></dt>
<dd>
<em>Latitude is associated with chronotype distributions</em>, with populations closer to the equator exhibiting, on average, a shorter or more morning-oriented circadian phenotype compared to those residing near the poles.
</dd>
</dl>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \Delta \ \text{Adjusted} \ \text{R}^{2} \leq \text{MES} \quad \text{or} \quad \text{F-test is not significant} \ (\alpha \geq 0.05) \\
\text{H}_{a}: \Delta \ \text{Adjusted} \ \text{R}^{2} &gt; \text{MES} \quad \text{and} \quad \text{F-test is significant} \ (\alpha &lt; 0.05)
\end{cases}
\]</span></p>
<section id="f-test" class="level3" data-number="E.9.1"><h3 data-number="E.9.1" class="anchored" data-anchor-id="f-test">
<span class="header-section-number">E.9.1</span> F-test</h3>
<p>The results indicate that the F-test is significant (<span class="math inline">\(\alpha &lt; 0.05\)</span>), meaning that the model including the latitude variables differs from the model without them.</p>
<p><span class="math display">\[
\text{F} = \cfrac{\text{R}^{2}_{f} - \text{R}^{2}_{r} / (k_{f} - k_{R})}{(1 - \text{R}^{2}_{f}) / (\text{N} - k_{f} - 1)}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit_engine_restricted</span>, <span class="va">fit_engine_full</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis of Variance Table</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model 1: msf_sc ~ age + sex + longitude + ghi_month</span></span>
<span><span class="co">#&gt; Model 2: msf_sc ~ age + sex + longitude + ghi_month + ghi_annual + march_equinox_daylight + </span></span>
<span><span class="co">#&gt;     june_solstice_daylight + december_solstice_daylight</span></span>
<span><span class="co">#&gt;   Res.Df           RSS Df  Sum of Sq    F Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; 1  65818 1355087927709                              </span></span>
<span><span class="co">#&gt; 2  65814 1350842514863  4 4245412847 51.7 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils-stats.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">k_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">fit_engine_restricted</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">k_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">fit_engine_full</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="op">(</span><span class="op">(</span><span class="fu">r_squared</span><span class="op">(</span><span class="va">fit_engine_full</span><span class="op">)</span> <span class="op">-</span> <span class="fu">r_squared</span><span class="op">(</span><span class="va">fit_engine_restricted</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> </span>
<span>    <span class="op">(</span><span class="va">k_full</span> <span class="op">-</span> <span class="va">k_res</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">r_squared</span><span class="op">(</span><span class="va">fit_engine_full</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span>  <span class="op">-</span> <span class="va">k_full</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 51.71</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="effect-size" class="level3" data-number="E.9.2"><h3 data-number="E.9.2" class="anchored" data-anchor-id="effect-size">
<span class="header-section-number">E.9.2</span> Effect Size</h3>
<p>The results show that the <span class="math inline">\(\Delta \ \text{Adjusted} \ \text{R}^{2}\)</span> value is below the Minimal Effect Size (MES) threshold (<span class="math inline">\(\text{R}^{2} \approx 0.01960784\)</span>), indicating that adding latitude does not meaningfully improve the model’s fit.</p>
<p><span class="math display">\[
\text{Cohen's } f^2 = \cfrac{\text{R}^{2}_{f} - \text{R}^{2}_{r}}{1 - \text{R}^{2}_{f}} = \cfrac{\Delta \text{R}^{2}}{1 - \text{R}^{2}_{f}}
\]</span></p>
<p><span class="math display">\[
\text{MES} = \text{Cohen's } f^2 \text{small threshold} = 0.02 \\
\]</span></p>
<p><span class="math display">\[
0.02 = \cfrac{\text{R}^{2}}{1 - \text{R}^{2}} \quad \text{or} \quad \text{R}^{2} = \cfrac{0.02}{1.02} \eqsim 0.01960784
\]</span></p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adj_r_squared_restricted</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">psychometric</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psychometric/man/CI.Rsq.html">CI.Rsq</a></span><span class="op">(</span></span>
<span>    rsq <span class="op">=</span> <span class="fu">adj_r_squared</span><span class="op">(</span><span class="va">fit_engine_restricted</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_engine_restricted</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    level <span class="op">=</span> <span class="fl">0.95</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">adj_r_squared_restricted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-hypothesis-test-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-hypothesis-test-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.51: Confidence interval for the adjusted R-squared of the <strong>restricted model</strong>. LCL correspond to the lower limit, and UCL to the upper limit.
</figcaption><div aria-describedby="tbl-sm-5-hypothesis-test-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Rsq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SErsq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LCL"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["UCL"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.08511","2":"0.0020804","3":"0.081032","4":"0.089187"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adj_r_squared_full</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">psychometric</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psychometric/man/CI.Rsq.html">CI.Rsq</a></span><span class="op">(</span></span>
<span>    rsq <span class="op">=</span> <span class="fu">adj_r_squared</span><span class="op">(</span><span class="va">fit_engine_full</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_engine_full</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    level <span class="op">=</span> <span class="fl">0.95</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">adj_r_squared_full</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-hypothesis-test-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-hypothesis-test-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.52: Confidence interval for the adjusted R-squared of the <strong>full model</strong>. LCL correspond to the lower limit, and UCL to the upper limit.
</figcaption><div aria-describedby="tbl-sm-5-hypothesis-test-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Rsq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SErsq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LCL"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["UCL"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.087921","2":"0.0021079","3":"0.083789","4":"0.092052"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"adj_r_squared_res_lcl"</span>, </span>
<span>    <span class="st">"adj_r_squared_full_ucl"</span>, </span>
<span>    <span class="st">"diff"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="va">adj_r_squared_restricted</span><span class="op">$</span><span class="va">LCL</span>, </span>
<span>    <span class="va">adj_r_squared_full</span><span class="op">$</span><span class="va">UCL</span>, </span>
<span>    <span class="va">adj_r_squared_full</span><span class="op">$</span><span class="va">UCL</span> <span class="op">-</span> <span class="va">adj_r_squared_restricted</span><span class="op">$</span><span class="va">LCL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-hypothesis-test-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-hypothesis-test-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.53: Comparison between the coefficients of determination (<span class="math inline">\(\text{R}^2\)</span>) of the restricted and full models.
</figcaption><div aria-describedby="tbl-sm-5-hypothesis-test-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"adj_r_squared_res_lcl","2":"0.081032"},{"1":"adj_r_squared_full_ucl","2":"0.092052"},{"1":"diff","2":"0.011020"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cohens_f_squared_summary</span><span class="op">(</span></span>
<span>  <span class="va">adj_r_squared_restricted</span><span class="op">$</span><span class="va">LCL</span>, </span>
<span>  <span class="va">adj_r_squared_full</span><span class="op">$</span><span class="va">UCL</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-sm-5-hypothesis-test-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sm-5-hypothesis-test-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;E.54: Effect size between the restricted and full models based on Cohen’s <span class="math inline">\(f^2\)</span>.
</figcaption><div aria-describedby="tbl-sm-5-hypothesis-test-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"f_squared","2":"0.0121371208049842"},{"1":"effect_size","2":"Negligible"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
</section></section><section id="conclusion" class="level2" data-number="E.10"><h2 data-number="E.10" class="anchored" data-anchor-id="conclusion">
<span class="header-section-number">E.10</span> Conclusion</h2>
<p>Based on the hypothesis test results, <strong>we must reject the alternative hypothesis in favor of the null hypothesis</strong>.</p>
<p>With reference to the criteria outlined in the methodology supplementary material, we can now address the following question:</p>
<div style="text-align: center; font-size: 1.1em; font-weight: bold; color: #ea7701; padding-top: 1em; padding-bottom: 1em;">
<p>Is latitude associated with chronotype?</p>
</div>
<p>The answer is <strong>No</strong>. Latitude does not significantly contribute to explaining the variance in chronotype, and therefore, it cannot be considered associated with the circadian phenotype.</p>
</section><section id="final-remarks" class="level2" data-number="E.11"><h2 data-number="E.11" class="anchored" data-anchor-id="final-remarks">
<span class="header-section-number">E.11</span> Final Remarks</h2>
<p>For any questions regarding these computations, please contact the author at <a href="mailto:danvartan@mail.com" class="email">danvartan@mail.com</a>.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-allaire" class="csl-entry" role="listitem">
Allaire, J. J., Teague, C., Xie, Y., &amp; Dervieux, C. (n.d.). <em>Quarto</em> [Computer software]. Zenodo. <a href="https://doi.org/10.5281/ZENODO.5960048">https://doi.org/10.5281/ZENODO.5960048</a>
</div>
<div id="ref-anderson1962" class="csl-entry" role="listitem">
Anderson, T. W. (1962). On the distribution of the two-sample <span class="nocase">Cramer-von Mises</span> criterion. <em>The Annals of Mathematical Statistics</em>, <em>33</em>(3), 1148–1159. <a href="https://doi.org/10.1214/aoms/1177704477">https://doi.org/10.1214/aoms/1177704477</a>
</div>
<div id="ref-anderson1952" class="csl-entry" role="listitem">
Anderson, T. W., &amp; Darling, D. A. (1952). Asymptotic theory of certain "goodness of fit" criteria based on stochastic processes. <em>The Annals of Mathematical Statistics</em>, <em>23</em>(2), 193–212. <a href="https://www.jstor.org/stable/2236446">https://www.jstor.org/stable/2236446</a>
</div>
<div id="ref-anderson1954" class="csl-entry" role="listitem">
Anderson, T. W., &amp; Darling, D. A. (1954). A test of goodness of fit. <em>Journal of the American Statistical Association</em>, <em>49</em>(268), 765–769. <a href="https://doi.org/10.1080/01621459.1954.10501232">https://doi.org/10.1080/01621459.1954.10501232</a>
</div>
<div id="ref-belsley2004" class="csl-entry" role="listitem">
Belsley, D. A., Kuh, E., &amp; Welsch, R. E. (2004). <em>Regression diagnostics: Identifying influential data and sources of collinearity</em>. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/0471725153">https://doi.org/10.1002/0471725153</a>
</div>
<div id="ref-bera1981" class="csl-entry" role="listitem">
Bera, A. K., &amp; Jarque, C. M. (1981). Efficient tests for normality, homoscedasticity and serial independence of regression residuals: <span>Monte Carlo Evidence</span>. <em>Economics Letters</em>, <em>7</em>(4), 313–318. <a href="https://doi.org/10.1016/0165-1765(81)90035-5">https://doi.org/10.1016/0165-1765(81)90035-5</a>
</div>
<div id="ref-bonett2002" class="csl-entry" role="listitem">
Bonett, D. G., &amp; Seier, E. (2002). A test of normality with high uniform power. <em>Computational Statistics &amp; Data Analysis</em>, <em>40</em>(3), 435–445. <a href="https://doi.org/10.1016/S0167-9473(02)00074-9">https://doi.org/10.1016/S0167-9473(02)00074-9</a>
</div>
<div id="ref-box1970" class="csl-entry" role="listitem">
Box, G. E. P., &amp; Pierce, D. A. (1970). Distribution of residual autocorrelations in autoregressive-integrated moving average time series models. <em>Journal of the American Statistical Association</em>, <em>65</em>(332), 1509–1526. <a href="https://doi.org/10.1080/01621459.1970.10481180">https://doi.org/10.1080/01621459.1970.10481180</a>
</div>
<div id="ref-breusch1979" class="csl-entry" role="listitem">
Breusch, T. S., &amp; Pagan, A. R. (1979). A simple test for heteroscedasticity and random coefficient variation. <em>Econometrica</em>, <em>47</em>(5), 1287–1294. <a href="https://doi.org/10.2307/1911963">https://doi.org/10.2307/1911963</a>
</div>
<div id="ref-chatterjee2012" class="csl-entry" role="listitem">
Chatterjee, S., &amp; Hadi, A. S. (2012). <em>Regression analysis by example</em> (5th ed.). Wiley.
</div>
<div id="ref-cohen2002" class="csl-entry" role="listitem">
Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S. (2002). <em>Applied multiple regression/correlation analysis for the behavioral sciences</em> (3rd ed.). Lawrence Erlbaum Associates.
</div>
<div id="ref-cook1977" class="csl-entry" role="listitem">
Cook, R. D. (1977). Detection of influential observation in linear regression. <em>Technometrics</em>, <em>19</em>(1), 15–18. <a href="https://doi.org/10.1080/00401706.1977.10489493">https://doi.org/10.1080/00401706.1977.10489493</a>
</div>
<div id="ref-cook1979" class="csl-entry" role="listitem">
Cook, R. D. (1979). Influential observations in linear regression. <em>Journal of the American Statistical Association</em>, <em>74</em>(365), 169–174. <a href="https://doi.org/10.1080/01621459.1979.10481634">https://doi.org/10.1080/01621459.1979.10481634</a>
</div>
<div id="ref-cramer1928" class="csl-entry" role="listitem">
Cramér, H. (1928). On the composition of elementary errors: <span>First</span> paper: <span>Mathematical</span> deductions. <em>Scandinavian Actuarial Journal</em>, <em>1928</em>(1), 13–74. <a href="https://doi.org/10.1080/03461238.1928.10416862">https://doi.org/10.1080/03461238.1928.10416862</a>
</div>
<div id="ref-dagostino1971" class="csl-entry" role="listitem">
D’Agostino, R. B. (1971). An omnibus test of normality for moderate and large size samples. <em>Biometrika</em>, <em>58</em>(2), 341–348. <a href="https://doi.org/10.1093/biomet/58.2.341">https://doi.org/10.1093/biomet/58.2.341</a>
</div>
<div id="ref-dagostino1990" class="csl-entry" role="listitem">
D’Agostino, R. B., &amp; Belanger, A. (1990). A suggestion for using powerful and informative tests of normality. <em>The American Statistician</em>, <em>44</em>(4), 316–321. <a href="https://doi.org/10.2307/2684359">https://doi.org/10.2307/2684359</a>
</div>
<div id="ref-dagostino1973" class="csl-entry" role="listitem">
D’Agostino, R. B., &amp; Pearson, E. S. (1973). Tests for departure from normality. <span>Empirical</span> results for the distributions of b2 and √b1. <em>Biometrika</em>, <em>60</em>(3), 613–622. <a href="https://doi.org/10.1093/biomet/60.3.613">https://doi.org/10.1093/biomet/60.3.613</a>
</div>
<div id="ref-dallal1986" class="csl-entry" role="listitem">
Dallal, G. E., &amp; Wilkinson, L. (1986). An analytic approximation to the distribution of <span>Lilliefors</span>’s test statistic for normality. <em>The American Statistician</em>, <em>40</em>(4), 294–296. <a href="https://doi.org/10.1080/00031305.1986.10475419">https://doi.org/10.1080/00031305.1986.10475419</a>
</div>
<div id="ref-degroot2012" class="csl-entry" role="listitem">
DeGroot, M. H., &amp; Schervish, M. J. (2012). <em>Probability and statistics</em> (4th ed.). Addison-Wesley.
</div>
<div id="ref-durbin1950" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1950). Testing for serial correlation in least squares regression. <span>I</span>. <em>Biometrika</em>, <em>37</em>(3-4), 409–428. <a href="https://doi.org/10.1093/biomet/37.3-4.409">https://doi.org/10.1093/biomet/37.3-4.409</a>
</div>
<div id="ref-durbin1951" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1951). Testing for serial correlation in least squares regression. <span>II</span>. <em>Biometrika</em>, <em>38</em>(1-2), 159–178. <a href="https://doi.org/10.1093/biomet/38.1-2.159">https://doi.org/10.1093/biomet/38.1-2.159</a>
</div>
<div id="ref-durbin1971" class="csl-entry" role="listitem">
Durbin, J., &amp; Watson, G. S. (1971). Testing for serial correlation in least squares regression. <span>III</span>. <em>Biometrika</em>, <em>58</em>(1), 1–19. <a href="https://doi.org/10.1093/biomet/58.1.1">https://doi.org/10.1093/biomet/58.1.1</a>
</div>
<div id="ref-fox2016" class="csl-entry" role="listitem">
Fox, J. (2016). <em>Applied regression analysis and generalized linear models</em> (3rd ed.). Sage.
</div>
<div id="ref-greener2020" class="csl-entry" role="listitem">
Greener, R. (2020, August 4). <em>Stop testing for normality</em>. Medium. <a href="https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90">https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90</a>
</div>
<div id="ref-hair2019" class="csl-entry" role="listitem">
Hair, J. F. (2019). <em>Multivariate data analysis</em> (8th ed.). Cengage.
</div>
<div id="ref-jarque1980" class="csl-entry" role="listitem">
Jarque, C. M., &amp; Bera, A. K. (1980). Efficient tests for normality, homoscedasticity and serial independence of regression residuals. <em>Economics Letters</em>, <em>6</em>(3), 255–259. <a href="https://doi.org/10.1016/0165-1765(80)90024-5">https://doi.org/10.1016/0165-1765(80)90024-5</a>
</div>
<div id="ref-jarque1987" class="csl-entry" role="listitem">
Jarque, C. M., &amp; Bera, A. K. (1987). A test for normality of observations and regression residuals. <em>International Statistical Review</em>, <em>55</em>(2), 163–172. <a href="https://doi.org/10.2307/1403192">https://doi.org/10.2307/1403192</a>
</div>
<div id="ref-koenker1981" class="csl-entry" role="listitem">
Koenker, R. (1981). A note on studentizing a test for heteroscedasticity. <em>Journal of Econometrics</em>, <em>17</em>(1), 107–112. <a href="https://doi.org/10.1016/0304-4076(81)90062-2">https://doi.org/10.1016/0304-4076(81)90062-2</a>
</div>
<div id="ref-kolmogorov1933" class="csl-entry" role="listitem">
Kolmogorov, A. (1933). Sulla determinazione empirica di una legge di distribuzione. <em>Giornale dell’Istituto Italiano degli Attuari</em>, <em>4</em>.
</div>
<div id="ref-kozak2018" class="csl-entry" role="listitem">
Kozak, M., &amp; Piepho, H.-P. (2018). What’s normal anyway? <span>Residual</span> plots are more telling than significance tests when checking <span>ANOVA</span> assumptions. <em>Journal of Agronomy and Crop Science</em>, <em>204</em>(1), 86–98. <a href="https://doi.org/10.1111/jac.12220">https://doi.org/10.1111/jac.12220</a>
</div>
<div id="ref-lilliefors1967" class="csl-entry" role="listitem">
Lilliefors, H. W. (1967). On the <span>Kolmogorov-Smirnov</span> test for normality with mean and variance unknown. <em>Journal of the American Statistical Association</em>, <em>62</em>(318), 399–402. <a href="https://doi.org/10.1080/01621459.1967.10482916">https://doi.org/10.1080/01621459.1967.10482916</a>
</div>
<div id="ref-ljung1978" class="csl-entry" role="listitem">
Ljung, G. M., &amp; Box, G. E. P. (1978). On a measure of lack of fit in time series models. <em>Biometrika</em>, <em>65</em>(2), 297–303. <a href="https://doi.org/10.1093/biomet/65.2.297">https://doi.org/10.1093/biomet/65.2.297</a>
</div>
<div id="ref-massey1951" class="csl-entry" role="listitem">
Massey, F. J. (1951). The <span>Kolmogorov-Smirnov</span> test for goodness of fit. <em>Journal of the American Statistical Association</em>, <em>46</em>(253), 68–78. <a href="https://doi.org/10.1080/01621459.1951.10500769">https://doi.org/10.1080/01621459.1951.10500769</a>
</div>
<div id="ref-nahhas2024" class="csl-entry" role="listitem">
Nahhas, R. W. (2024). <em>Introduction to regression methods for public health using <span>R</span></em>. <a href="https://www.bookdown.org/rwnahhas/RMPH/">https://www.bookdown.org/rwnahhas/RMPH/</a>
</div>
<div id="ref-newey1987" class="csl-entry" role="listitem">
Newey, W. K., &amp; West, K. D. (1987). A simple, positive semi-definite, heteroskedasticity and autocorrelation consistent covariance matrix. <em>Econometrica</em>, <em>55</em>(3), 703–708. <a href="https://doi.org/10.2307/1913610">https://doi.org/10.2307/1913610</a>
</div>
<div id="ref-newey1994" class="csl-entry" role="listitem">
Newey, W. K., &amp; West, K. D. (1994). Automatic lag selection in covariance matrix estimation. <em>The Review of Economic Studies</em>, <em>61</em>(4), 631–653. <a href="https://doi.org/10.2307/2297912">https://doi.org/10.2307/2297912</a>
</div>
<div id="ref-pearson1900" class="csl-entry" role="listitem">
Pearson, K. (1900). X. <span>On</span> the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling. <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em>, <em>50</em>(302), 157–175. <a href="https://doi.org/10.1080/14786440009463897">https://doi.org/10.1080/14786440009463897</a>
</div>
<div id="ref-rcoreteam" class="csl-entry" role="listitem">
R Core Team. (n.d.). <em>R: A language and environment for statistical computing</em> [Computer software]. R Foundation for Statistical Computing. <a href="https://www.R-project.org">https://www.R-project.org</a>
</div>
<div id="ref-ramsey1969" class="csl-entry" role="listitem">
Ramsey, J. B. (1969). Tests for specification errors in classical linear least-squares regression analysis. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <em>31</em>(2), 350–371. <a href="https://doi.org/10.1111/j.2517-6161.1969.tb00796.x">https://doi.org/10.1111/j.2517-6161.1969.tb00796.x</a>
</div>
<div id="ref-schucany2006" class="csl-entry" role="listitem">
Schucany, W. R., &amp; Ng, H. K. T. (2006). Preliminary goodness-of-fit tests for normality do not validate the one-sample <span>Student</span> t. <em>Communications in Statistics - Theory and Methods</em>, <em>35</em>(12), 2275–2286. <a href="https://doi.org/10.1080/03610920600853308">https://doi.org/10.1080/03610920600853308</a>
</div>
<div id="ref-shapiro1972" class="csl-entry" role="listitem">
Shapiro, S. S., &amp; Francia, R. S. (1972). An approximate analysis of variance test for normality. <em>Journal of the American Statistical Association</em>, <em>67</em>(337), 215–216. <a href="https://doi.org/10.1080/01621459.1972.10481232">https://doi.org/10.1080/01621459.1972.10481232</a>
</div>
<div id="ref-shapiro1965" class="csl-entry" role="listitem">
Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples)†. <em>Biometrika</em>, <em>52</em>(3-4), 591–611. <a href="https://doi.org/10.1093/biomet/52.3-4.591">https://doi.org/10.1093/biomet/52.3-4.591</a>
</div>
<div id="ref-shatz2024" class="csl-entry" role="listitem">
Shatz, I. (2024). Assumption-checking rather than (just) testing: The importance of visualization and effect size in statistical diagnostics. <em>Behavior Research Methods</em>, <em>56</em>(2), 826–845. <a href="https://doi.org/10.3758/s13428-023-02072-x">https://doi.org/10.3758/s13428-023-02072-x</a>
</div>
<div id="ref-smirnov1948" class="csl-entry" role="listitem">
Smirnov, N. (1948). Table for estimating the goodness of fit of empirical distributions. <em>Annals of Mathematical Statistics</em>, <em>19</em>, 279–281.
</div>
<div id="ref-struck2024" class="csl-entry" role="listitem">
Struck, J. (2024). <em>Regression <span>Diagnostics</span> with <span>R</span></em>. University of Wisconsin-Madison. <a href="https://sscc.wisc.edu/sscc/pubs/RegDiag-R/">https://sscc.wisc.edu/sscc/pubs/RegDiag-R/</a>
</div>
<div id="ref-thode2002" class="csl-entry" role="listitem">
Thode, H. C. (2002). <em>Testing for normality</em>. Marcel Dekker.
</div>
<div id="ref-welsch1977" class="csl-entry" role="listitem">
Welsch, R., &amp; Kuh, E. (1977). <em>Linear regression diagnostics</em> (Working Paper 0173; p. 44). National Bureau of Economic Research. <a href="https://doi.org/10.3386/w0173">https://doi.org/10.3386/w0173</a>
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/danielvartan\.github\.io\/mastersthesis\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../qmd/supplementary-material-4.html" class="pagination-link" aria-label="Sample Balance">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Sample Balance</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/supplementary-material-6.html" class="pagination-link" aria-label="Hypothesis Test B">
        <span class="nav-page-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Hypothesis Test B</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb169" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- %:::% .common h1 begin %:::% --&gt;</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Test A</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- %:::% .common h1 end %:::% --&gt;</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"_setup.R"</span>))</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>This document focuses on testing the thesis hypothesis (**Test A**) using the methods described in the supplemental material titled *Methods*.</span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>The assumptions addressed here are those relevant to general linear models, with further information available in the supplemental material titled *Overview of General Linear Models*.</span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>As with all analyses in this thesis, the process is fully reproducible and was conducted using the <span class="co">[</span><span class="ot">R programming language</span><span class="co">](https://www.r-project.org/)</span> <span class="co">[</span><span class="ot">@rcoreteam</span><span class="co">]</span> along with the <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org/)</span> publishing system <span class="co">[</span><span class="ot">@allaire</span><span class="co">]</span>.</span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting the Enviroment</span></span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cli)</span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fBasics)</span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb169-36"><a href="#cb169-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotify)</span>
<span id="cb169-37"><a href="#cb169-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grDevices)</span>
<span id="cb169-38"><a href="#cb169-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb169-39"><a href="#cb169-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span>
<span id="cb169-40"><a href="#cb169-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb169-41"><a href="#cb169-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb169-42"><a href="#cb169-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb169-43"><a href="#cb169-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb169-44"><a href="#cb169-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubritime) <span class="co"># github.com/danielvartan/lubritime</span></span>
<span id="cb169-45"><a href="#cb169-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb169-46"><a href="#cb169-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(methods)</span>
<span id="cb169-47"><a href="#cb169-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb169-48"><a href="#cb169-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb169-49"><a href="#cb169-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb169-50"><a href="#cb169-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb169-51"><a href="#cb169-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb169-52"><a href="#cb169-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb169-53"><a href="#cb169-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(prettycheck) <span class="co"># github.com/danielvartan/prettycheck</span></span>
<span id="cb169-54"><a href="#cb169-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychometric)</span>
<span id="cb169-55"><a href="#cb169-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb169-56"><a href="#cb169-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwrss)</span>
<span id="cb169-57"><a href="#cb169-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb169-58"><a href="#cb169-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb169-59"><a href="#cb169-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb169-60"><a href="#cb169-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rutils) <span class="co"># github.com/danielvartan/rutils</span></span>
<span id="cb169-61"><a href="#cb169-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see)</span>
<span id="cb169-62"><a href="#cb169-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skedastic)</span>
<span id="cb169-63"><a href="#cb169-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb169-64"><a href="#cb169-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb169-65"><a href="#cb169-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb169-66"><a href="#cb169-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb169-67"><a href="#cb169-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb169-68"><a href="#cb169-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb169-69"><a href="#cb169-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows)</span>
<span id="cb169-70"><a href="#cb169-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-71"><a href="#cb169-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-74"><a href="#cb169-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-75"><a href="#cb169-75" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-76"><a href="#cb169-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-77"><a href="#cb169-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb169-78"><a href="#cb169-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb169-79"><a href="#cb169-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb169-80"><a href="#cb169-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-81"><a href="#cb169-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-84"><a href="#cb169-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-85"><a href="#cb169-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb169-86"><a href="#cb169-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-87"><a href="#cb169-87" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"cohens_f_squared.R"</span>))</span>
<span id="cb169-88"><a href="#cb169-88" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"normality_summary.R"</span>))</span>
<span id="cb169-89"><a href="#cb169-89" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"panel_tabset_coef_dfbetas.R"</span>))</span>
<span id="cb169-90"><a href="#cb169-90" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"panel_tabset_var_distribution.R"</span>))</span>
<span id="cb169-91"><a href="#cb169-91" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"panel_tabset_var_homoscedasticity.R"</span>))</span>
<span id="cb169-92"><a href="#cb169-92" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"plot_box_plot.R"</span>))</span>
<span id="cb169-93"><a href="#cb169-93" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"plot_ggally.R"</span>))</span>
<span id="cb169-94"><a href="#cb169-94" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"plot_hist.R"</span>))</span>
<span id="cb169-95"><a href="#cb169-95" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"plot_qq.R"</span>))</span>
<span id="cb169-96"><a href="#cb169-96" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"stats_summary.R"</span>))</span>
<span id="cb169-97"><a href="#cb169-97" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"test_normality.R"</span>))</span>
<span id="cb169-98"><a href="#cb169-98" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils.R"</span>))</span>
<span id="cb169-99"><a href="#cb169-99" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils-checks.R"</span>))</span>
<span id="cb169-100"><a href="#cb169-100" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils-plots.R"</span>))</span>
<span id="cb169-101"><a href="#cb169-101" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>, <span class="st">"utils-stats.R"</span>))</span>
<span id="cb169-102"><a href="#cb169-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-103"><a href="#cb169-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-104"><a href="#cb169-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading and Processing the Data</span></span>
<span id="cb169-105"><a href="#cb169-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-106"><a href="#cb169-106" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-107"><a href="#cb169-107" aria-hidden="true" tabindex="-1"></a>Assumption 1</span>
<span id="cb169-108"><a href="#cb169-108" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Predictor is known__. Either the vectors $z_{1}, \dots , z_{n}$ are known ahead of time, or they are the observed values of random vectors $Z_{1}, \dots , Z_{n}$ on whose values we condition before computing the joint distribution of ($Y_{1}, \dots , Y_{n}$) <span class="co">[</span><span class="ot">@degroot2012, p. 736</span><span class="co">]</span>.</span>
<span id="cb169-109"><a href="#cb169-109" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-110"><a href="#cb169-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-111"><a href="#cb169-111" aria-hidden="true" tabindex="-1"></a>**Assumption 1** is satisfied, as the predictors are known.</span>
<span id="cb169-112"><a href="#cb169-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-115"><a href="#cb169-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-116"><a href="#cb169-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-117"><a href="#cb169-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb169-118"><a href="#cb169-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-119"><a href="#cb169-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-120"><a href="#cb169-120" aria-hidden="true" tabindex="-1"></a>targets<span class="sc">::</span><span class="fu">tar_make</span>(<span class="at">script =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_targets.R"</span>))</span>
<span id="cb169-121"><a href="#cb169-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-122"><a href="#cb169-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-123"><a href="#cb169-123" aria-hidden="true" tabindex="-1"></a>This data processing is performed solely for the purpose of the analysis. The variables undergo numerical transformations to streamline the modeling process and minimize potential errors.</span>
<span id="cb169-124"><a href="#cb169-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-127"><a href="#cb169-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-128"><a href="#cb169-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb169-129"><a href="#cb169-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-130"><a href="#cb169-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-131"><a href="#cb169-131" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb169-132"><a href="#cb169-132" aria-hidden="true" tabindex="-1"></a>  targets<span class="sc">::</span><span class="fu">tar_read</span>(<span class="st">"weighted_data"</span>, <span class="at">store =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"_targets"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb169-133"><a href="#cb169-133" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb169-134"><a href="#cb169-134" aria-hidden="true" tabindex="-1"></a>    msf_sc, age, sex, longitude, ghi_month, ghi_annual, </span>
<span id="cb169-135"><a href="#cb169-135" aria-hidden="true" tabindex="-1"></a>    march_equinox_daylight, june_solstice_daylight,</span>
<span id="cb169-136"><a href="#cb169-136" aria-hidden="true" tabindex="-1"></a>    december_solstice_daylight, cell_weight</span>
<span id="cb169-137"><a href="#cb169-137" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-138"><a href="#cb169-138" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-139"><a href="#cb169-139" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb169-140"><a href="#cb169-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">"_daylight"</span>),</span>
<span id="cb169-141"><a href="#cb169-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="sc">~</span> .x <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb169-142"><a href="#cb169-142" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-143"><a href="#cb169-143" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-144"><a href="#cb169-144" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-145"><a href="#cb169-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">msf_sc =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb169-146"><a href="#cb169-146" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all</span>(</span>
<span id="cb169-147"><a href="#cb169-147" aria-hidden="true" tabindex="-1"></a>        hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">min</span>(msf_sc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">&lt;</span> hms<span class="sc">::</span><span class="fu">parse_hm</span>(<span class="st">"12:00"</span>) <span class="sc">&amp;</span></span>
<span id="cb169-148"><a href="#cb169-148" aria-hidden="true" tabindex="-1"></a>          hms<span class="sc">::</span><span class="fu">as_hms</span>(<span class="fu">max</span>(msf_sc, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">&lt;</span> hms<span class="sc">::</span><span class="fu">parse_hm</span>(<span class="st">"12:00"</span>),</span>
<span id="cb169-149"><a href="#cb169-149" aria-hidden="true" tabindex="-1"></a>        <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb169-150"><a href="#cb169-150" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">~</span> msf_sc <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(), <span class="co"># TRUE</span></span>
<span id="cb169-151"><a href="#cb169-151" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> msf_sc <span class="sc">|&gt;</span> </span>
<span id="cb169-152"><a href="#cb169-152" aria-hidden="true" tabindex="-1"></a>        lubritime<span class="sc">:::</span><span class="fu">link_to_timeline</span>(</span>
<span id="cb169-153"><a href="#cb169-153" aria-hidden="true" tabindex="-1"></a>          <span class="at">threshold =</span> hms<span class="sc">::</span><span class="fu">parse_hms</span>(<span class="st">"12:00:00"</span>)</span>
<span id="cb169-154"><a href="#cb169-154" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb169-155"><a href="#cb169-155" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb169-156"><a href="#cb169-156" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-157"><a href="#cb169-157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-158"><a href="#cb169-158" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb169-159"><a href="#cb169-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-160"><a href="#cb169-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-163"><a href="#cb169-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-164"><a href="#cb169-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-165"><a href="#cb169-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-166"><a href="#cb169-166" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb169-167"><a href="#cb169-167" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>cell_weight) <span class="sc">|&gt;</span></span>
<span id="cb169-168"><a href="#cb169-168" aria-hidden="true" tabindex="-1"></a>  report<span class="sc">::</span><span class="fu">report</span>()</span>
<span id="cb169-169"><a href="#cb169-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-170"><a href="#cb169-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-171"><a href="#cb169-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conducting a Power Analysis</span></span>
<span id="cb169-172"><a href="#cb169-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-175"><a href="#cb169-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-176"><a href="#cb169-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-177"><a href="#cb169-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-178"><a href="#cb169-178" aria-hidden="true" tabindex="-1"></a>pre_pwr <span class="ot">&lt;-</span> pwrss<span class="sc">::</span><span class="fu">pwrss.f.reg</span>(</span>
<span id="cb169-179"><a href="#cb169-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="fl">0.02</span>, <span class="co"># Minimal Effect Size (MES).</span></span>
<span id="cb169-180"><a href="#cb169-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">length</span>(data) <span class="sc">-</span> <span class="dv">2</span>, <span class="co"># Number of predictors (-msf_sc, -cell_weight).</span></span>
<span id="cb169-181"><a href="#cb169-181" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.99</span>,</span>
<span id="cb169-182"><a href="#cb169-182" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.01</span></span>
<span id="cb169-183"><a href="#cb169-183" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-184"><a href="#cb169-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-185"><a href="#cb169-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-186"><a href="#cb169-186" aria-hidden="true" tabindex="-1"></a>The results indicate that at least <span class="in">`{r} format_to_md_latex(pre_pwr$n)`</span> observations per variable are required to achieve a power of $0.99$ ($1 - \beta$, the probability of **not** committing a [type II error](https://en.wikipedia.org/wiki/Type_I_and_type_II_errors)) and a significance level ($\alpha$) of $0.01$ ($0.99$ probability of **not** committing a <span class="co">[</span><span class="ot">type I error</span><span class="co">](https://en.wikipedia.org/wiki/Type_I_and_type_II_errors)</span>). The dataset contains <span class="in">`{r} format_to_md_latex(nrow(data))`</span> observations, which exceeds this requirement.</span>
<span id="cb169-187"><a href="#cb169-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-190"><a href="#cb169-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-191"><a href="#cb169-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-192"><a href="#cb169-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-193"><a href="#cb169-193" aria-hidden="true" tabindex="-1"></a>pre_pwr <span class="ot">&lt;-</span> pwrss<span class="sc">::</span><span class="fu">pwrss.f.reg</span>(</span>
<span id="cb169-194"><a href="#cb169-194" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="fl">0.02</span>, <span class="co"># Minimal Effect Size (MES).</span></span>
<span id="cb169-195"><a href="#cb169-195" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">length</span>(data) <span class="sc">-</span> <span class="dv">2</span>, <span class="co"># Number of predictors (-msf_sc, -cell_weight).</span></span>
<span id="cb169-196"><a href="#cb169-196" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.99</span>,</span>
<span id="cb169-197"><a href="#cb169-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.01</span></span>
<span id="cb169-198"><a href="#cb169-198" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-199"><a href="#cb169-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-200"><a href="#cb169-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-201"><a href="#cb169-201" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-power-analysis}</span>
<span id="cb169-204"><a href="#cb169-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-205"><a href="#cb169-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-206"><a href="#cb169-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-207"><a href="#cb169-207" aria-hidden="true" tabindex="-1"></a>pwrss<span class="sc">::</span><span class="fu">power.f.test</span>(</span>
<span id="cb169-208"><a href="#cb169-208" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncp =</span> pre_pwr<span class="sc">$</span>ncp,</span>
<span id="cb169-209"><a href="#cb169-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">df1 =</span> pre_pwr<span class="sc">$</span>df1,</span>
<span id="cb169-210"><a href="#cb169-210" aria-hidden="true" tabindex="-1"></a>  <span class="at">df2 =</span> pre_pwr<span class="sc">$</span>df2,</span>
<span id="cb169-211"><a href="#cb169-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> pre_pwr<span class="sc">$</span>parms<span class="sc">$</span>alpha,</span>
<span id="cb169-212"><a href="#cb169-212" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span></span>
<span id="cb169-213"><a href="#cb169-213" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-214"><a href="#cb169-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-215"><a href="#cb169-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-216"><a href="#cb169-216" aria-hidden="true" tabindex="-1"></a>Source: Created by the author.</span>
<span id="cb169-217"><a href="#cb169-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-218"><a href="#cb169-218" aria-hidden="true" tabindex="-1"></a>Power analysis for the hypothesis test.</span>
<span id="cb169-219"><a href="#cb169-219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-220"><a href="#cb169-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-221"><a href="#cb169-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examining Distributions</span></span>
<span id="cb169-222"><a href="#cb169-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-225"><a href="#cb169-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-226"><a href="#cb169-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-227"><a href="#cb169-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-228"><a href="#cb169-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-229"><a href="#cb169-229" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb169-230"><a href="#cb169-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel_tabset_var_distribution</span>(</span>
<span id="cb169-231"><a href="#cb169-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_name =</span> <span class="st">"data"</span>,</span>
<span id="cb169-232"><a href="#cb169-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> </span>
<span id="cb169-233"><a href="#cb169-233" aria-hidden="true" tabindex="-1"></a>      data <span class="sc">|&gt;</span></span>
<span id="cb169-234"><a href="#cb169-234" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-235"><a href="#cb169-235" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">"^sex$|^cell_weight$"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>),</span>
<span id="cb169-236"><a href="#cb169-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_labels =</span> <span class="fu">c</span>(</span>
<span id="cb169-237"><a href="#cb169-237" aria-hidden="true" tabindex="-1"></a>      <span class="st">"MSF~sc~ (Chronotype proxy) (seconds)"</span>,</span>
<span id="cb169-238"><a href="#cb169-238" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Age (years)"</span>,</span>
<span id="cb169-239"><a href="#cb169-239" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Longitude (decimal degrees)"</span>,</span>
<span id="cb169-240"><a href="#cb169-240" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Monthly average global horizontal irradiance (Wh/m²)"</span>,</span>
<span id="cb169-241"><a href="#cb169-241" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Annual average global horizontal irradiance (Wh/m²)"</span>,</span>
<span id="cb169-242"><a href="#cb169-242" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the March equinox (seconds)"</span>,</span>
<span id="cb169-243"><a href="#cb169-243" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the June solstice (seconds)"</span>,</span>
<span id="cb169-244"><a href="#cb169-244" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the December solstice (seconds)"</span></span>
<span id="cb169-245"><a href="#cb169-245" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-246"><a href="#cb169-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading =</span> <span class="st">"###"</span>,</span>
<span id="cb169-247"><a href="#cb169-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"sm-5"</span></span>
<span id="cb169-248"><a href="#cb169-248" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-249"><a href="#cb169-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-250"><a href="#cb169-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-251"><a href="#cb169-251" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../qmd/_panel-tabset-var-distribution-sm-5.qmd &gt;}}</span>
<span id="cb169-252"><a href="#cb169-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-253"><a href="#cb169-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Examining Correlations</span></span>
<span id="cb169-254"><a href="#cb169-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-255"><a href="#cb169-255" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-correlation-matrix}</span>
<span id="cb169-258"><a href="#cb169-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-259"><a href="#cb169-259" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb169-260"><a href="#cb169-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ggally</span>(</span>
<span id="cb169-261"><a href="#cb169-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(</span>
<span id="cb169-262"><a href="#cb169-262" aria-hidden="true" tabindex="-1"></a>      <span class="st">"msf_sc"</span>,</span>
<span id="cb169-263"><a href="#cb169-263" aria-hidden="true" tabindex="-1"></a>      <span class="st">"age"</span>,</span>
<span id="cb169-264"><a href="#cb169-264" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sex"</span>,</span>
<span id="cb169-265"><a href="#cb169-265" aria-hidden="true" tabindex="-1"></a>      <span class="st">"longitude"</span>,</span>
<span id="cb169-266"><a href="#cb169-266" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ghi_month"</span>,</span>
<span id="cb169-267"><a href="#cb169-267" aria-hidden="true" tabindex="-1"></a>      <span class="st">"ghi_annual"</span></span>
<span id="cb169-268"><a href="#cb169-268" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-269"><a href="#cb169-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">colour =</span> sex)</span>
<span id="cb169-270"><a href="#cb169-270" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb169-271"><a href="#cb169-271" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-272"><a href="#cb169-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-273"><a href="#cb169-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-274"><a href="#cb169-274" aria-hidden="true" tabindex="-1"></a>Source: Created by the author.</span>
<span id="cb169-275"><a href="#cb169-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-276"><a href="#cb169-276" aria-hidden="true" tabindex="-1"></a>Correlation matrix of the main predictors.</span>
<span id="cb169-277"><a href="#cb169-277" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-278"><a href="#cb169-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-279"><a href="#cb169-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Building the Restricted Model</span></span>
<span id="cb169-280"><a href="#cb169-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-281"><a href="#cb169-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting the Model</span></span>
<span id="cb169-282"><a href="#cb169-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-285"><a href="#cb169-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-286"><a href="#cb169-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-287"><a href="#cb169-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-288"><a href="#cb169-288" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">formula</span>(msf_sc <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> longitude <span class="sc">+</span> ghi_month)</span>
<span id="cb169-289"><a href="#cb169-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-290"><a href="#cb169-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-293"><a href="#cb169-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-294"><a href="#cb169-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-295"><a href="#cb169-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-296"><a href="#cb169-296" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> </span>
<span id="cb169-297"><a href="#cb169-297" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-298"><a href="#cb169-298" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-299"><a href="#cb169-299" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb169-300"><a href="#cb169-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-301"><a href="#cb169-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-304"><a href="#cb169-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-305"><a href="#cb169-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-306"><a href="#cb169-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-307"><a href="#cb169-307" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> </span>
<span id="cb169-308"><a href="#cb169-308" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-309"><a href="#cb169-309" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_case_weights</span>(cell_weight) <span class="sc">|&gt;</span></span>
<span id="cb169-310"><a href="#cb169-310" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_formula</span>(form) <span class="sc">|&gt;</span></span>
<span id="cb169-311"><a href="#cb169-311" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(model)</span>
<span id="cb169-312"><a href="#cb169-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-313"><a href="#cb169-313" aria-hidden="true" tabindex="-1"></a>workflow</span>
<span id="cb169-314"><a href="#cb169-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-315"><a href="#cb169-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-318"><a href="#cb169-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-319"><a href="#cb169-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-320"><a href="#cb169-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-321"><a href="#cb169-321" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> workflow <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(data)</span>
<span id="cb169-322"><a href="#cb169-322" aria-hidden="true" tabindex="-1"></a>fit_restricted <span class="ot">&lt;-</span> fit</span>
<span id="cb169-323"><a href="#cb169-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-324"><a href="#cb169-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-325"><a href="#cb169-325" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-fit-1}</span>
<span id="cb169-328"><a href="#cb169-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-329"><a href="#cb169-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-330"><a href="#cb169-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-331"><a href="#cb169-331" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb169-332"><a href="#cb169-332" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-333"><a href="#cb169-333" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb169-334"><a href="#cb169-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-335"><a href="#cb169-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-336"><a href="#cb169-336" aria-hidden="true" tabindex="-1"></a>Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.</span>
<span id="cb169-337"><a href="#cb169-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-338"><a href="#cb169-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-341"><a href="#cb169-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-342"><a href="#cb169-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-343"><a href="#cb169-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-344"><a href="#cb169-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-345"><a href="#cb169-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-346"><a href="#cb169-346" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-347"><a href="#cb169-347" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-348"><a href="#cb169-348" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb169-349"><a href="#cb169-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-350"><a href="#cb169-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-351"><a href="#cb169-351" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-fit-2}</span>
<span id="cb169-354"><a href="#cb169-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-355"><a href="#cb169-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-356"><a href="#cb169-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-357"><a href="#cb169-357" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-358"><a href="#cb169-358" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-359"><a href="#cb169-359" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb169-360"><a href="#cb169-360" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">10</span>)</span>
<span id="cb169-361"><a href="#cb169-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-362"><a href="#cb169-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-363"><a href="#cb169-363" aria-hidden="true" tabindex="-1"></a>Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.</span>
<span id="cb169-364"><a href="#cb169-364" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-365"><a href="#cb169-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-368"><a href="#cb169-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-369"><a href="#cb169-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-370"><a href="#cb169-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-371"><a href="#cb169-371" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>()</span>
<span id="cb169-372"><a href="#cb169-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-373"><a href="#cb169-373" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb169-374"><a href="#cb169-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-375"><a href="#cb169-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-378"><a href="#cb169-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-379"><a href="#cb169-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-380"><a href="#cb169-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-381"><a href="#cb169-381" aria-hidden="true" tabindex="-1"></a><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span id="cb169-382"><a href="#cb169-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-383"><a href="#cb169-383" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(form, <span class="at">data =</span> data, <span class="at">weights =</span> cell_weight)</span>
<span id="cb169-384"><a href="#cb169-384" aria-hidden="true" tabindex="-1"></a>fit_engine_restricted <span class="ot">&lt;-</span> fit_engine_2</span>
<span id="cb169-385"><a href="#cb169-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-386"><a href="#cb169-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-389"><a href="#cb169-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-390"><a href="#cb169-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-391"><a href="#cb169-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-392"><a href="#cb169-392" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_engine_2)</span>
<span id="cb169-393"><a href="#cb169-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-394"><a href="#cb169-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-395"><a href="#cb169-395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluating the Model Fit</span></span>
<span id="cb169-396"><a href="#cb169-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-397"><a href="#cb169-397" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Predictions</span></span>
<span id="cb169-398"><a href="#cb169-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-399"><a href="#cb169-399" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-fit}</span>
<span id="cb169-402"><a href="#cb169-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-403"><a href="#cb169-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-404"><a href="#cb169-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-405"><a href="#cb169-405" aria-hidden="true" tabindex="-1"></a>limits <span class="ot">&lt;-</span> </span>
<span id="cb169-406"><a href="#cb169-406" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(fit_engine, <span class="at">interval =</span> <span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-407"><a href="#cb169-407" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-408"><a href="#cb169-408" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-409"><a href="#cb169-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-410"><a href="#cb169-410" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb169-411"><a href="#cb169-411" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-412"><a href="#cb169-412" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(limits) <span class="sc">|&gt;</span></span>
<span id="cb169-413"><a href="#cb169-413" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(msf_sc, .pred)) <span class="sc">+</span></span>
<span id="cb169-414"><a href="#cb169-414" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span id="cb169-415"><a href="#cb169-415" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span id="cb169-416"><a href="#cb169-416" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   alpha = 0.2</span></span>
<span id="cb169-417"><a href="#cb169-417" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb169-418"><a href="#cb169-418" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(</span>
<span id="cb169-419"><a href="#cb169-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb169-420"><a href="#cb169-420" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(lwr <span class="sc">~</span> msf_sc)),</span>
<span id="cb169-421"><a href="#cb169-421" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(upr <span class="sc">~</span> msf_sc)),</span>
<span id="cb169-422"><a href="#cb169-422" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-423"><a href="#cb169-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb169-424"><a href="#cb169-424" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-425"><a href="#cb169-425" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb169-426"><a href="#cb169-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> lwr),</span>
<span id="cb169-427"><a href="#cb169-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-428"><a href="#cb169-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb169-429"><a href="#cb169-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb169-430"><a href="#cb169-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb169-431"><a href="#cb169-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb169-432"><a href="#cb169-432" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb169-433"><a href="#cb169-433" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-434"><a href="#cb169-434" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb169-435"><a href="#cb169-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> upr),</span>
<span id="cb169-436"><a href="#cb169-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-437"><a href="#cb169-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb169-438"><a href="#cb169-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb169-439"><a href="#cb169-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb169-440"><a href="#cb169-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb169-441"><a href="#cb169-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb169-442"><a href="#cb169-442" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-443"><a href="#cb169-443" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-444"><a href="#cb169-444" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-445"><a href="#cb169-445" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-446"><a href="#cb169-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observed"</span>, </span>
<span id="cb169-447"><a href="#cb169-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted"</span></span>
<span id="cb169-448"><a href="#cb169-448" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-449"><a href="#cb169-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-450"><a href="#cb169-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-451"><a href="#cb169-451" aria-hidden="true" tabindex="-1"></a>Relation between observed and predicted values. The red line is a 45-degree line originating from the plane's origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <span class="co">[</span><span class="ot">prediction interval</span><span class="co">](http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/)</span>.</span>
<span id="cb169-452"><a href="#cb169-452" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-453"><a href="#cb169-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-454"><a href="#cb169-454" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Posterior Predictive Checks</span></span>
<span id="cb169-455"><a href="#cb169-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-456"><a href="#cb169-456" aria-hidden="true" tabindex="-1"></a>Posterior predictive checks are a Bayesian technique used to assess model fit by comparing observed data to data simulated from the <span class="co">[</span><span class="ot">posterior predictive distribution</span><span class="co">](https://en.wikipedia.org/wiki/Posterior_predictive_distribution)</span> (i.e., the distribution of potential unobserved values given the observed data). These checks help identify systematic discrepancies between the observed and simulated data, providing insight into whether the chosen model (or distributional family) is appropriate. Ideally, the model-predicted lines should closely match the observed data patterns.</span>
<span id="cb169-457"><a href="#cb169-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-458"><a href="#cb169-458" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-fit-comparison}</span>
<span id="cb169-461"><a href="#cb169-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-462"><a href="#cb169-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-463"><a href="#cb169-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-464"><a href="#cb169-464" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-465"><a href="#cb169-465" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-466"><a href="#cb169-466" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb169-467"><a href="#cb169-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-468"><a href="#cb169-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb169-469"><a href="#cb169-469" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-470"><a href="#cb169-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-471"><a href="#cb169-471" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-472"><a href="#cb169-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-473"><a href="#cb169-473" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>PP_CHECK <span class="sc">+</span></span>
<span id="cb169-474"><a href="#cb169-474" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-475"><a href="#cb169-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-476"><a href="#cb169-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-477"><a href="#cb169-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"MSFsc (Chronotype proxy) (s)"</span>,</span>
<span id="cb169-478"><a href="#cb169-478" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-479"><a href="#cb169-479" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb169-480"><a href="#cb169-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-481"><a href="#cb169-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-482"><a href="#cb169-482" aria-hidden="true" tabindex="-1"></a>Posterior predictive checks for the model. The red line represents the observed data, while the black lines represent the model-predicted data.</span>
<span id="cb169-483"><a href="#cb169-483" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-484"><a href="#cb169-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-485"><a href="#cb169-485" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conducting Model Diagnostics</span></span>
<span id="cb169-486"><a href="#cb169-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-487"><a href="#cb169-487" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb169-488"><a href="#cb169-488" aria-hidden="true" tabindex="-1"></a>It's important to note that objective assumption tests (e.g., Anderson–Darling test) is not advisable for larger samples, since they can be overly sensitive to minor deviations. Additionally, they might overlook visual patterns that are not captured by a single metric <span class="co">[</span><span class="ot">@shatz2024; @kozak2018; @schucany2006</span><span class="co">]</span>.</span>
<span id="cb169-489"><a href="#cb169-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-490"><a href="#cb169-490" aria-hidden="true" tabindex="-1"></a>I included those tests here **just for reference**. However, for the reason above, all assumptions were diagnosed by **visual assessment**.</span>
<span id="cb169-491"><a href="#cb169-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-492"><a href="#cb169-492" aria-hidden="true" tabindex="-1"></a>For a straightforward critique of normality tests specifically, refer to <span class="co">[</span><span class="ot">this</span><span class="co">](https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90)</span> article by @greener2020.</span>
<span id="cb169-493"><a href="#cb169-493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-494"><a href="#cb169-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-495"><a href="#cb169-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normality</span></span>
<span id="cb169-496"><a href="#cb169-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-497"><a href="#cb169-497" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-498"><a href="#cb169-498" aria-hidden="true" tabindex="-1"></a>Assumption 2</span>
<span id="cb169-499"><a href="#cb169-499" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Normality__. For $i = 1, \dots, n$, the conditional distribution of $Y_{i}$ given the vectors $z_{1}, \dots , z_{n}$ is a normal distribution <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-500"><a href="#cb169-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-501"><a href="#cb169-501" aria-hidden="true" tabindex="-1"></a>(Normality of the error term distribution <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-502"><a href="#cb169-502" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-503"><a href="#cb169-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-504"><a href="#cb169-504" aria-hidden="true" tabindex="-1"></a>**Assumption 2** is satisfied, as the residuals shown a fairly normal distribution by visual inspection.</span>
<span id="cb169-505"><a href="#cb169-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-506"><a href="#cb169-506" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-507"><a href="#cb169-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-508"><a href="#cb169-508" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-residual-diag-normality-1}</span>
<span id="cb169-511"><a href="#cb169-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-512"><a href="#cb169-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-513"><a href="#cb169-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-514"><a href="#cb169-514" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-515"><a href="#cb169-515" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-516"><a href="#cb169-516" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-517"><a href="#cb169-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">col =</span> <span class="st">"value"</span>, <span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-518"><a href="#cb169-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-519"><a href="#cb169-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-520"><a href="#cb169-520" aria-hidden="true" tabindex="-1"></a>Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.</span>
<span id="cb169-521"><a href="#cb169-521" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-522"><a href="#cb169-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-523"><a href="#cb169-523" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-residual-diag-normality-2}</span>
<span id="cb169-526"><a href="#cb169-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-527"><a href="#cb169-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-528"><a href="#cb169-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-529"><a href="#cb169-529" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-530"><a href="#cb169-530" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-531"><a href="#cb169-531" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb169-532"><a href="#cb169-532" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb169-533"><a href="#cb169-533" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb169-534"><a href="#cb169-534" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(</span>
<span id="cb169-535"><a href="#cb169-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"red"</span>, </span>
<span id="cb169-536"><a href="#cb169-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="dv">1</span>,</span>
<span id="cb169-537"><a href="#cb169-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.5</span></span>
<span id="cb169-538"><a href="#cb169-538" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-539"><a href="#cb169-539" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb169-540"><a href="#cb169-540" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb169-541"><a href="#cb169-541" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-542"><a href="#cb169-542" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-543"><a href="#cb169-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-544"><a href="#cb169-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb169-545"><a href="#cb169-545" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-546"><a href="#cb169-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-547"><a href="#cb169-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-548"><a href="#cb169-548" aria-hidden="true" tabindex="-1"></a>Boxplot of model residuals with outliers highlighted in red.</span>
<span id="cb169-549"><a href="#cb169-549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-550"><a href="#cb169-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-551"><a href="#cb169-551" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-normality-1}</span>
<span id="cb169-554"><a href="#cb169-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-555"><a href="#cb169-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-556"><a href="#cb169-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-557"><a href="#cb169-557" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-558"><a href="#cb169-558" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-559"><a href="#cb169-559" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-560"><a href="#cb169-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_summary</span>(<span class="at">col =</span> <span class="st">"value"</span>, <span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-561"><a href="#cb169-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-562"><a href="#cb169-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-563"><a href="#cb169-563" aria-hidden="true" tabindex="-1"></a>Summary statistics of model residuals.</span>
<span id="cb169-564"><a href="#cb169-564" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-565"><a href="#cb169-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-566"><a href="#cb169-566" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tests</span></span>
<span id="cb169-567"><a href="#cb169-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-568"><a href="#cb169-568" aria-hidden="true" tabindex="-1"></a>It's important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don't recommend using them when testing for normality <span class="co">[</span><span class="ot">@dagostino1990</span><span class="co">]</span>. Learn more about normality tests in @thode2002.</span>
<span id="cb169-569"><a href="#cb169-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-570"><a href="#cb169-570" aria-hidden="true" tabindex="-1"></a>I also recommend checking the original papers for each test to understand their assumptions and limitations:</span>
<span id="cb169-571"><a href="#cb169-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-572"><a href="#cb169-572" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Anderson-Darling test</span><span class="co">](https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test)</span>: @anderson1952; @anderson1954.</span>
<span id="cb169-573"><a href="#cb169-573" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bonett-Seier test: @bonett2002.</span>
<span id="cb169-574"><a href="#cb169-574" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Cramér-von Mises test</span><span class="co">](https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion)</span>: @cramer1928; @anderson1962.</span>
<span id="cb169-575"><a href="#cb169-575" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">D'Agostino test</span><span class="co">](https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test)</span>: @dagostino1971; @dagostino1973.</span>
<span id="cb169-576"><a href="#cb169-576" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Jarque–Bera test</span><span class="co">](https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test)</span>: @jarque1980; @bera1981; @jarque1987.</span>
<span id="cb169-577"><a href="#cb169-577" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Lilliefors (K-S) test</span><span class="co">](https://en.wikipedia.org/wiki/Lilliefors_test)</span>:  @smirnov1948; @kolmogorov1933; @massey1951; @lilliefors1967; @dallal1986.</span>
<span id="cb169-578"><a href="#cb169-578" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pearson chi-square test</span><span class="co">](https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test)</span>: @pearson1900.</span>
<span id="cb169-579"><a href="#cb169-579" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Francia test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test)</span>: @shapiro1972.</span>
<span id="cb169-580"><a href="#cb169-580" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Wilk test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)</span>: @shapiro1965.</span>
<span id="cb169-581"><a href="#cb169-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-582"><a href="#cb169-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-583"><a href="#cb169-583" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-584"><a href="#cb169-584" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The data is normally distributed} <span class="sc">\\</span></span>
<span id="cb169-585"><a href="#cb169-585" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The data is not normally distributed}</span>
<span id="cb169-586"><a href="#cb169-586" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-587"><a href="#cb169-587" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-588"><a href="#cb169-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-589"><a href="#cb169-589" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-normality-2}</span>
<span id="cb169-592"><a href="#cb169-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-593"><a href="#cb169-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-594"><a href="#cb169-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-595"><a href="#cb169-595" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-596"><a href="#cb169-596" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-597"><a href="#cb169-597" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-598"><a href="#cb169-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">normality_summary</span>(<span class="at">col =</span> <span class="st">"value"</span>)</span>
<span id="cb169-599"><a href="#cb169-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-600"><a href="#cb169-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-601"><a href="#cb169-601" aria-hidden="true" tabindex="-1"></a>Summary of statistical tests conducted to assess the normality of the residuals.</span>
<span id="cb169-602"><a href="#cb169-602" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-603"><a href="#cb169-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-604"><a href="#cb169-604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linearity</span></span>
<span id="cb169-605"><a href="#cb169-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-606"><a href="#cb169-606" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-607"><a href="#cb169-607" aria-hidden="true" tabindex="-1"></a>Assumption 3</span>
<span id="cb169-608"><a href="#cb169-608" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Linear mean__. There is a vector of parameters  $\beta = (\beta_{0}, \dots, \beta_{p - 1})$ such that the conditional mean of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ has the form</span>
<span id="cb169-609"><a href="#cb169-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-610"><a href="#cb169-610" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-611"><a href="#cb169-611" aria-hidden="true" tabindex="-1"></a>z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}</span>
<span id="cb169-612"><a href="#cb169-612" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-613"><a href="#cb169-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-614"><a href="#cb169-614" aria-hidden="true" tabindex="-1"></a>for $i = 1, \dots, n$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-615"><a href="#cb169-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-616"><a href="#cb169-616" aria-hidden="true" tabindex="-1"></a>(Linearity of the phenomenon measured <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-617"><a href="#cb169-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-618"><a href="#cb169-618" aria-hidden="true" tabindex="-1"></a>It is important to clarify that the linear assumption pertains to **linearity in the parameters** or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="co">[</span><span class="ot">@cohen2002</span><span class="co">]</span>.</span>
<span id="cb169-619"><a href="#cb169-619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-620"><a href="#cb169-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-621"><a href="#cb169-621" aria-hidden="true" tabindex="-1"></a>**Assumption 3** is satisfied, as the relationship between the variables is fairly linear.</span>
<span id="cb169-622"><a href="#cb169-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-623"><a href="#cb169-623" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-residual-diag-fitted-values-1}</span>
<span id="cb169-626"><a href="#cb169-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-627"><a href="#cb169-627" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-628"><a href="#cb169-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-629"><a href="#cb169-629" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-630"><a href="#cb169-630" aria-hidden="true" tabindex="-1"></a>  fit <span class="sc">|&gt;</span></span>
<span id="cb169-631"><a href="#cb169-631" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-632"><a href="#cb169-632" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .resid)) <span class="sc">+</span></span>
<span id="cb169-633"><a href="#cb169-633" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-634"><a href="#cb169-634" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(</span>
<span id="cb169-635"><a href="#cb169-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb169-636"><a href="#cb169-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb169-637"><a href="#cb169-637" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb169-638"><a href="#cb169-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span> </span>
<span id="cb169-639"><a href="#cb169-639" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-640"><a href="#cb169-640" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-641"><a href="#cb169-641" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-642"><a href="#cb169-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-643"><a href="#cb169-643" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-644"><a href="#cb169-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-645"><a href="#cb169-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-646"><a href="#cb169-646" aria-hidden="true" tabindex="-1"></a>Residual plot showing the relationship between fitted values and residuals. The dashed black line represent zero residuals, indicating an ideal model fit. The red line indicate the conditional mean of residuals.</span>
<span id="cb169-647"><a href="#cb169-647" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-648"><a href="#cb169-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-649"><a href="#cb169-649" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-residual-diag-linearity-1}</span>
<span id="cb169-652"><a href="#cb169-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-653"><a href="#cb169-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-654"><a href="#cb169-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-655"><a href="#cb169-655" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_fit_spread</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-656"><a href="#cb169-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-657"><a href="#cb169-657" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plots)) {</span>
<span id="cb169-658"><a href="#cb169-658" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> plots[[i]] <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-659"><a href="#cb169-659" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-660"><a href="#cb169-660" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-661"><a href="#cb169-661" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>data[[<span class="dv">1</span>]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb169-662"><a href="#cb169-662" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>plot<span class="sc">$</span>layers[[<span class="dv">1</span>]]<span class="sc">$</span>constructor<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb169-663"><a href="#cb169-663" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-664"><a href="#cb169-664" aria-hidden="true" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-665"><a href="#cb169-665" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-666"><a href="#cb169-666" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-667"><a href="#cb169-667" aria-hidden="true" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plots<span class="sc">$</span>fm_plot, plots<span class="sc">$</span>rsd_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb169-668"><a href="#cb169-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-669"><a href="#cb169-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-670"><a href="#cb169-670" aria-hidden="true" tabindex="-1"></a>Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. "Proportion Less" indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.</span>
<span id="cb169-671"><a href="#cb169-671" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-672"><a href="#cb169-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-673"><a href="#cb169-673" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Ramsey's RESET test</span><span class="co">](https://en.wikipedia.org/wiki/Ramsey_RESET_test)</span> indicates that the model has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</span>
<span id="cb169-674"><a href="#cb169-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-675"><a href="#cb169-675" aria-hidden="true" tabindex="-1"></a>Learn more about the Ramsey's RESET test in: @ramsey1969.</span>
<span id="cb169-676"><a href="#cb169-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-677"><a href="#cb169-677" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-678"><a href="#cb169-678" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-679"><a href="#cb169-679" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The model has no omitted variables} <span class="sc">\\</span></span>
<span id="cb169-680"><a href="#cb169-680" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The model has omitted variables}</span>
<span id="cb169-681"><a href="#cb169-681" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-682"><a href="#cb169-682" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-683"><a href="#cb169-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-686"><a href="#cb169-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-687"><a href="#cb169-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-688"><a href="#cb169-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-689"><a href="#cb169-689" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">power =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb169-690"><a href="#cb169-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-691"><a href="#cb169-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-694"><a href="#cb169-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-695"><a href="#cb169-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-696"><a href="#cb169-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-697"><a href="#cb169-697" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">type =</span> <span class="st">"regressor"</span>)</span>
<span id="cb169-698"><a href="#cb169-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-699"><a href="#cb169-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-700"><a href="#cb169-700" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Homoscedasticity (Common Variance)</span></span>
<span id="cb169-701"><a href="#cb169-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-702"><a href="#cb169-702" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-703"><a href="#cb169-703" aria-hidden="true" tabindex="-1"></a>Assumption 4</span>
<span id="cb169-704"><a href="#cb169-704" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Common variance__ (homoscedasticity). There is as parameter $\sigma^{2}$ such the conditional variance of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ is $\sigma^{2}$ for $i = 1, \dots, n$.</span>
<span id="cb169-705"><a href="#cb169-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-706"><a href="#cb169-706" aria-hidden="true" tabindex="-1"></a>(Constant variance of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-707"><a href="#cb169-707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-708"><a href="#cb169-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-709"><a href="#cb169-709" aria-hidden="true" tabindex="-1"></a>**Assumption 4** is satisfied. When comparing the standardized residuals ($\sqrt{|\text{Standardized Residuals}|}$) spread to the fitted values, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</span>
<span id="cb169-710"><a href="#cb169-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-711"><a href="#cb169-711" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-712"><a href="#cb169-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-715"><a href="#cb169-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-716"><a href="#cb169-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-717"><a href="#cb169-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-718"><a href="#cb169-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-719"><a href="#cb169-719" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on:</span></span>
<span id="cb169-720"><a href="#cb169-720" aria-hidden="true" tabindex="-1"></a><span class="co"># https://sscc.wisc.edu/sscc/pubs/RegDiag-R/homoscedasticity.html#:~:text=We%20must%20plot%20the%20residuals%20against%20the%20fitted%20values%20and%20against%20each%20of%20the%20predictors.</span></span>
<span id="cb169-721"><a href="#cb169-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-722"><a href="#cb169-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-723"><a href="#cb169-723" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-homoscedasticity-1}</span>
<span id="cb169-726"><a href="#cb169-726" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-727"><a href="#cb169-727" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-728"><a href="#cb169-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-729"><a href="#cb169-729" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span></span>
<span id="cb169-730"><a href="#cb169-730" aria-hidden="true" tabindex="-1"></a>  fit <span class="sc">|&gt;</span></span>
<span id="cb169-731"><a href="#cb169-731" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-732"><a href="#cb169-732" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-733"><a href="#cb169-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb169-734"><a href="#cb169-734" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-735"><a href="#cb169-735" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-736"><a href="#cb169-736" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-737"><a href="#cb169-737" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb169-738"><a href="#cb169-738" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-739"><a href="#cb169-739" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .sd_resid)) <span class="sc">+</span></span>
<span id="cb169-740"><a href="#cb169-740" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-741"><a href="#cb169-741" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-742"><a href="#cb169-742" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-743"><a href="#cb169-743" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fitted values"</span>, </span>
<span id="cb169-744"><a href="#cb169-744" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Standardized </span><span class="sc">\\</span><span class="st"> Residuals|}$"</span>)</span>
<span id="cb169-745"><a href="#cb169-745" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-746"><a href="#cb169-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-747"><a href="#cb169-747" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-748"><a href="#cb169-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-749"><a href="#cb169-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-750"><a href="#cb169-750" aria-hidden="true" tabindex="-1"></a>Relation between the fitted values of the model and its standardized residuals.</span>
<span id="cb169-751"><a href="#cb169-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-752"><a href="#cb169-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-755"><a href="#cb169-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-756"><a href="#cb169-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-757"><a href="#cb169-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-758"><a href="#cb169-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-759"><a href="#cb169-759" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb169-760"><a href="#cb169-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel_tabset_var_homoscedasticity</span>(</span>
<span id="cb169-761"><a href="#cb169-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_name =</span> <span class="st">"data"</span>,</span>
<span id="cb169-762"><a href="#cb169-762" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> fit,</span>
<span id="cb169-763"><a href="#cb169-763" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(</span>
<span id="cb169-764"><a href="#cb169-764" aria-hidden="true" tabindex="-1"></a>      <span class="st">"msf_sc"</span>,</span>
<span id="cb169-765"><a href="#cb169-765" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-766"><a href="#cb169-766" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">coef</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-767"><a href="#cb169-767" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-768"><a href="#cb169-768" aria-hidden="true" tabindex="-1"></a>      magrittr<span class="sc">::</span><span class="fu">extract</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-769"><a href="#cb169-769" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">"^sex"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-770"><a href="#cb169-770" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-771"><a href="#cb169-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_labels =</span> <span class="fu">c</span>(</span>
<span id="cb169-772"><a href="#cb169-772" aria-hidden="true" tabindex="-1"></a>      <span class="st">"MSF~sc~  (Chronotype proxy) (seconds)"</span>,</span>
<span id="cb169-773"><a href="#cb169-773" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Age (years)"</span>,</span>
<span id="cb169-774"><a href="#cb169-774" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Longitude (decimal degrees)"</span>,</span>
<span id="cb169-775"><a href="#cb169-775" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Monthly average global horizontal irradiance (Wh/m²)"</span></span>
<span id="cb169-776"><a href="#cb169-776" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-777"><a href="#cb169-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading =</span> <span class="st">"######"</span>,</span>
<span id="cb169-778"><a href="#cb169-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"sm-5-restricted-model"</span></span>
<span id="cb169-779"><a href="#cb169-779" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-780"><a href="#cb169-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-781"><a href="#cb169-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-782"><a href="#cb169-782" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../qmd/_panel-tabset-var-homoscedasticity-sm-5-restricted-model.qmd &gt;}}</span>
<span id="cb169-783"><a href="#cb169-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-784"><a href="#cb169-784" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Breusch-Pagan Test</span></span>
<span id="cb169-785"><a href="#cb169-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-786"><a href="#cb169-786" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Breusch-Pagan test</span><span class="co">](https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test)</span> test indicates that the residuals exhibit constant variance.</span>
<span id="cb169-787"><a href="#cb169-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-788"><a href="#cb169-788" aria-hidden="true" tabindex="-1"></a>Learn more about the Breusch-Pagan test in: @breusch1979 and @koenker1981.</span>
<span id="cb169-789"><a href="#cb169-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-790"><a href="#cb169-790" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-791"><a href="#cb169-791" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-792"><a href="#cb169-792" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The variance is constant} <span class="sc">\\</span></span>
<span id="cb169-793"><a href="#cb169-793" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The variance is not constant}</span>
<span id="cb169-794"><a href="#cb169-794" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-795"><a href="#cb169-795" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-796"><a href="#cb169-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-799"><a href="#cb169-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-800"><a href="#cb169-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-801"><a href="#cb169-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-802"><a href="#cb169-802" aria-hidden="true" tabindex="-1"></a><span class="co"># With studentising modification of Koenker</span></span>
<span id="cb169-803"><a href="#cb169-803" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-804"><a href="#cb169-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-805"><a href="#cb169-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-808"><a href="#cb169-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-809"><a href="#cb169-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-810"><a href="#cb169-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-811"><a href="#cb169-811" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-812"><a href="#cb169-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-813"><a href="#cb169-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-816"><a href="#cb169-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-817"><a href="#cb169-817" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the studentized modification of Koenker.</span></span>
<span id="cb169-818"><a href="#cb169-818" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-819"><a href="#cb169-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-820"><a href="#cb169-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-823"><a href="#cb169-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-824"><a href="#cb169-824" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-825"><a href="#cb169-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-826"><a href="#cb169-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-829"><a href="#cb169-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-830"><a href="#cb169-830" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-831"><a href="#cb169-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-832"><a href="#cb169-832" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> car<span class="sc">::</span><span class="fu">ncvTest</span>()</span>
<span id="cb169-833"><a href="#cb169-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-834"><a href="#cb169-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-837"><a href="#cb169-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-838"><a href="#cb169-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-839"><a href="#cb169-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-840"><a href="#cb169-840" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_breusch_pagan</span>()</span>
<span id="cb169-841"><a href="#cb169-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-842"><a href="#cb169-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-843"><a href="#cb169-843" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Independence</span></span>
<span id="cb169-844"><a href="#cb169-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-845"><a href="#cb169-845" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-846"><a href="#cb169-846" aria-hidden="true" tabindex="-1"></a>Assumption 5</span>
<span id="cb169-847"><a href="#cb169-847" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Independence__. The random variables $Y_{1}, \dots , Y_{n}$ are independent given the observed $z_{1}, \dots , z_{n}$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-848"><a href="#cb169-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-849"><a href="#cb169-849" aria-hidden="true" tabindex="-1"></a>(Independence of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-850"><a href="#cb169-850" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-851"><a href="#cb169-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-852"><a href="#cb169-852" aria-hidden="true" tabindex="-1"></a>**Assumption 5** is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic ($1.5$ to $2.5$). It's also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see @hair2019<span class="co">[</span><span class="ot">p. 291</span><span class="co">]</span> for more information).</span>
<span id="cb169-853"><a href="#cb169-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-854"><a href="#cb169-854" aria-hidden="true" tabindex="-1"></a>Many authors don't consider autocorrelation tests for linear regression models, as they are more relevant for time series data. They were include here just for reference.</span>
<span id="cb169-855"><a href="#cb169-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-856"><a href="#cb169-856" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-857"><a href="#cb169-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-858"><a href="#cb169-858" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-independence-1}</span>
<span id="cb169-861"><a href="#cb169-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-862"><a href="#cb169-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-863"><a href="#cb169-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-864"><a href="#cb169-864" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-865"><a href="#cb169-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-866"><a href="#cb169-866" aria-hidden="true" tabindex="-1"></a>  forecast<span class="sc">::</span><span class="fu">ggtsdisplay</span>(<span class="at">lag.max=</span><span class="dv">30</span>)</span>
<span id="cb169-867"><a href="#cb169-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-868"><a href="#cb169-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-869"><a href="#cb169-869" aria-hidden="true" tabindex="-1"></a>Time series plot of the residuals along with its AutoCorrelation Function (ACF) and Partial AutoCorrelation Function (PACF).</span>
<span id="cb169-870"><a href="#cb169-870" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-871"><a href="#cb169-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-872"><a href="#cb169-872" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Correlations</span></span>
<span id="cb169-873"><a href="#cb169-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-874"><a href="#cb169-874" aria-hidden="true" tabindex="-1"></a>@tbl-model-residual-diag-independence-1 shows the relative importance of independent variables in determining the response variable. It highlights how much each variable uniquely contributes to the R-squared value, beyond what is explained by the other predictors.</span>
<span id="cb169-875"><a href="#cb169-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-876"><a href="#cb169-876" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-independence-1}</span>
<span id="cb169-879"><a href="#cb169-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-880"><a href="#cb169-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-881"><a href="#cb169-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-882"><a href="#cb169-882" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_correlations</span>()</span>
<span id="cb169-883"><a href="#cb169-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-884"><a href="#cb169-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-885"><a href="#cb169-885" aria-hidden="true" tabindex="-1"></a>Correlations between the dependent variable and the independent variables, along with the zero-order, part, and partial correlations. The zero-order correlation represents the Pearson correlation coefficient between the dependent and independent variables. Part correlations indicate how much the R-squared would decrease if a specific variable were removed from the model, while partial correlations reflect the portion of variance in the response variable that is explained by a specific independent variable, beyond the influence of other predictors in the model.</span>
<span id="cb169-886"><a href="#cb169-886" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-887"><a href="#cb169-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-888"><a href="#cb169-888" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Newey-West Estimator</span></span>
<span id="cb169-889"><a href="#cb169-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-890"><a href="#cb169-890" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Newey-West estimator</span><span class="co">](https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator)</span> is a method used to estimate the <span class="co">[</span><span class="ot">covariance matrix</span><span class="co">](https://en.wikipedia.org/wiki/Covariance_matrix)</span> of the coefficients in a regression model when the residuals are autocorrelated.</span>
<span id="cb169-891"><a href="#cb169-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-892"><a href="#cb169-892" aria-hidden="true" tabindex="-1"></a>Learn more about the Newey-West estimator in: @newey1987 and @newey1994.</span>
<span id="cb169-893"><a href="#cb169-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-896"><a href="#cb169-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-897"><a href="#cb169-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-898"><a href="#cb169-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-899"><a href="#cb169-899" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> sandwich<span class="sc">::</span><span class="fu">NeweyWest</span>()</span>
<span id="cb169-900"><a href="#cb169-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-901"><a href="#cb169-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-902"><a href="#cb169-902" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Durbin-Watson Test</span></span>
<span id="cb169-903"><a href="#cb169-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-904"><a href="#cb169-904" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Durbin-Watson test</span><span class="co">](https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic)</span> is a statistical test used to detect the presence of autocorrelation at lag $1$ in the residuals from a regression analysis. The test statistic ranges from $0$ to $4$, with a value of $2$ indicating no autocorrelation. Values less than $2$ indicate positive autocorrelation, while values greater than $2$ indicate negative autocorrelation <span class="co">[</span><span class="ot">@fox2016</span><span class="co">]</span>.</span>
<span id="cb169-905"><a href="#cb169-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-906"><a href="#cb169-906" aria-hidden="true" tabindex="-1"></a>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between $1.5$ and $2.5$ suggests little to no autocorrelation.</span>
<span id="cb169-907"><a href="#cb169-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-908"><a href="#cb169-908" aria-hidden="true" tabindex="-1"></a>Learn more about the Durbin-Watson test in: @durbin1950; @durbin1951; and @durbin1971.</span>
<span id="cb169-909"><a href="#cb169-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-910"><a href="#cb169-910" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-911"><a href="#cb169-911" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-912"><a href="#cb169-912" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} <span class="sc">\\</span></span>
<span id="cb169-913"><a href="#cb169-913" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}</span>
<span id="cb169-914"><a href="#cb169-914" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-915"><a href="#cb169-915" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-916"><a href="#cb169-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-919"><a href="#cb169-919" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-920"><a href="#cb169-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-921"><a href="#cb169-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-922"><a href="#cb169-922" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(fit_engine)</span>
<span id="cb169-923"><a href="#cb169-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-924"><a href="#cb169-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-925"><a href="#cb169-925" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ljung-Box Test</span></span>
<span id="cb169-926"><a href="#cb169-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-927"><a href="#cb169-927" aria-hidden="true" tabindex="-1"></a>The Ljung–Box test is a statistical test used to determine whether any autocorrelations within a time series are significantly different from zero. Rather than testing randomness at individual lags, it assesses the "overall" randomness across multiple lags.</span>
<span id="cb169-928"><a href="#cb169-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-929"><a href="#cb169-929" aria-hidden="true" tabindex="-1"></a>Learn more about the <span class="co">[</span><span class="ot">Ljung-Box test</span><span class="co">](https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test)</span> in: @box1970 and @ljung1978.</span>
<span id="cb169-930"><a href="#cb169-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-931"><a href="#cb169-931" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-932"><a href="#cb169-932" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-933"><a href="#cb169-933" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Residuals are independently distributed} <span class="sc">\\</span></span>
<span id="cb169-934"><a href="#cb169-934" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Residuals are not independently distributed}</span>
<span id="cb169-935"><a href="#cb169-935" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-936"><a href="#cb169-936" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-937"><a href="#cb169-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-940"><a href="#cb169-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-941"><a href="#cb169-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-942"><a href="#cb169-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-943"><a href="#cb169-943" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-944"><a href="#cb169-944" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-945"><a href="#cb169-945" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">Box.test</span>(<span class="at">type =</span> <span class="st">"Ljung-Box"</span>, <span class="at">lag =</span> <span class="dv">10</span>)</span>
<span id="cb169-946"><a href="#cb169-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-947"><a href="#cb169-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-948"><a href="#cb169-948" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Colinearity/Multicollinearity</span></span>
<span id="cb169-949"><a href="#cb169-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-950"><a href="#cb169-950" aria-hidden="true" tabindex="-1"></a>No high degree of colinearity was observed among the independent variables.</span>
<span id="cb169-951"><a href="#cb169-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-952"><a href="#cb169-952" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variance Inflation Factor (VIF)</span></span>
<span id="cb169-953"><a href="#cb169-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-954"><a href="#cb169-954" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Variance Inflation Factor (VIF)</span><span class="co">](https://en.wikipedia.org/wiki/Variance_inflation_factor)</span> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value ($\text{VIF}_{i} = 1/\text{TO}L$). High VIF values (larger than ~5 <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="co">[</span><span class="ot">@hair2019, p. 265</span><span class="co">]</span>.</span>
<span id="cb169-955"><a href="#cb169-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-956"><a href="#cb169-956" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-colinearity-1}</span>
<span id="cb169-959"><a href="#cb169-959" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-960"><a href="#cb169-960" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-961"><a href="#cb169-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-962"><a href="#cb169-962" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-963"><a href="#cb169-963" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-964"><a href="#cb169-964" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(<span class="at">panel =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-965"><a href="#cb169-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-966"><a href="#cb169-966" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-967"><a href="#cb169-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-968"><a href="#cb169-968" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>VIF <span class="sc">+</span> </span>
<span id="cb169-969"><a href="#cb169-969" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-970"><a href="#cb169-970" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-971"><a href="#cb169-971" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb169-972"><a href="#cb169-972" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-973"><a href="#cb169-973" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-974"><a href="#cb169-974" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb169-975"><a href="#cb169-975" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-976"><a href="#cb169-976" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-977"><a href="#cb169-977" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb169-978"><a href="#cb169-978" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>)</span>
<span id="cb169-979"><a href="#cb169-979" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-980"><a href="#cb169-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-981"><a href="#cb169-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-982"><a href="#cb169-982" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.</span>
<span id="cb169-983"><a href="#cb169-983" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-984"><a href="#cb169-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-985"><a href="#cb169-985" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-colinearity-1}</span>
<span id="cb169-988"><a href="#cb169-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-989"><a href="#cb169-989" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-990"><a href="#cb169-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-991"><a href="#cb169-991" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_vif_tol</span>()</span>
<span id="cb169-992"><a href="#cb169-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-993"><a href="#cb169-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-994"><a href="#cb169-994" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) and tolerance values for each predictor variable.</span>
<span id="cb169-995"><a href="#cb169-995" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-996"><a href="#cb169-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-997"><a href="#cb169-997" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-colinearity-2}</span>
<span id="cb169-1000"><a href="#cb169-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1001"><a href="#cb169-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1002"><a href="#cb169-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1003"><a href="#cb169-1003" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> performance<span class="sc">::</span><span class="fu">check_collinearity</span>()</span>
<span id="cb169-1004"><a href="#cb169-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1005"><a href="#cb169-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1006"><a href="#cb169-1006" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) and tolerance values for each predictor variable.</span>
<span id="cb169-1007"><a href="#cb169-1007" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1008"><a href="#cb169-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1009"><a href="#cb169-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Condition Index</span></span>
<span id="cb169-1010"><a href="#cb169-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1011"><a href="#cb169-1011" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">condition index</span><span class="co">](https://en.wikipedia.org/wiki/Condition_number)</span> is a measure of multicollinearity in a regression model. It is based on the <span class="co">[</span><span class="ot">eigenvalues</span><span class="co">](https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors)</span> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="co">[</span><span class="ot">@belsley2004, p. 112-114</span><span class="co">]</span>.</span>
<span id="cb169-1012"><a href="#cb169-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1013"><a href="#cb169-1013" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-restricted-model-residual-diag-colinearity-2}</span>
<span id="cb169-1016"><a href="#cb169-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1017"><a href="#cb169-1017" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1018"><a href="#cb169-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1019"><a href="#cb169-1019" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_eigen_cindex</span>()</span>
<span id="cb169-1020"><a href="#cb169-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1021"><a href="#cb169-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1022"><a href="#cb169-1022" aria-hidden="true" tabindex="-1"></a>Condition indexes and eigenvalues for each predictor variable.</span>
<span id="cb169-1023"><a href="#cb169-1023" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1024"><a href="#cb169-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1025"><a href="#cb169-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Measures of Influence</span></span>
<span id="cb169-1026"><a href="#cb169-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1027"><a href="#cb169-1027" aria-hidden="true" tabindex="-1"></a>In this section, I check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</span>
<span id="cb169-1028"><a href="#cb169-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1029"><a href="#cb169-1029" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-1030"><a href="#cb169-1030" aria-hidden="true" tabindex="-1"></a>Leverage points</span>
<span id="cb169-1031"><a href="#cb169-1031" aria-hidden="true" tabindex="-1"></a>: Leverage is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence the model estimates <span class="co">[</span><span class="ot">@struck2024; @hair2019, p. 262; @nahhas2024</span><span class="co">]</span>.</span>
<span id="cb169-1032"><a href="#cb169-1032" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1033"><a href="#cb169-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1034"><a href="#cb169-1034" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-1035"><a href="#cb169-1035" aria-hidden="true" tabindex="-1"></a>Influence points</span>
<span id="cb169-1036"><a href="#cb169-1036" aria-hidden="true" tabindex="-1"></a>: Influence is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="co">[</span><span class="ot">@struck2024; @nahhas2024</span><span class="co">]</span>.</span>
<span id="cb169-1037"><a href="#cb169-1037" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1038"><a href="#cb169-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1039"><a href="#cb169-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Standardized Residuals</span></span>
<span id="cb169-1040"><a href="#cb169-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1041"><a href="#cb169-1041" aria-hidden="true" tabindex="-1"></a>Standardized residuals are a rescaling of the residual to a common basis by dividing each residual by the standard deviation of the residuals <span class="co">[</span><span class="ot">@hair2019, p. 264</span><span class="co">]</span>.</span>
<span id="cb169-1042"><a href="#cb169-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1045"><a href="#cb169-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1046"><a href="#cb169-1046" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1047"><a href="#cb169-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1048"><a href="#cb169-1048" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1049"><a href="#cb169-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1050"><a href="#cb169-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1051"><a href="#cb169-1051" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-1}</span>
<span id="cb169-1054"><a href="#cb169-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1055"><a href="#cb169-1055" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1056"><a href="#cb169-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1057"><a href="#cb169-1057" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-1058"><a href="#cb169-1058" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-1059"><a href="#cb169-1059" aria-hidden="true" tabindex="-1"></a>  <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstandard</span>(fit_engine)</span>
<span id="cb169-1060"><a href="#cb169-1060" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-1061"><a href="#cb169-1061" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-1062"><a href="#cb169-1062" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> std, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> std)</span>
<span id="cb169-1063"><a href="#cb169-1063" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1064"><a href="#cb169-1064" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-1065"><a href="#cb169-1065" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1066"><a href="#cb169-1066" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1067"><a href="#cb169-1067" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1068"><a href="#cb169-1068" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1069"><a href="#cb169-1069" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-1070"><a href="#cb169-1070" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1071"><a href="#cb169-1071" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-1072"><a href="#cb169-1072" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Standardized residual"</span></span>
<span id="cb169-1073"><a href="#cb169-1073" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1074"><a href="#cb169-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1075"><a href="#cb169-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1076"><a href="#cb169-1076" aria-hidden="true" tabindex="-1"></a>Standardized residuals for each observation.</span>
<span id="cb169-1077"><a href="#cb169-1077" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1078"><a href="#cb169-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1081"><a href="#cb169-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1082"><a href="#cb169-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1083"><a href="#cb169-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1084"><a href="#cb169-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1085"><a href="#cb169-1085" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stand</span>()</span>
<span id="cb169-1086"><a href="#cb169-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1087"><a href="#cb169-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1088"><a href="#cb169-1088" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Studentized Residuals</span></span>
<span id="cb169-1089"><a href="#cb169-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1090"><a href="#cb169-1090" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Studentized residuals</span><span class="co">](https://en.wikipedia.org/wiki/Studentized_residual)</span> are a commonly used variant of the standardized residual. It differs from other methods in how it calculates the standard deviation used in standardization. To minimize the effect of any observation on the standardization process, the standard deviation of the residual for observation $i$ is computed from regression estimates omitting the $i$th observation in the calculation of the regression estimates <span class="co">[</span><span class="ot">@hair2019, p. 264</span><span class="co">]</span>.</span>
<span id="cb169-1091"><a href="#cb169-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1094"><a href="#cb169-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1095"><a href="#cb169-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1096"><a href="#cb169-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1097"><a href="#cb169-1097" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstudent</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1098"><a href="#cb169-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1099"><a href="#cb169-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1100"><a href="#cb169-1100" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-2}</span>
<span id="cb169-1103"><a href="#cb169-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1104"><a href="#cb169-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1105"><a href="#cb169-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1106"><a href="#cb169-1106" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-1107"><a href="#cb169-1107" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-1108"><a href="#cb169-1108" aria-hidden="true" tabindex="-1"></a>  <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstudent</span>(fit_engine)</span>
<span id="cb169-1109"><a href="#cb169-1109" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-1110"><a href="#cb169-1110" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-1111"><a href="#cb169-1111" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> std, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> std)</span>
<span id="cb169-1112"><a href="#cb169-1112" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1113"><a href="#cb169-1113" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-1114"><a href="#cb169-1114" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1115"><a href="#cb169-1115" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1116"><a href="#cb169-1116" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1117"><a href="#cb169-1117" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1118"><a href="#cb169-1118" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-1119"><a href="#cb169-1119" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1120"><a href="#cb169-1120" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-1121"><a href="#cb169-1121" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-1122"><a href="#cb169-1122" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1123"><a href="#cb169-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1124"><a href="#cb169-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1125"><a href="#cb169-1125" aria-hidden="true" tabindex="-1"></a>Studentized residuals for each observation.</span>
<span id="cb169-1126"><a href="#cb169-1126" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1127"><a href="#cb169-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1128"><a href="#cb169-1128" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-3}</span>
<span id="cb169-1131"><a href="#cb169-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1132"><a href="#cb169-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1133"><a href="#cb169-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1134"><a href="#cb169-1134" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-1135"><a href="#cb169-1135" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1136"><a href="#cb169-1136" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-1137"><a href="#cb169-1137" aria-hidden="true" tabindex="-1"></a>    <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstudent</span>(fit_engine)</span>
<span id="cb169-1138"><a href="#cb169-1138" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-1139"><a href="#cb169-1139" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, std)) <span class="sc">+</span></span>
<span id="cb169-1140"><a href="#cb169-1140" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-1141"><a href="#cb169-1141" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1142"><a href="#cb169-1142" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-1143"><a href="#cb169-1143" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1144"><a href="#cb169-1144" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1145"><a href="#cb169-1145" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-1146"><a href="#cb169-1146" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1147"><a href="#cb169-1147" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted value"</span>,</span>
<span id="cb169-1148"><a href="#cb169-1148" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-1149"><a href="#cb169-1149" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1150"><a href="#cb169-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1151"><a href="#cb169-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1152"><a href="#cb169-1152" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and fitted values.</span>
<span id="cb169-1153"><a href="#cb169-1153" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1154"><a href="#cb169-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1155"><a href="#cb169-1155" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-4}</span>
<span id="cb169-1158"><a href="#cb169-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1159"><a href="#cb169-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1160"><a href="#cb169-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1161"><a href="#cb169-1161" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1162"><a href="#cb169-1162" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1163"><a href="#cb169-1163" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_lev</span>(<span class="at">threshold =</span> <span class="dv">2</span>, <span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1164"><a href="#cb169-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1165"><a href="#cb169-1165" aria-hidden="true" tabindex="-1"></a>plot<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb169-1166"><a href="#cb169-1166" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1167"><a href="#cb169-1167" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1168"><a href="#cb169-1168" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-1169"><a href="#cb169-1169" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1170"><a href="#cb169-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1171"><a href="#cb169-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1172"><a href="#cb169-1172" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and their leverage points.</span>
<span id="cb169-1173"><a href="#cb169-1173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1174"><a href="#cb169-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1177"><a href="#cb169-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1178"><a href="#cb169-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1179"><a href="#cb169-1179" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1180"><a href="#cb169-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1181"><a href="#cb169-1181" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud</span>()</span>
<span id="cb169-1182"><a href="#cb169-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1183"><a href="#cb169-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1186"><a href="#cb169-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1187"><a href="#cb169-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1188"><a href="#cb169-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1189"><a href="#cb169-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1190"><a href="#cb169-1190" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1191"><a href="#cb169-1191" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-1192"><a href="#cb169-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"Studentized"</span>,</span>
<span id="cb169-1193"><a href="#cb169-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1194"><a href="#cb169-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-1195"><a href="#cb169-1195" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1196"><a href="#cb169-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1197"><a href="#cb169-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1200"><a href="#cb169-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1201"><a href="#cb169-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1202"><a href="#cb169-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1203"><a href="#cb169-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1204"><a href="#cb169-1204" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud_fit</span>()</span>
<span id="cb169-1205"><a href="#cb169-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1206"><a href="#cb169-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1207"><a href="#cb169-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Hat Values</span></span>
<span id="cb169-1208"><a href="#cb169-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1209"><a href="#cb169-1209" aria-hidden="true" tabindex="-1"></a>The hat value indicates how distinct an observation’s predictor values are from those of other observations. Observations with high hat values have high leverage and may be, though not necessarily, influential. There is no fixed threshold for what constitutes a “large” hat value; instead, the focus must be on observations with hat values significantly higher than the rest <span class="co">[</span><span class="ot">@nahhas2024; @hair2019, p. 261</span><span class="co">]</span>.</span>
<span id="cb169-1210"><a href="#cb169-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1213"><a href="#cb169-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1214"><a href="#cb169-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1215"><a href="#cb169-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1216"><a href="#cb169-1216" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">hatvalues</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1217"><a href="#cb169-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1218"><a href="#cb169-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1219"><a href="#cb169-1219" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-5}</span>
<span id="cb169-1222"><a href="#cb169-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1223"><a href="#cb169-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1224"><a href="#cb169-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1225"><a href="#cb169-1225" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-1226"><a href="#cb169-1226" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-1227"><a href="#cb169-1227" aria-hidden="true" tabindex="-1"></a>  <span class="at">hat =</span> stats<span class="sc">::</span><span class="fu">hatvalues</span>(fit_engine)</span>
<span id="cb169-1228"><a href="#cb169-1228" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-1229"><a href="#cb169-1229" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-1230"><a href="#cb169-1230" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> hat, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> hat)</span>
<span id="cb169-1231"><a href="#cb169-1231" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1232"><a href="#cb169-1232" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-1233"><a href="#cb169-1233" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1234"><a href="#cb169-1234" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-1235"><a href="#cb169-1235" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Hat value"</span></span>
<span id="cb169-1236"><a href="#cb169-1236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1237"><a href="#cb169-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1238"><a href="#cb169-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1239"><a href="#cb169-1239" aria-hidden="true" tabindex="-1"></a>Hat values for each observation.</span>
<span id="cb169-1240"><a href="#cb169-1240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1241"><a href="#cb169-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1244"><a href="#cb169-1244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1245"><a href="#cb169-1245" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1246"><a href="#cb169-1246" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1247"><a href="#cb169-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1248"><a href="#cb169-1248" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1249"><a href="#cb169-1249" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-1250"><a href="#cb169-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"hat"</span>,</span>
<span id="cb169-1251"><a href="#cb169-1251" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1252"><a href="#cb169-1252" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-1253"><a href="#cb169-1253" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1254"><a href="#cb169-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1255"><a href="#cb169-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1256"><a href="#cb169-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Cook's Distance</span></span>
<span id="cb169-1257"><a href="#cb169-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1258"><a href="#cb169-1258" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Cook's D</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span> measures each observation's influence on the model's fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb169-1259"><a href="#cb169-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1260"><a href="#cb169-1260" aria-hidden="true" tabindex="-1"></a>A common practice is to flag observations with a Cook's distance of 1.0 or greater. However, a threshold of $4 / (n - k - 1)$, where $n$ is the sample size and $k$ is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb169-1261"><a href="#cb169-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1262"><a href="#cb169-1262" aria-hidden="true" tabindex="-1"></a>Learn more about Cook's D in: @cook1977; @cook1979.</span>
<span id="cb169-1263"><a href="#cb169-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1266"><a href="#cb169-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1267"><a href="#cb169-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1268"><a href="#cb169-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1269"><a href="#cb169-1269" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">cooks.distance</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1270"><a href="#cb169-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1271"><a href="#cb169-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1272"><a href="#cb169-1272" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-6}</span>
<span id="cb169-1275"><a href="#cb169-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1276"><a href="#cb169-1276" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1277"><a href="#cb169-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1278"><a href="#cb169-1278" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1279"><a href="#cb169-1279" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1280"><a href="#cb169-1280" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_bar</span>(<span class="at">type =</span> <span class="dv">2</span>, <span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1281"><a href="#cb169-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1282"><a href="#cb169-1282" aria-hidden="true" tabindex="-1"></a><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span id="cb169-1283"><a href="#cb169-1283" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-1284"><a href="#cb169-1284" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-1285"><a href="#cb169-1285" aria-hidden="true" tabindex="-1"></a>q<span class="sc">$</span>data[[<span class="dv">5</span>]]<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb169-1286"><a href="#cb169-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1287"><a href="#cb169-1287" aria-hidden="true" tabindex="-1"></a>q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-1288"><a href="#cb169-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1289"><a href="#cb169-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1290"><a href="#cb169-1290" aria-hidden="true" tabindex="-1"></a>Cook's distance for each observation along with a threshold line at $4 / (n - k - 1)$.</span>
<span id="cb169-1291"><a href="#cb169-1291" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1292"><a href="#cb169-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1293"><a href="#cb169-1293" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-7}</span>
<span id="cb169-1296"><a href="#cb169-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1297"><a href="#cb169-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1298"><a href="#cb169-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1299"><a href="#cb169-1299" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-1300"><a href="#cb169-1300" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-1301"><a href="#cb169-1301" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb169-1302"><a href="#cb169-1302" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1303"><a href="#cb169-1303" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb169-1304"><a href="#cb169-1304" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-1305"><a href="#cb169-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1306"><a href="#cb169-1306" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-1307"><a href="#cb169-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1308"><a href="#cb169-1308" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1309"><a href="#cb169-1309" aria-hidden="true" tabindex="-1"></a>  diag_sum_plots<span class="sc">$</span>OUTLIERS <span class="sc">+</span></span>
<span id="cb169-1310"><a href="#cb169-1310" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1311"><a href="#cb169-1311" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1312"><a href="#cb169-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1313"><a href="#cb169-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb169-1314"><a href="#cb169-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residuals"</span></span>
<span id="cb169-1315"><a href="#cb169-1315" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1316"><a href="#cb169-1316" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-1317"><a href="#cb169-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb169-1318"><a href="#cb169-1318" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-1319"><a href="#cb169-1319" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"gray25"</span>),</span>
<span id="cb169-1320"><a href="#cb169-1320" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb169-1321"><a href="#cb169-1321" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1322"><a href="#cb169-1322" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb169-1323"><a href="#cb169-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1324"><a href="#cb169-1324" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-1325"><a href="#cb169-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1326"><a href="#cb169-1326" aria-hidden="true" tabindex="-1"></a><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span id="cb169-1327"><a href="#cb169-1327" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) {</span>
<span id="cb169-1328"><a href="#cb169-1328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span id="cb169-1329"><a href="#cb169-1329" aria-hidden="true" tabindex="-1"></a>  plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb169-1330"><a href="#cb169-1330" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">~</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb169-1331"><a href="#cb169-1331" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"#1b6ca8"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb169-1332"><a href="#cb169-1332" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"darkgray"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb169-1333"><a href="#cb169-1333" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour</span>
<span id="cb169-1334"><a href="#cb169-1334" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1335"><a href="#cb169-1335" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-1336"><a href="#cb169-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1337"><a href="#cb169-1337" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-1338"><a href="#cb169-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1339"><a href="#cb169-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1340"><a href="#cb169-1340" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and their leverage points. The blue line represents the <span class="co">[</span><span class="ot">Cook's distance</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span>. Any points outside the contour lines are influential observations.</span>
<span id="cb169-1341"><a href="#cb169-1341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1342"><a href="#cb169-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1345"><a href="#cb169-1345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1346"><a href="#cb169-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1347"><a href="#cb169-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1348"><a href="#cb169-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1349"><a href="#cb169-1349" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_chart</span>()</span>
<span id="cb169-1350"><a href="#cb169-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1351"><a href="#cb169-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1354"><a href="#cb169-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1355"><a href="#cb169-1355" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1356"><a href="#cb169-1356" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1357"><a href="#cb169-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1358"><a href="#cb169-1358" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1359"><a href="#cb169-1359" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-1360"><a href="#cb169-1360" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"Cook"</span>,</span>
<span id="cb169-1361"><a href="#cb169-1361" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1362"><a href="#cb169-1362" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-1363"><a href="#cb169-1363" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1364"><a href="#cb169-1364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1365"><a href="#cb169-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1366"><a href="#cb169-1366" aria-hidden="true" tabindex="-1"></a><span class="fu">#####  Influence on Prediction (DFFITS)</span></span>
<span id="cb169-1367"><a href="#cb169-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1368"><a href="#cb169-1368" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFFITS</span><span class="co">](https://en.wikipedia.org/wiki/DFFITS)</span> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb169-1369"><a href="#cb169-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1370"><a href="#cb169-1370" aria-hidden="true" tabindex="-1"></a>The best rule of thumb is to classify as influential any standardized values that exceed $2 \sqrt{(p / n)}$, where $p$ is the number of independent variables + 1 and $n$ is the sample size  <span class="co">[</span><span class="ot">@hair2019, p. 261</span><span class="co">]</span>.</span>
<span id="cb169-1371"><a href="#cb169-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1372"><a href="#cb169-1372" aria-hidden="true" tabindex="-1"></a>Learn more about DDFITS in: @welsch1977 and @belsley2004.</span>
<span id="cb169-1373"><a href="#cb169-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1376"><a href="#cb169-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1377"><a href="#cb169-1377" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1378"><a href="#cb169-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1379"><a href="#cb169-1379" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dffits</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1380"><a href="#cb169-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1381"><a href="#cb169-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1382"><a href="#cb169-1382" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-8}</span>
<span id="cb169-1385"><a href="#cb169-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1386"><a href="#cb169-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1387"><a href="#cb169-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1388"><a href="#cb169-1388" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1389"><a href="#cb169-1389" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_dffits</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1390"><a href="#cb169-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1391"><a href="#cb169-1391" aria-hidden="true" tabindex="-1"></a>plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-1392"><a href="#cb169-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1393"><a href="#cb169-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1394"><a href="#cb169-1394" aria-hidden="true" tabindex="-1"></a>Standardized DFFITS (difference in fits) for each observation.</span>
<span id="cb169-1395"><a href="#cb169-1395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1396"><a href="#cb169-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1397"><a href="#cb169-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">#####  Influence on Parameter Estimates (DFBETAS)</span></span>
<span id="cb169-1398"><a href="#cb169-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1399"><a href="#cb169-1399" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFBETAS</span><span class="co">](https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence)</span> are a measure of the change in a regression coefficient when an observation is omitted from the regression analysis. **The value of the DFBETA is in terms of the coefficient itself** <span class="co">[</span><span class="ot">@hair2019, p. 261</span><span class="co">]</span>. A cutoff for what is considered a large DFBETAS value is $2 / \sqrt{n}$, where $n$ is the number of observations. <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb169-1400"><a href="#cb169-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1401"><a href="#cb169-1401" aria-hidden="true" tabindex="-1"></a>Learn more about DFBETAS in: @welsch1977 and @belsley2004.</span>
<span id="cb169-1402"><a href="#cb169-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1405"><a href="#cb169-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1406"><a href="#cb169-1406" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1407"><a href="#cb169-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1408"><a href="#cb169-1408" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dfbeta</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-1409"><a href="#cb169-1409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1410"><a href="#cb169-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1413"><a href="#cb169-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1414"><a href="#cb169-1414" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1415"><a href="#cb169-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1416"><a href="#cb169-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1417"><a href="#cb169-1417" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-1418"><a href="#cb169-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel_tabset_coef_dfbetas</span>(</span>
<span id="cb169-1419"><a href="#cb169-1419" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading =</span> <span class="st">"######"</span>,</span>
<span id="cb169-1420"><a href="#cb169-1420" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"sm-5-restricted-model"</span></span>
<span id="cb169-1421"><a href="#cb169-1421" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1422"><a href="#cb169-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1423"><a href="#cb169-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1424"><a href="#cb169-1424" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../qmd/_panel-tabset-coef-dfbetas-sm-5-restricted-model.qmd &gt;}}</span>
<span id="cb169-1425"><a href="#cb169-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1426"><a href="#cb169-1426" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Hadi's Measure</span></span>
<span id="cb169-1427"><a href="#cb169-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1428"><a href="#cb169-1428" aria-hidden="true" tabindex="-1"></a>Hadi’s measure of influence is based on the idea that influential observations can occur in either the response variable, the predictors, or both.</span>
<span id="cb169-1429"><a href="#cb169-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1430"><a href="#cb169-1430" aria-hidden="true" tabindex="-1"></a>Learn more about Hadi's measure in: @chatterjee2012.</span>
<span id="cb169-1431"><a href="#cb169-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1432"><a href="#cb169-1432" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-12}</span>
<span id="cb169-1435"><a href="#cb169-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1436"><a href="#cb169-1436" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1437"><a href="#cb169-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1438"><a href="#cb169-1438" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1439"><a href="#cb169-1439" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1440"><a href="#cb169-1440" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_hadi</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1441"><a href="#cb169-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1442"><a href="#cb169-1442" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span></span>
<span id="cb169-1443"><a href="#cb169-1443" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1444"><a href="#cb169-1444" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1445"><a href="#cb169-1445" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Hadi's measure"</span></span>
<span id="cb169-1446"><a href="#cb169-1446" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1447"><a href="#cb169-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1448"><a href="#cb169-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1449"><a href="#cb169-1449" aria-hidden="true" tabindex="-1"></a>Hadi's influence measure for each observation.</span>
<span id="cb169-1450"><a href="#cb169-1450" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1451"><a href="#cb169-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1452"><a href="#cb169-1452" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-restricted-model-diag-influence-13}</span>
<span id="cb169-1455"><a href="#cb169-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1456"><a href="#cb169-1456" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1457"><a href="#cb169-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1458"><a href="#cb169-1458" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1459"><a href="#cb169-1459" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-1460"><a href="#cb169-1460" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_pot</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1461"><a href="#cb169-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1462"><a href="#cb169-1462" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-1463"><a href="#cb169-1463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1464"><a href="#cb169-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1465"><a href="#cb169-1465" aria-hidden="true" tabindex="-1"></a>Potential-residual plot classifying unusual observations as high-leverage points, outliers, or a combination of both.</span>
<span id="cb169-1466"><a href="#cb169-1466" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1467"><a href="#cb169-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1468"><a href="#cb169-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">## Building the Full Model</span></span>
<span id="cb169-1469"><a href="#cb169-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1470"><a href="#cb169-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting the Model</span></span>
<span id="cb169-1471"><a href="#cb169-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1472"><a href="#cb169-1472" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- See: &lt;https://stats.stackexchange.com/questions/25804/why-would-r-return-na-as-a-lm-coefficient&gt; --&gt;</span></span>
<span id="cb169-1473"><a href="#cb169-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1476"><a href="#cb169-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1477"><a href="#cb169-1477" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1478"><a href="#cb169-1478" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1479"><a href="#cb169-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1480"><a href="#cb169-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1481"><a href="#cb169-1481" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb169-1482"><a href="#cb169-1482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb169-1483"><a href="#cb169-1483" aria-hidden="true" tabindex="-1"></a>      <span class="st">"msf_sc ~ "</span>,</span>
<span id="cb169-1484"><a href="#cb169-1484" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb169-1485"><a href="#cb169-1485" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb169-1486"><a href="#cb169-1486" aria-hidden="true" tabindex="-1"></a>          <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"longitude"</span>, <span class="st">"ghi_month"</span>, <span class="st">"ghi_annual"</span>,</span>
<span id="cb169-1487"><a href="#cb169-1487" aria-hidden="true" tabindex="-1"></a>          <span class="st">"march_equinox_sunrise"</span>, <span class="st">"march_equinox_sunset"</span>,</span>
<span id="cb169-1488"><a href="#cb169-1488" aria-hidden="true" tabindex="-1"></a>          <span class="st">"march_equinox_daylight"</span>, <span class="st">"june_solstice_sunrise"</span>,</span>
<span id="cb169-1489"><a href="#cb169-1489" aria-hidden="true" tabindex="-1"></a>          <span class="st">"june_solstice_sunset"</span>, <span class="st">"june_solstice_daylight"</span>,</span>
<span id="cb169-1490"><a href="#cb169-1490" aria-hidden="true" tabindex="-1"></a>          <span class="st">"september_equinox_sunrise"</span>, <span class="st">"september_equinox_sunset"</span>,</span>
<span id="cb169-1491"><a href="#cb169-1491" aria-hidden="true" tabindex="-1"></a>          <span class="st">"september_equinox_daylight"</span>, <span class="st">"december_solstice_sunrise"</span>,</span>
<span id="cb169-1492"><a href="#cb169-1492" aria-hidden="true" tabindex="-1"></a>          <span class="st">"december_solstice_sunset"</span>, <span class="st">"december_solstice_daylight"</span></span>
<span id="cb169-1493"><a href="#cb169-1493" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb169-1494"><a href="#cb169-1494" aria-hidden="true" tabindex="-1"></a>        <span class="at">collapse =</span> <span class="st">" + "</span></span>
<span id="cb169-1495"><a href="#cb169-1495" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb169-1496"><a href="#cb169-1496" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-1497"><a href="#cb169-1497" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-1498"><a href="#cb169-1498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1499"><a href="#cb169-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1502"><a href="#cb169-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1503"><a href="#cb169-1503" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1504"><a href="#cb169-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1505"><a href="#cb169-1505" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(</span>
<span id="cb169-1506"><a href="#cb169-1506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb169-1507"><a href="#cb169-1507" aria-hidden="true" tabindex="-1"></a>      <span class="st">"msf_sc ~ "</span>,</span>
<span id="cb169-1508"><a href="#cb169-1508" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(</span>
<span id="cb169-1509"><a href="#cb169-1509" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb169-1510"><a href="#cb169-1510" aria-hidden="true" tabindex="-1"></a>          <span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"longitude"</span>, <span class="st">"ghi_month"</span>, </span>
<span id="cb169-1511"><a href="#cb169-1511" aria-hidden="true" tabindex="-1"></a>          <span class="st">"ghi_annual"</span>, <span class="st">"march_equinox_daylight"</span>, <span class="st">"june_solstice_daylight"</span>,</span>
<span id="cb169-1512"><a href="#cb169-1512" aria-hidden="true" tabindex="-1"></a>          <span class="st">"december_solstice_daylight"</span></span>
<span id="cb169-1513"><a href="#cb169-1513" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb169-1514"><a href="#cb169-1514" aria-hidden="true" tabindex="-1"></a>        <span class="at">collapse =</span> <span class="st">" + "</span></span>
<span id="cb169-1515"><a href="#cb169-1515" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb169-1516"><a href="#cb169-1516" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb169-1517"><a href="#cb169-1517" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-1518"><a href="#cb169-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1519"><a href="#cb169-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1522"><a href="#cb169-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1523"><a href="#cb169-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1524"><a href="#cb169-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1525"><a href="#cb169-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(form, <span class="at">data =</span> data, <span class="at">weights =</span> cell_weight)</span>
<span id="cb169-1526"><a href="#cb169-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1527"><a href="#cb169-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1530"><a href="#cb169-1530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1531"><a href="#cb169-1531" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1532"><a href="#cb169-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1533"><a href="#cb169-1533" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> </span>
<span id="cb169-1534"><a href="#cb169-1534" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-1535"><a href="#cb169-1535" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-1536"><a href="#cb169-1536" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb169-1537"><a href="#cb169-1537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1538"><a href="#cb169-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1541"><a href="#cb169-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1542"><a href="#cb169-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1543"><a href="#cb169-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1544"><a href="#cb169-1544" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> </span>
<span id="cb169-1545"><a href="#cb169-1545" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1546"><a href="#cb169-1546" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_case_weights</span>(cell_weight) <span class="sc">|&gt;</span></span>
<span id="cb169-1547"><a href="#cb169-1547" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_formula</span>(form) <span class="sc">|&gt;</span></span>
<span id="cb169-1548"><a href="#cb169-1548" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(model)</span>
<span id="cb169-1549"><a href="#cb169-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1550"><a href="#cb169-1550" aria-hidden="true" tabindex="-1"></a>workflow</span>
<span id="cb169-1551"><a href="#cb169-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1552"><a href="#cb169-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1555"><a href="#cb169-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1556"><a href="#cb169-1556" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1557"><a href="#cb169-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1558"><a href="#cb169-1558" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> workflow <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(data)</span>
<span id="cb169-1559"><a href="#cb169-1559" aria-hidden="true" tabindex="-1"></a>fit_full <span class="ot">&lt;-</span> fit</span>
<span id="cb169-1560"><a href="#cb169-1560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1561"><a href="#cb169-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1562"><a href="#cb169-1562" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-fit-1}</span>
<span id="cb169-1565"><a href="#cb169-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1566"><a href="#cb169-1566" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1567"><a href="#cb169-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1568"><a href="#cb169-1568" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb169-1569"><a href="#cb169-1569" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-1570"><a href="#cb169-1570" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb169-1571"><a href="#cb169-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1572"><a href="#cb169-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1573"><a href="#cb169-1573" aria-hidden="true" tabindex="-1"></a>Output from the model fitting process showing the estimated coefficients, standard errors, test statistics, and p-values for the terms in the linear regression model.</span>
<span id="cb169-1574"><a href="#cb169-1574" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1575"><a href="#cb169-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1578"><a href="#cb169-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1579"><a href="#cb169-1579" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1580"><a href="#cb169-1580" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1581"><a href="#cb169-1581" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1582"><a href="#cb169-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1583"><a href="#cb169-1583" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-1584"><a href="#cb169-1584" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1585"><a href="#cb169-1585" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">5</span>)</span>
<span id="cb169-1586"><a href="#cb169-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1587"><a href="#cb169-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1588"><a href="#cb169-1588" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-fit-2}</span>
<span id="cb169-1591"><a href="#cb169-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1592"><a href="#cb169-1592" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1593"><a href="#cb169-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1594"><a href="#cb169-1594" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-1595"><a href="#cb169-1595" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">glance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-1596"><a href="#cb169-1596" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb169-1597"><a href="#cb169-1597" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="dv">10</span>)</span>
<span id="cb169-1598"><a href="#cb169-1598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1599"><a href="#cb169-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1600"><a href="#cb169-1600" aria-hidden="true" tabindex="-1"></a>Summary of model fit statistics showing key metrics including R-squared, adjusted R-squared, sigma, statistic, p-value, degrees of freedom, log-likelihood, AIC, BIC, and deviance.</span>
<span id="cb169-1601"><a href="#cb169-1601" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1602"><a href="#cb169-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1605"><a href="#cb169-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1606"><a href="#cb169-1606" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1607"><a href="#cb169-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1608"><a href="#cb169-1608" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>()</span>
<span id="cb169-1609"><a href="#cb169-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1610"><a href="#cb169-1610" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb169-1611"><a href="#cb169-1611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1612"><a href="#cb169-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1615"><a href="#cb169-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1616"><a href="#cb169-1616" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1617"><a href="#cb169-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1618"><a href="#cb169-1618" aria-hidden="true" tabindex="-1"></a><span class="co"># A jerry-rigged solution to fix issues related to modeling using the pipe.</span></span>
<span id="cb169-1619"><a href="#cb169-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1620"><a href="#cb169-1620" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(form, <span class="at">data =</span> data, <span class="at">weights =</span> cell_weight)</span>
<span id="cb169-1621"><a href="#cb169-1621" aria-hidden="true" tabindex="-1"></a>fit_engine_full <span class="ot">&lt;-</span> fit_engine_2</span>
<span id="cb169-1622"><a href="#cb169-1622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1623"><a href="#cb169-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1626"><a href="#cb169-1626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1627"><a href="#cb169-1627" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1628"><a href="#cb169-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1629"><a href="#cb169-1629" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(fit_engine_2)</span>
<span id="cb169-1630"><a href="#cb169-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1631"><a href="#cb169-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1632"><a href="#cb169-1632" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluating the Model Fit</span></span>
<span id="cb169-1633"><a href="#cb169-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1634"><a href="#cb169-1634" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Predictions</span></span>
<span id="cb169-1635"><a href="#cb169-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1636"><a href="#cb169-1636" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-fit}</span>
<span id="cb169-1639"><a href="#cb169-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1640"><a href="#cb169-1640" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1641"><a href="#cb169-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1642"><a href="#cb169-1642" aria-hidden="true" tabindex="-1"></a>limits <span class="ot">&lt;-</span> </span>
<span id="cb169-1643"><a href="#cb169-1643" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(fit_engine, <span class="at">interval =</span> <span class="st">"prediction"</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-1644"><a href="#cb169-1644" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1645"><a href="#cb169-1645" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-1646"><a href="#cb169-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1647"><a href="#cb169-1647" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb169-1648"><a href="#cb169-1648" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1649"><a href="#cb169-1649" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(limits) <span class="sc">|&gt;</span></span>
<span id="cb169-1650"><a href="#cb169-1650" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(msf_sc, .pred)) <span class="sc">+</span></span>
<span id="cb169-1651"><a href="#cb169-1651" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ggplot2::geom_ribbon(</span></span>
<span id="cb169-1652"><a href="#cb169-1652" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mapping = ggplot2::aes(ymin = lwr, ymax = upr),</span></span>
<span id="cb169-1653"><a href="#cb169-1653" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   alpha = 0.2</span></span>
<span id="cb169-1654"><a href="#cb169-1654" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb169-1655"><a href="#cb169-1655" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_ribbon</span>(</span>
<span id="cb169-1656"><a href="#cb169-1656" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(</span>
<span id="cb169-1657"><a href="#cb169-1657" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(lwr <span class="sc">~</span> msf_sc)),</span>
<span id="cb169-1658"><a href="#cb169-1658" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> stats<span class="sc">::</span><span class="fu">predict</span>(stats<span class="sc">::</span><span class="fu">loess</span>(upr <span class="sc">~</span> msf_sc)),</span>
<span id="cb169-1659"><a href="#cb169-1659" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-1660"><a href="#cb169-1660" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb169-1661"><a href="#cb169-1661" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1662"><a href="#cb169-1662" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb169-1663"><a href="#cb169-1663" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> lwr),</span>
<span id="cb169-1664"><a href="#cb169-1664" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1665"><a href="#cb169-1665" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb169-1666"><a href="#cb169-1666" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb169-1667"><a href="#cb169-1667" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb169-1668"><a href="#cb169-1668" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb169-1669"><a href="#cb169-1669" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb169-1670"><a href="#cb169-1670" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1671"><a href="#cb169-1671" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(</span>
<span id="cb169-1672"><a href="#cb169-1672" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> upr),</span>
<span id="cb169-1673"><a href="#cb169-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1674"><a href="#cb169-1674" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"loess"</span>,</span>
<span id="cb169-1675"><a href="#cb169-1675" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb169-1676"><a href="#cb169-1676" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb169-1677"><a href="#cb169-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.2</span>,</span>
<span id="cb169-1678"><a href="#cb169-1678" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb169-1679"><a href="#cb169-1679" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1680"><a href="#cb169-1680" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-1681"><a href="#cb169-1681" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1682"><a href="#cb169-1682" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1683"><a href="#cb169-1683" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observed"</span>, </span>
<span id="cb169-1684"><a href="#cb169-1684" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predicted"</span></span>
<span id="cb169-1685"><a href="#cb169-1685" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1686"><a href="#cb169-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1687"><a href="#cb169-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1688"><a href="#cb169-1688" aria-hidden="true" tabindex="-1"></a>Relation between observed and predicted values. The red line is a 45-degree line originating from the plane's origin and represents a perfect fit. The shaded area depicts a smoothed version of the 95% confidence of the <span class="co">[</span><span class="ot">prediction interval</span><span class="co">](http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/)</span>.</span>
<span id="cb169-1689"><a href="#cb169-1689" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1690"><a href="#cb169-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1691"><a href="#cb169-1691" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Posterior Predictive Checks</span></span>
<span id="cb169-1692"><a href="#cb169-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1693"><a href="#cb169-1693" aria-hidden="true" tabindex="-1"></a>Posterior predictive checks are a Bayesian technique used to assess model fit by comparing observed data to data simulated from the <span class="co">[</span><span class="ot">posterior predictive distribution</span><span class="co">](https://en.wikipedia.org/wiki/Posterior_predictive_distribution)</span> (i.e., the distribution of potential unobserved values given the observed data). These checks help identify systematic discrepancies between the observed and simulated data, providing insight into whether the chosen model (or distributional family) is appropriate. Ideally, the model-predicted lines should closely match the observed data patterns.</span>
<span id="cb169-1694"><a href="#cb169-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1695"><a href="#cb169-1695" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-fit-comparison}</span>
<span id="cb169-1698"><a href="#cb169-1698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1699"><a href="#cb169-1699" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1700"><a href="#cb169-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1701"><a href="#cb169-1701" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-1702"><a href="#cb169-1702" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-1703"><a href="#cb169-1703" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb169-1704"><a href="#cb169-1704" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-1705"><a href="#cb169-1705" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb169-1706"><a href="#cb169-1706" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-1707"><a href="#cb169-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1708"><a href="#cb169-1708" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-1709"><a href="#cb169-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1710"><a href="#cb169-1710" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>PP_CHECK <span class="sc">+</span></span>
<span id="cb169-1711"><a href="#cb169-1711" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1712"><a href="#cb169-1712" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1713"><a href="#cb169-1713" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1714"><a href="#cb169-1714" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"MSFsc (Chronotype proxy) (s)"</span>,</span>
<span id="cb169-1715"><a href="#cb169-1715" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1716"><a href="#cb169-1716" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb169-1717"><a href="#cb169-1717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1718"><a href="#cb169-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1719"><a href="#cb169-1719" aria-hidden="true" tabindex="-1"></a>Posterior predictive checks for the model. The red line represents the observed data, while the black lines represent the model-predicted data.</span>
<span id="cb169-1720"><a href="#cb169-1720" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1721"><a href="#cb169-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1722"><a href="#cb169-1722" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conducting Model Diagnostics</span></span>
<span id="cb169-1723"><a href="#cb169-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1724"><a href="#cb169-1724" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb169-1725"><a href="#cb169-1725" aria-hidden="true" tabindex="-1"></a>It's important to note that objective assumption tests (e.g., Anderson–Darling test) is not advisable for larger samples, since they can be overly sensitive to minor deviations. Additionally, they might overlook visual patterns that are not captured by a single metric <span class="co">[</span><span class="ot">@shatz2024; @kozak2018; @schucany2006</span><span class="co">]</span>.</span>
<span id="cb169-1726"><a href="#cb169-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1727"><a href="#cb169-1727" aria-hidden="true" tabindex="-1"></a>I included those tests here **just for reference**. However, for the reason above, all assumptions were diagnosed by **visual assessment**.</span>
<span id="cb169-1728"><a href="#cb169-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1729"><a href="#cb169-1729" aria-hidden="true" tabindex="-1"></a>For a straightforward critique of normality tests specifically, refer to <span class="co">[</span><span class="ot">this</span><span class="co">](https://towardsdatascience.com/stop-testing-for-normality-dba96bb73f90)</span> article by @greener2020.</span>
<span id="cb169-1730"><a href="#cb169-1730" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1731"><a href="#cb169-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1732"><a href="#cb169-1732" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normality</span></span>
<span id="cb169-1733"><a href="#cb169-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1734"><a href="#cb169-1734" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-1735"><a href="#cb169-1735" aria-hidden="true" tabindex="-1"></a>Assumption 2</span>
<span id="cb169-1736"><a href="#cb169-1736" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Normality__. For $i = 1, \dots, n$, the conditional distribution of $Y_{i}$ given the vectors $z_{1}, \dots , z_{n}$ is a normal distribution <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-1737"><a href="#cb169-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1738"><a href="#cb169-1738" aria-hidden="true" tabindex="-1"></a>(Normality of the error term distribution <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-1739"><a href="#cb169-1739" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1740"><a href="#cb169-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1741"><a href="#cb169-1741" aria-hidden="true" tabindex="-1"></a>**Assumption 2** is satisfied, as the residuals shown a fairly normal distribution by visual inspection.</span>
<span id="cb169-1742"><a href="#cb169-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1743"><a href="#cb169-1743" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-1744"><a href="#cb169-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1745"><a href="#cb169-1745" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-residual-diag-normality-1}</span>
<span id="cb169-1748"><a href="#cb169-1748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1749"><a href="#cb169-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1750"><a href="#cb169-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1751"><a href="#cb169-1751" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-1752"><a href="#cb169-1752" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1753"><a href="#cb169-1753" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1754"><a href="#cb169-1754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">col =</span> <span class="st">"value"</span>, <span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-1755"><a href="#cb169-1755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1756"><a href="#cb169-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1757"><a href="#cb169-1757" aria-hidden="true" tabindex="-1"></a>Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution.</span>
<span id="cb169-1758"><a href="#cb169-1758" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1759"><a href="#cb169-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1760"><a href="#cb169-1760" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-residual-diag-normality-2}</span>
<span id="cb169-1763"><a href="#cb169-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1764"><a href="#cb169-1764" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1765"><a href="#cb169-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1766"><a href="#cb169-1766" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-1767"><a href="#cb169-1767" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1768"><a href="#cb169-1768" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb169-1769"><a href="#cb169-1769" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(.resid) <span class="sc">|&gt;</span></span>
<span id="cb169-1770"><a href="#cb169-1770" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb169-1771"><a href="#cb169-1771" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_boxplot</span>(</span>
<span id="cb169-1772"><a href="#cb169-1772" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"red"</span>, </span>
<span id="cb169-1773"><a href="#cb169-1773" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="dv">1</span>,</span>
<span id="cb169-1774"><a href="#cb169-1774" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.5</span></span>
<span id="cb169-1775"><a href="#cb169-1775" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1776"><a href="#cb169-1776" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Value"</span>) <span class="sc">+</span></span>
<span id="cb169-1777"><a href="#cb169-1777" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb169-1778"><a href="#cb169-1778" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-1779"><a href="#cb169-1779" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1780"><a href="#cb169-1780" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-1781"><a href="#cb169-1781" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb169-1782"><a href="#cb169-1782" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1783"><a href="#cb169-1783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1784"><a href="#cb169-1784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1785"><a href="#cb169-1785" aria-hidden="true" tabindex="-1"></a>Boxplot of model residuals with outliers highlighted in red.</span>
<span id="cb169-1786"><a href="#cb169-1786" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1787"><a href="#cb169-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1788"><a href="#cb169-1788" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-normality-1}</span>
<span id="cb169-1791"><a href="#cb169-1791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1792"><a href="#cb169-1792" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1793"><a href="#cb169-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1794"><a href="#cb169-1794" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-1795"><a href="#cb169-1795" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1796"><a href="#cb169-1796" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1797"><a href="#cb169-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_summary</span>(<span class="at">col =</span> <span class="st">"value"</span>, <span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-1798"><a href="#cb169-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1799"><a href="#cb169-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1800"><a href="#cb169-1800" aria-hidden="true" tabindex="-1"></a>Summary statistics of model residuals.</span>
<span id="cb169-1801"><a href="#cb169-1801" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1802"><a href="#cb169-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1803"><a href="#cb169-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Tests</span></span>
<span id="cb169-1804"><a href="#cb169-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1805"><a href="#cb169-1805" aria-hidden="true" tabindex="-1"></a>It's important to note that the Kolmogorov-Smirnov and Pearson chi-square tests are included here just for reference, as many authors don't recommend using them when testing for normality <span class="co">[</span><span class="ot">@dagostino1990</span><span class="co">]</span>. Learn more about normality tests in @thode2002.</span>
<span id="cb169-1806"><a href="#cb169-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1807"><a href="#cb169-1807" aria-hidden="true" tabindex="-1"></a>I also recommend checking the original papers for each test to understand their assumptions and limitations:</span>
<span id="cb169-1808"><a href="#cb169-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1809"><a href="#cb169-1809" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Anderson-Darling test</span><span class="co">](https://en.wikipedia.org/wiki/Anderson%E2%80%93Darling_test)</span>: @anderson1952; @anderson1954.</span>
<span id="cb169-1810"><a href="#cb169-1810" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bonett-Seier test: @bonett2002.</span>
<span id="cb169-1811"><a href="#cb169-1811" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Cramér-von Mises test</span><span class="co">](https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93von_Mises_criterion)</span>: @cramer1928; @anderson1962.</span>
<span id="cb169-1812"><a href="#cb169-1812" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">D'Agostino test</span><span class="co">](https://en.wikipedia.org/wiki/D%27Agostino%27s_K-squared_test)</span>: @dagostino1971; @dagostino1973.</span>
<span id="cb169-1813"><a href="#cb169-1813" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Jarque–Bera test</span><span class="co">](https://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test)</span>: @jarque1980; @bera1981; @jarque1987.</span>
<span id="cb169-1814"><a href="#cb169-1814" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Lilliefors (K-S) test</span><span class="co">](https://en.wikipedia.org/wiki/Lilliefors_test)</span>:  @smirnov1948; @kolmogorov1933; @massey1951; @lilliefors1967; @dallal1986.</span>
<span id="cb169-1815"><a href="#cb169-1815" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Pearson chi-square test</span><span class="co">](https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test)</span>: @pearson1900.</span>
<span id="cb169-1816"><a href="#cb169-1816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Francia test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Francia_test)</span>: @shapiro1972.</span>
<span id="cb169-1817"><a href="#cb169-1817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Shapiro-Wilk test</span><span class="co">](https://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)</span>: @shapiro1965.</span>
<span id="cb169-1818"><a href="#cb169-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1819"><a href="#cb169-1819" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1820"><a href="#cb169-1820" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-1821"><a href="#cb169-1821" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The data is normally distributed} <span class="sc">\\</span></span>
<span id="cb169-1822"><a href="#cb169-1822" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The data is not normally distributed}</span>
<span id="cb169-1823"><a href="#cb169-1823" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-1824"><a href="#cb169-1824" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1825"><a href="#cb169-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1826"><a href="#cb169-1826" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-normality-2}</span>
<span id="cb169-1829"><a href="#cb169-1829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1830"><a href="#cb169-1830" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1831"><a href="#cb169-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1832"><a href="#cb169-1832" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-1833"><a href="#cb169-1833" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1834"><a href="#cb169-1834" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1835"><a href="#cb169-1835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">normality_summary</span>(<span class="at">col =</span> <span class="st">"value"</span>)</span>
<span id="cb169-1836"><a href="#cb169-1836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1837"><a href="#cb169-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1838"><a href="#cb169-1838" aria-hidden="true" tabindex="-1"></a>Summary of statistical tests conducted to assess the normality of the residuals.</span>
<span id="cb169-1839"><a href="#cb169-1839" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1840"><a href="#cb169-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1841"><a href="#cb169-1841" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Linearity</span></span>
<span id="cb169-1842"><a href="#cb169-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1843"><a href="#cb169-1843" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-1844"><a href="#cb169-1844" aria-hidden="true" tabindex="-1"></a>Assumption 3</span>
<span id="cb169-1845"><a href="#cb169-1845" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Linear mean__. There is a vector of parameters  $\beta = (\beta_{0}, \dots, \beta_{p - 1})$ such that the conditional mean of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ has the form</span>
<span id="cb169-1846"><a href="#cb169-1846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1847"><a href="#cb169-1847" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1848"><a href="#cb169-1848" aria-hidden="true" tabindex="-1"></a>z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}</span>
<span id="cb169-1849"><a href="#cb169-1849" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1850"><a href="#cb169-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1851"><a href="#cb169-1851" aria-hidden="true" tabindex="-1"></a>for $i = 1, \dots, n$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-1852"><a href="#cb169-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1853"><a href="#cb169-1853" aria-hidden="true" tabindex="-1"></a>(Linearity of the phenomenon measured <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-1854"><a href="#cb169-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1855"><a href="#cb169-1855" aria-hidden="true" tabindex="-1"></a>It is important to clarify that the linear assumption pertains to **linearity in the parameters** or equivalently, linearity in the coefficients. This means that each predictor is multiplied by its corresponding regression coefficient. However, this does not imply that the relationship between the predictors and the response variable is linear. In fact, a linear model can still effectively capture non-linear relationships between predictors and the response variable by utilizing transformations of the predictors <span class="co">[</span><span class="ot">@cohen2002</span><span class="co">]</span>.</span>
<span id="cb169-1856"><a href="#cb169-1856" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1857"><a href="#cb169-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1858"><a href="#cb169-1858" aria-hidden="true" tabindex="-1"></a>**Assumption 3** is satisfied, as the relationship between the variables is fairly linear.</span>
<span id="cb169-1859"><a href="#cb169-1859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1860"><a href="#cb169-1860" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-residual-diag-fitted-values-1}</span>
<span id="cb169-1863"><a href="#cb169-1863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1864"><a href="#cb169-1864" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1865"><a href="#cb169-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1866"><a href="#cb169-1866" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-1867"><a href="#cb169-1867" aria-hidden="true" tabindex="-1"></a>  fit <span class="sc">|&gt;</span></span>
<span id="cb169-1868"><a href="#cb169-1868" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1869"><a href="#cb169-1869" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .resid)) <span class="sc">+</span></span>
<span id="cb169-1870"><a href="#cb169-1870" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-1871"><a href="#cb169-1871" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(</span>
<span id="cb169-1872"><a href="#cb169-1872" aria-hidden="true" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="dv">0</span>, </span>
<span id="cb169-1873"><a href="#cb169-1873" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb169-1874"><a href="#cb169-1874" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb169-1875"><a href="#cb169-1875" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span> </span>
<span id="cb169-1876"><a href="#cb169-1876" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-1877"><a href="#cb169-1877" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1878"><a href="#cb169-1878" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb169-1879"><a href="#cb169-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1880"><a href="#cb169-1880" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-1881"><a href="#cb169-1881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1882"><a href="#cb169-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1883"><a href="#cb169-1883" aria-hidden="true" tabindex="-1"></a>Residual plot showing the relationship between fitted values and residuals. The dashed black line represent zero residuals, indicating an ideal model fit. The red line indicate the conditional mean of residuals.</span>
<span id="cb169-1884"><a href="#cb169-1884" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1885"><a href="#cb169-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1886"><a href="#cb169-1886" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-residual-diag-linearity-1}</span>
<span id="cb169-1889"><a href="#cb169-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1890"><a href="#cb169-1890" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1891"><a href="#cb169-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1892"><a href="#cb169-1892" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_fit_spread</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-1893"><a href="#cb169-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1894"><a href="#cb169-1894" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(plots)) {</span>
<span id="cb169-1895"><a href="#cb169-1895" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> plots[[i]] <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-1896"><a href="#cb169-1896" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-1897"><a href="#cb169-1897" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-1898"><a href="#cb169-1898" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>data[[<span class="dv">1</span>]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb169-1899"><a href="#cb169-1899" aria-hidden="true" tabindex="-1"></a>  q<span class="sc">$</span>plot<span class="sc">$</span>layers[[<span class="dv">1</span>]]<span class="sc">$</span>constructor<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb169-1900"><a href="#cb169-1900" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-1901"><a href="#cb169-1901" aria-hidden="true" tabindex="-1"></a>  plots[[i]] <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-1902"><a href="#cb169-1902" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-1903"><a href="#cb169-1903" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb169-1904"><a href="#cb169-1904" aria-hidden="true" tabindex="-1"></a>patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plots<span class="sc">$</span>fm_plot, plots<span class="sc">$</span>rsd_plot, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb169-1905"><a href="#cb169-1905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1906"><a href="#cb169-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1907"><a href="#cb169-1907" aria-hidden="true" tabindex="-1"></a>Residual fit spread plots to detect non-linearity, influential observations, and outliers. The side-by-side plots show the centered fit and residuals, illustrating the variation explained by the model and what remains in the residuals. Inappropriately specified models often exhibit greater spread in the residuals than in the centered fit. "Proportion Less" indicates the cumulative distribution function, representing the proportion of observations below a specific value, facilitating an assessment of model performance.</span>
<span id="cb169-1908"><a href="#cb169-1908" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1909"><a href="#cb169-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1910"><a href="#cb169-1910" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Ramsey's RESET test</span><span class="co">](https://en.wikipedia.org/wiki/Ramsey_RESET_test)</span> indicates that the model has no omitted variables. This test examines whether non-linear combinations of the fitted values can explain the response variable.</span>
<span id="cb169-1911"><a href="#cb169-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1912"><a href="#cb169-1912" aria-hidden="true" tabindex="-1"></a>Learn more about the Ramsey's RESET test in: @ramsey1969.</span>
<span id="cb169-1913"><a href="#cb169-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1914"><a href="#cb169-1914" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1915"><a href="#cb169-1915" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-1916"><a href="#cb169-1916" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The model has no omitted variables} <span class="sc">\\</span></span>
<span id="cb169-1917"><a href="#cb169-1917" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The model has omitted variables}</span>
<span id="cb169-1918"><a href="#cb169-1918" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-1919"><a href="#cb169-1919" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-1920"><a href="#cb169-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1923"><a href="#cb169-1923" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1924"><a href="#cb169-1924" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1925"><a href="#cb169-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1926"><a href="#cb169-1926" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">power =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb169-1927"><a href="#cb169-1927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1928"><a href="#cb169-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1931"><a href="#cb169-1931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1932"><a href="#cb169-1932" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-1933"><a href="#cb169-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1934"><a href="#cb169-1934" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">resettest</span>(<span class="at">type =</span> <span class="st">"regressor"</span>)</span>
<span id="cb169-1935"><a href="#cb169-1935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1936"><a href="#cb169-1936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1937"><a href="#cb169-1937" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Homoscedasticity (Common Variance)</span></span>
<span id="cb169-1938"><a href="#cb169-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1939"><a href="#cb169-1939" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-1940"><a href="#cb169-1940" aria-hidden="true" tabindex="-1"></a>Assumption 4</span>
<span id="cb169-1941"><a href="#cb169-1941" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Common variance__ (homoscedasticity). There is as parameter $\sigma^{2}$ such the conditional variance of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ is $\sigma^{2}$ for $i = 1, \dots, n$.</span>
<span id="cb169-1942"><a href="#cb169-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1943"><a href="#cb169-1943" aria-hidden="true" tabindex="-1"></a>(Constant variance of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-1944"><a href="#cb169-1944" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1945"><a href="#cb169-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1946"><a href="#cb169-1946" aria-hidden="true" tabindex="-1"></a>**Assumption 4** is satisfied. When comparing the standardized residuals ($\sqrt{|\text{Standardized Residuals}|}$) spread to the fitted values, we can observe that the residuals are fairly constant across the range of values. This suggests that the residuals have a constant variance.</span>
<span id="cb169-1947"><a href="#cb169-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1948"><a href="#cb169-1948" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-1949"><a href="#cb169-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1952"><a href="#cb169-1952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1953"><a href="#cb169-1953" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1954"><a href="#cb169-1954" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1955"><a href="#cb169-1955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1956"><a href="#cb169-1956" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on:</span></span>
<span id="cb169-1957"><a href="#cb169-1957" aria-hidden="true" tabindex="-1"></a><span class="co"># https://sscc.wisc.edu/sscc/pubs/RegDiag-R/homoscedasticity.html#:~:text=We%20must%20plot%20the%20residuals%20against%20the%20fitted%20values%20and%20against%20each%20of%20the%20predictors.</span></span>
<span id="cb169-1958"><a href="#cb169-1958" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1959"><a href="#cb169-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1960"><a href="#cb169-1960" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-homoscedasticity-1}</span>
<span id="cb169-1963"><a href="#cb169-1963" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1964"><a href="#cb169-1964" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-1965"><a href="#cb169-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1966"><a href="#cb169-1966" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span></span>
<span id="cb169-1967"><a href="#cb169-1967" aria-hidden="true" tabindex="-1"></a>  fit <span class="sc">|&gt;</span></span>
<span id="cb169-1968"><a href="#cb169-1968" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-1969"><a href="#cb169-1969" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-1970"><a href="#cb169-1970" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb169-1971"><a href="#cb169-1971" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-1972"><a href="#cb169-1972" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-1973"><a href="#cb169-1973" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-1974"><a href="#cb169-1974" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb169-1975"><a href="#cb169-1975" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-1976"><a href="#cb169-1976" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .sd_resid)) <span class="sc">+</span></span>
<span id="cb169-1977"><a href="#cb169-1977" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-1978"><a href="#cb169-1978" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-1979"><a href="#cb169-1979" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-1980"><a href="#cb169-1980" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fitted values"</span>, </span>
<span id="cb169-1981"><a href="#cb169-1981" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{|Standardized </span><span class="sc">\\</span><span class="st"> Residuals|}$"</span>)</span>
<span id="cb169-1982"><a href="#cb169-1982" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-1983"><a href="#cb169-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1984"><a href="#cb169-1984" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> <span class="fu">print</span>() <span class="sc">|&gt;</span> rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-1985"><a href="#cb169-1985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-1986"><a href="#cb169-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1987"><a href="#cb169-1987" aria-hidden="true" tabindex="-1"></a>Relation between the fitted values of the model and its standardized residuals.</span>
<span id="cb169-1988"><a href="#cb169-1988" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-1989"><a href="#cb169-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1992"><a href="#cb169-1992" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-1993"><a href="#cb169-1993" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-1994"><a href="#cb169-1994" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-1995"><a href="#cb169-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-1996"><a href="#cb169-1996" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb169-1997"><a href="#cb169-1997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel_tabset_var_homoscedasticity</span>(</span>
<span id="cb169-1998"><a href="#cb169-1998" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_name =</span> <span class="st">"data"</span>,</span>
<span id="cb169-1999"><a href="#cb169-1999" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> fit,</span>
<span id="cb169-2000"><a href="#cb169-2000" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(</span>
<span id="cb169-2001"><a href="#cb169-2001" aria-hidden="true" tabindex="-1"></a>      <span class="st">"msf_sc"</span>,</span>
<span id="cb169-2002"><a href="#cb169-2002" aria-hidden="true" tabindex="-1"></a>      fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2003"><a href="#cb169-2003" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">coef</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-2004"><a href="#cb169-2004" aria-hidden="true" tabindex="-1"></a>      <span class="fu">names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb169-2005"><a href="#cb169-2005" aria-hidden="true" tabindex="-1"></a>      magrittr<span class="sc">::</span><span class="fu">extract</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-2006"><a href="#cb169-2006" aria-hidden="true" tabindex="-1"></a>      stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="st">"^sex"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-2007"><a href="#cb169-2007" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-2008"><a href="#cb169-2008" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_labels =</span> <span class="fu">c</span>(</span>
<span id="cb169-2009"><a href="#cb169-2009" aria-hidden="true" tabindex="-1"></a>      <span class="st">"MSF~sc~ (Chronotype proxy) (seconds)"</span>,</span>
<span id="cb169-2010"><a href="#cb169-2010" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Age (years)"</span>,</span>
<span id="cb169-2011"><a href="#cb169-2011" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Longitude (decimal degrees)"</span>,</span>
<span id="cb169-2012"><a href="#cb169-2012" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Monthly average global horizontal irradiance (Wh/m²)"</span>,</span>
<span id="cb169-2013"><a href="#cb169-2013" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Annual average global horizontal irradiance (Wh/m²)"</span>,</span>
<span id="cb169-2014"><a href="#cb169-2014" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the March equinox (seconds)"</span>,</span>
<span id="cb169-2015"><a href="#cb169-2015" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the June solstice (seconds)"</span>,</span>
<span id="cb169-2016"><a href="#cb169-2016" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Daylight on the December solstice (seconds)"</span></span>
<span id="cb169-2017"><a href="#cb169-2017" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb169-2018"><a href="#cb169-2018" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading =</span> <span class="st">"######"</span>,</span>
<span id="cb169-2019"><a href="#cb169-2019" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"sm-5-full-model"</span></span>
<span id="cb169-2020"><a href="#cb169-2020" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2021"><a href="#cb169-2021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2022"><a href="#cb169-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2023"><a href="#cb169-2023" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../qmd/_panel-tabset-var-homoscedasticity-sm-5-full-model.qmd &gt;}}</span>
<span id="cb169-2024"><a href="#cb169-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2025"><a href="#cb169-2025" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Breusch-Pagan Test</span></span>
<span id="cb169-2026"><a href="#cb169-2026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2027"><a href="#cb169-2027" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Breusch-Pagan test</span><span class="co">](https://en.wikipedia.org/wiki/Breusch%E2%80%93Pagan_test)</span> test indicates that the residuals exhibit constant variance.</span>
<span id="cb169-2028"><a href="#cb169-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2029"><a href="#cb169-2029" aria-hidden="true" tabindex="-1"></a>Learn more about the Breusch-Pagan test in: @breusch1979 and @koenker1981.</span>
<span id="cb169-2030"><a href="#cb169-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2031"><a href="#cb169-2031" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2032"><a href="#cb169-2032" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-2033"><a href="#cb169-2033" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{The variance is constant} <span class="sc">\\</span></span>
<span id="cb169-2034"><a href="#cb169-2034" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{The variance is not constant}</span>
<span id="cb169-2035"><a href="#cb169-2035" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-2036"><a href="#cb169-2036" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2037"><a href="#cb169-2037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2040"><a href="#cb169-2040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2041"><a href="#cb169-2041" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2042"><a href="#cb169-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2043"><a href="#cb169-2043" aria-hidden="true" tabindex="-1"></a><span class="co"># With studentising modification of Koenker</span></span>
<span id="cb169-2044"><a href="#cb169-2044" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-2045"><a href="#cb169-2045" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2046"><a href="#cb169-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2049"><a href="#cb169-2049" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2050"><a href="#cb169-2050" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2051"><a href="#cb169-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2052"><a href="#cb169-2052" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> lmtest<span class="sc">::</span><span class="fu">bptest</span>(<span class="at">studentize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2053"><a href="#cb169-2053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2054"><a href="#cb169-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2057"><a href="#cb169-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2058"><a href="#cb169-2058" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the studentized modification of Koenker.</span></span>
<span id="cb169-2059"><a href="#cb169-2059" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-2060"><a href="#cb169-2060" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2061"><a href="#cb169-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2064"><a href="#cb169-2064" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2065"><a href="#cb169-2065" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> skedastic<span class="sc">::</span><span class="fu">breusch_pagan</span>(<span class="at">koenker =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2066"><a href="#cb169-2066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2067"><a href="#cb169-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2070"><a href="#cb169-2070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2071"><a href="#cb169-2071" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2072"><a href="#cb169-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2073"><a href="#cb169-2073" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> car<span class="sc">::</span><span class="fu">ncvTest</span>()</span>
<span id="cb169-2074"><a href="#cb169-2074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2075"><a href="#cb169-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2078"><a href="#cb169-2078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2079"><a href="#cb169-2079" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2080"><a href="#cb169-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2081"><a href="#cb169-2081" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_breusch_pagan</span>()</span>
<span id="cb169-2082"><a href="#cb169-2082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2083"><a href="#cb169-2083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2084"><a href="#cb169-2084" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Independence</span></span>
<span id="cb169-2085"><a href="#cb169-2085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2086"><a href="#cb169-2086" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-2087"><a href="#cb169-2087" aria-hidden="true" tabindex="-1"></a>Assumption 5</span>
<span id="cb169-2088"><a href="#cb169-2088" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Independence__. The random variables $Y_{1}, \dots , Y_{n}$ are independent given the observed $z_{1}, \dots , z_{n}$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb169-2089"><a href="#cb169-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2090"><a href="#cb169-2090" aria-hidden="true" tabindex="-1"></a>(Independence of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb169-2091"><a href="#cb169-2091" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2092"><a href="#cb169-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2093"><a href="#cb169-2093" aria-hidden="true" tabindex="-1"></a>**Assumption 5** is satisfied. Although the residuals show some autocorrelation, they fall within the acceptable range of the Durbin–Watson statistic ($1.5$ to $2.5$). It's also important to note that the observations for each predicted value are not related to any other prediction; in other words, they are not grouped or sequenced by any variable (by design) (see @hair2019<span class="co">[</span><span class="ot">p. 291</span><span class="co">]</span> for more information).</span>
<span id="cb169-2094"><a href="#cb169-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2095"><a href="#cb169-2095" aria-hidden="true" tabindex="-1"></a>Many authors don't consider autocorrelation tests for linear regression models, as they are more relevant for time series data. However, I include them here just for reference.</span>
<span id="cb169-2096"><a href="#cb169-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2097"><a href="#cb169-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Visual Inspection</span></span>
<span id="cb169-2098"><a href="#cb169-2098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2099"><a href="#cb169-2099" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-independence-1}</span>
<span id="cb169-2102"><a href="#cb169-2102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2103"><a href="#cb169-2103" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2104"><a href="#cb169-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2105"><a href="#cb169-2105" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2106"><a href="#cb169-2106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-2107"><a href="#cb169-2107" aria-hidden="true" tabindex="-1"></a>  forecast<span class="sc">::</span><span class="fu">ggtsdisplay</span>(<span class="at">lag.max=</span><span class="dv">30</span>)</span>
<span id="cb169-2108"><a href="#cb169-2108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2109"><a href="#cb169-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2110"><a href="#cb169-2110" aria-hidden="true" tabindex="-1"></a>Time series plot of the residuals along with its AutoCorrelation Function (ACF) and Partial AutoCorrelation Function (PACF).</span>
<span id="cb169-2111"><a href="#cb169-2111" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2112"><a href="#cb169-2112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2113"><a href="#cb169-2113" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Correlations</span></span>
<span id="cb169-2114"><a href="#cb169-2114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2115"><a href="#cb169-2115" aria-hidden="true" tabindex="-1"></a>@tbl-model-residual-diag-independence-1 shows the relative importance of independent variables in determining the response variable. It highlights how much each variable uniquely contributes to the R-squared value, beyond what is explained by the other predictors.</span>
<span id="cb169-2116"><a href="#cb169-2116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2117"><a href="#cb169-2117" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-independence-1}</span>
<span id="cb169-2120"><a href="#cb169-2120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2121"><a href="#cb169-2121" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2122"><a href="#cb169-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2123"><a href="#cb169-2123" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_correlations</span>()</span>
<span id="cb169-2124"><a href="#cb169-2124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2125"><a href="#cb169-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2126"><a href="#cb169-2126" aria-hidden="true" tabindex="-1"></a>Correlations between the dependent variable and the independent variables, along with the zero-order, part, and partial correlations. The zero-order correlation represents the Pearson correlation coefficient between the dependent and independent variables. Part correlations indicate how much the R-squared would decrease if a specific variable were removed from the model, while partial correlations reflect the portion of variance in the response variable that is explained by a specific independent variable, beyond the influence of other predictors in the model.</span>
<span id="cb169-2127"><a href="#cb169-2127" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2128"><a href="#cb169-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2129"><a href="#cb169-2129" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Newey-West Estimator</span></span>
<span id="cb169-2130"><a href="#cb169-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2131"><a href="#cb169-2131" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Newey-West estimator</span><span class="co">](https://en.wikipedia.org/wiki/Newey%E2%80%93West_estimator)</span> is a method used to estimate the <span class="co">[</span><span class="ot">covariance matrix</span><span class="co">](https://en.wikipedia.org/wiki/Covariance_matrix)</span> of the coefficients in a regression model when the residuals are autocorrelated.</span>
<span id="cb169-2132"><a href="#cb169-2132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2133"><a href="#cb169-2133" aria-hidden="true" tabindex="-1"></a>Learn more about the Newey-West estimator in: @newey1987 and @newey1994.</span>
<span id="cb169-2134"><a href="#cb169-2134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2137"><a href="#cb169-2137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2138"><a href="#cb169-2138" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2139"><a href="#cb169-2139" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2140"><a href="#cb169-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2141"><a href="#cb169-2141" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> sandwich<span class="sc">::</span><span class="fu">NeweyWest</span>()</span>
<span id="cb169-2142"><a href="#cb169-2142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2143"><a href="#cb169-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2144"><a href="#cb169-2144" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Durbin-Watson Test</span></span>
<span id="cb169-2145"><a href="#cb169-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2146"><a href="#cb169-2146" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Durbin-Watson test</span><span class="co">](https://en.wikipedia.org/wiki/Durbin%E2%80%93Watson_statistic)</span> is a statistical test used to detect the presence of autocorrelation at lag $1$ in the residuals from a regression analysis. The test statistic ranges from $0$ to $4$, with a value of $2$ indicating no autocorrelation. Values less than $2$ indicate positive autocorrelation, while values greater than $2$ indicate negative autocorrelation <span class="co">[</span><span class="ot">@fox2016</span><span class="co">]</span>.</span>
<span id="cb169-2147"><a href="#cb169-2147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2148"><a href="#cb169-2148" aria-hidden="true" tabindex="-1"></a>A common rule of thumb in the statistical community is that a Durbin-Watson statistic between $1.5$ and $2.5$ suggests little to no autocorrelation.</span>
<span id="cb169-2149"><a href="#cb169-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2150"><a href="#cb169-2150" aria-hidden="true" tabindex="-1"></a>Learn more about the Durbin-Watson test in: @durbin1950; @durbin1951; and @durbin1971.</span>
<span id="cb169-2151"><a href="#cb169-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2152"><a href="#cb169-2152" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2153"><a href="#cb169-2153" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-2154"><a href="#cb169-2154" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Autocorrelation of the disturbances is 0} <span class="sc">\\</span></span>
<span id="cb169-2155"><a href="#cb169-2155" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Autocorrelation of the disturbances is not equal to 0}</span>
<span id="cb169-2156"><a href="#cb169-2156" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-2157"><a href="#cb169-2157" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2158"><a href="#cb169-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2161"><a href="#cb169-2161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2162"><a href="#cb169-2162" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2163"><a href="#cb169-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2164"><a href="#cb169-2164" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">durbinWatsonTest</span>(fit_engine)</span>
<span id="cb169-2165"><a href="#cb169-2165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2166"><a href="#cb169-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2167"><a href="#cb169-2167" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Ljung-Box Test</span></span>
<span id="cb169-2168"><a href="#cb169-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2169"><a href="#cb169-2169" aria-hidden="true" tabindex="-1"></a>The Ljung–Box test is a statistical test used to determine whether any autocorrelations within a time series are significantly different from zero. Rather than testing randomness at individual lags, it assesses the "overall" randomness across multiple lags.</span>
<span id="cb169-2170"><a href="#cb169-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2171"><a href="#cb169-2171" aria-hidden="true" tabindex="-1"></a>Learn more about the <span class="co">[</span><span class="ot">Ljung-Box test</span><span class="co">](https://en.wikipedia.org/wiki/Ljung%E2%80%93Box_test)</span> in: @box1970 and @ljung1978.</span>
<span id="cb169-2172"><a href="#cb169-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2173"><a href="#cb169-2173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2174"><a href="#cb169-2174" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-2175"><a href="#cb169-2175" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Residuals are independently distributed} <span class="sc">\\</span></span>
<span id="cb169-2176"><a href="#cb169-2176" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Residuals are not independently distributed}</span>
<span id="cb169-2177"><a href="#cb169-2177" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-2178"><a href="#cb169-2178" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2179"><a href="#cb169-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2182"><a href="#cb169-2182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2183"><a href="#cb169-2183" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2184"><a href="#cb169-2184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2185"><a href="#cb169-2185" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-2186"><a href="#cb169-2186" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-2187"><a href="#cb169-2187" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">Box.test</span>(<span class="at">type =</span> <span class="st">"Ljung-Box"</span>, <span class="at">lag =</span> <span class="dv">10</span>)</span>
<span id="cb169-2188"><a href="#cb169-2188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2189"><a href="#cb169-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2190"><a href="#cb169-2190" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Colinearity/Multicollinearity</span></span>
<span id="cb169-2191"><a href="#cb169-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2192"><a href="#cb169-2192" aria-hidden="true" tabindex="-1"></a>Daylight duration for the March equinox, June solstice, and December solstice exhibited high multicollinearity, with a variance inflation factor (VIF) greater than $1000$. However, since these variables are grouped as latitude proxies, this does not significantly impact the analysis. The primary focus is on the combined effect of the group, rather than the individual contributions of each variable.</span>
<span id="cb169-2193"><a href="#cb169-2193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2194"><a href="#cb169-2194" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variance Inflation Factor (VIF)</span></span>
<span id="cb169-2195"><a href="#cb169-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2196"><a href="#cb169-2196" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Variance Inflation Factor (VIF)</span><span class="co">](https://en.wikipedia.org/wiki/Variance_inflation_factor)</span> indicates the effect of other independent variables on the standard error of a regression coefficient. The VIF is directly related to the tolerance value ($\text{VIF}_{i} = 1/\text{TO}L$). High VIF values (larger than ~5 <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>) suggest significant collinearity or multicollinearity among the independent variables <span class="co">[</span><span class="ot">@hair2019, p. 265</span><span class="co">]</span>.</span>
<span id="cb169-2197"><a href="#cb169-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2198"><a href="#cb169-2198" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-diag-colinearity-1}</span>
<span id="cb169-2201"><a href="#cb169-2201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2202"><a href="#cb169-2202" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2203"><a href="#cb169-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2204"><a href="#cb169-2204" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-2205"><a href="#cb169-2205" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-2206"><a href="#cb169-2206" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(<span class="at">panel =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-2207"><a href="#cb169-2207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-2208"><a href="#cb169-2208" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-2209"><a href="#cb169-2209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2210"><a href="#cb169-2210" aria-hidden="true" tabindex="-1"></a>diag_sum_plots<span class="sc">$</span>VIF <span class="sc">+</span> </span>
<span id="cb169-2211"><a href="#cb169-2211" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2212"><a href="#cb169-2212" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-2213"><a href="#cb169-2213" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb169-2214"><a href="#cb169-2214" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2215"><a href="#cb169-2215" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-2216"><a href="#cb169-2216" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb169-2217"><a href="#cb169-2217" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-2218"><a href="#cb169-2218" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-2219"><a href="#cb169-2219" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb169-2220"><a href="#cb169-2220" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>)</span>
<span id="cb169-2221"><a href="#cb169-2221" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2222"><a href="#cb169-2222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2223"><a href="#cb169-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2224"><a href="#cb169-2224" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) for each predictor variable. VIFs below 5 are considered acceptable. Between 5 and 10, the variable should be examined. Above 10, the variable must considered highly collinear.</span>
<span id="cb169-2225"><a href="#cb169-2225" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2226"><a href="#cb169-2226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2227"><a href="#cb169-2227" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-colinearity-1}</span>
<span id="cb169-2230"><a href="#cb169-2230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2231"><a href="#cb169-2231" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2232"><a href="#cb169-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2233"><a href="#cb169-2233" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_vif_tol</span>()</span>
<span id="cb169-2234"><a href="#cb169-2234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2235"><a href="#cb169-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2236"><a href="#cb169-2236" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) and tolerance values for each predictor variable.</span>
<span id="cb169-2237"><a href="#cb169-2237" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2238"><a href="#cb169-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2239"><a href="#cb169-2239" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-colinearity-2}</span>
<span id="cb169-2242"><a href="#cb169-2242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2243"><a href="#cb169-2243" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2244"><a href="#cb169-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2245"><a href="#cb169-2245" aria-hidden="true" tabindex="-1"></a>fit_engine_2 <span class="sc">|&gt;</span> performance<span class="sc">::</span><span class="fu">check_collinearity</span>()</span>
<span id="cb169-2246"><a href="#cb169-2246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2247"><a href="#cb169-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2248"><a href="#cb169-2248" aria-hidden="true" tabindex="-1"></a>Variance Inflation Factors (VIF) and tolerance values for each predictor variable.</span>
<span id="cb169-2249"><a href="#cb169-2249" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2250"><a href="#cb169-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2251"><a href="#cb169-2251" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Condition Index</span></span>
<span id="cb169-2252"><a href="#cb169-2252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2253"><a href="#cb169-2253" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">condition index</span><span class="co">](https://en.wikipedia.org/wiki/Condition_number)</span> is a measure of multicollinearity in a regression model. It is based on the <span class="co">[</span><span class="ot">eigenvalues</span><span class="co">](https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors)</span> of the correlation matrix of the predictors. A condition index of 30 or higher is generally considered indicative of significant collinearity <span class="co">[</span><span class="ot">@belsley2004, p. 112-114</span><span class="co">]</span>.</span>
<span id="cb169-2254"><a href="#cb169-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2255"><a href="#cb169-2255" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-full-model-residual-diag-colinearity-2}</span>
<span id="cb169-2258"><a href="#cb169-2258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2259"><a href="#cb169-2259" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2260"><a href="#cb169-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2261"><a href="#cb169-2261" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_eigen_cindex</span>()</span>
<span id="cb169-2262"><a href="#cb169-2262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2263"><a href="#cb169-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2264"><a href="#cb169-2264" aria-hidden="true" tabindex="-1"></a>Condition indexes and eigenvalues for each predictor variable.</span>
<span id="cb169-2265"><a href="#cb169-2265" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2266"><a href="#cb169-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2267"><a href="#cb169-2267" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Measures of Influence</span></span>
<span id="cb169-2268"><a href="#cb169-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2269"><a href="#cb169-2269" aria-hidden="true" tabindex="-1"></a>In this section, I check several measures of influence that can be used to assess the impact of individual observations on the model estimates.</span>
<span id="cb169-2270"><a href="#cb169-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2271"><a href="#cb169-2271" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-2272"><a href="#cb169-2272" aria-hidden="true" tabindex="-1"></a>Leverage points</span>
<span id="cb169-2273"><a href="#cb169-2273" aria-hidden="true" tabindex="-1"></a>: Leverage is a measure of the distance between individual values of a predictor and other values of the predictor. In other words, a point with high leverage has an x-value far away from the other x-values. Points with high leverage have the potential to influence the model estimates <span class="co">[</span><span class="ot">@struck2024; @hair2019, p. 262; @nahhas2024</span><span class="co">]</span>.</span>
<span id="cb169-2274"><a href="#cb169-2274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2275"><a href="#cb169-2275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2276"><a href="#cb169-2276" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb169-2277"><a href="#cb169-2277" aria-hidden="true" tabindex="-1"></a>Influence points</span>
<span id="cb169-2278"><a href="#cb169-2278" aria-hidden="true" tabindex="-1"></a>: Influence is a measure of how much an observation affects the model estimates. If an observation with large influence were removed from the dataset, we would expect a large change in the predictive equation <span class="co">[</span><span class="ot">@struck2024; @nahhas2024</span><span class="co">]</span>.</span>
<span id="cb169-2279"><a href="#cb169-2279" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2280"><a href="#cb169-2280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2281"><a href="#cb169-2281" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Standardized Residuals</span></span>
<span id="cb169-2282"><a href="#cb169-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2283"><a href="#cb169-2283" aria-hidden="true" tabindex="-1"></a>Standardized residuals are a rescaling of the residual to a common basis by dividing each residual by the standard deviation of the residuals <span class="co">[</span><span class="ot">@hair2019, p. 264</span><span class="co">]</span>.</span>
<span id="cb169-2284"><a href="#cb169-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2287"><a href="#cb169-2287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2288"><a href="#cb169-2288" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2289"><a href="#cb169-2289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2290"><a href="#cb169-2290" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstandard</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2291"><a href="#cb169-2291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2292"><a href="#cb169-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2293"><a href="#cb169-2293" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-1}</span>
<span id="cb169-2296"><a href="#cb169-2296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2297"><a href="#cb169-2297" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2298"><a href="#cb169-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2299"><a href="#cb169-2299" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-2300"><a href="#cb169-2300" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-2301"><a href="#cb169-2301" aria-hidden="true" tabindex="-1"></a>  <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstandard</span>(fit_engine)</span>
<span id="cb169-2302"><a href="#cb169-2302" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-2303"><a href="#cb169-2303" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-2304"><a href="#cb169-2304" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> std, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> std)</span>
<span id="cb169-2305"><a href="#cb169-2305" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2306"><a href="#cb169-2306" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-2307"><a href="#cb169-2307" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2308"><a href="#cb169-2308" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2309"><a href="#cb169-2309" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2310"><a href="#cb169-2310" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2311"><a href="#cb169-2311" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-2312"><a href="#cb169-2312" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2313"><a href="#cb169-2313" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-2314"><a href="#cb169-2314" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Standardized residual"</span></span>
<span id="cb169-2315"><a href="#cb169-2315" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2316"><a href="#cb169-2316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2317"><a href="#cb169-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2318"><a href="#cb169-2318" aria-hidden="true" tabindex="-1"></a>Standardized residuals for each observation.</span>
<span id="cb169-2319"><a href="#cb169-2319" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2320"><a href="#cb169-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2323"><a href="#cb169-2323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2324"><a href="#cb169-2324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2325"><a href="#cb169-2325" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2326"><a href="#cb169-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2327"><a href="#cb169-2327" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stand</span>()</span>
<span id="cb169-2328"><a href="#cb169-2328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2329"><a href="#cb169-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2330"><a href="#cb169-2330" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Studentized Residuals</span></span>
<span id="cb169-2331"><a href="#cb169-2331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2332"><a href="#cb169-2332" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Studentized residuals</span><span class="co">](https://en.wikipedia.org/wiki/Studentized_residual)</span> are a commonly used variant of the standardized residual. It differs from other methods in how it calculates the standard deviation used in standardization. To minimize the effect of any observation on the standardization process, the standard deviation of the residual for observation $i$ is computed from regression estimates omitting the $i$th observation in the calculation of the regression estimates <span class="co">[</span><span class="ot">@hair2019, p. 264</span><span class="co">]</span>.</span>
<span id="cb169-2333"><a href="#cb169-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2336"><a href="#cb169-2336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2337"><a href="#cb169-2337" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2338"><a href="#cb169-2338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2339"><a href="#cb169-2339" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">rstudent</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2340"><a href="#cb169-2340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2341"><a href="#cb169-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2342"><a href="#cb169-2342" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-2}</span>
<span id="cb169-2345"><a href="#cb169-2345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2346"><a href="#cb169-2346" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2347"><a href="#cb169-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2348"><a href="#cb169-2348" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-2349"><a href="#cb169-2349" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-2350"><a href="#cb169-2350" aria-hidden="true" tabindex="-1"></a>  <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstudent</span>(fit_engine)</span>
<span id="cb169-2351"><a href="#cb169-2351" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-2352"><a href="#cb169-2352" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-2353"><a href="#cb169-2353" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> std, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> std)</span>
<span id="cb169-2354"><a href="#cb169-2354" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2355"><a href="#cb169-2355" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-2356"><a href="#cb169-2356" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2357"><a href="#cb169-2357" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2358"><a href="#cb169-2358" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2359"><a href="#cb169-2359" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2360"><a href="#cb169-2360" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-2361"><a href="#cb169-2361" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2362"><a href="#cb169-2362" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-2363"><a href="#cb169-2363" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-2364"><a href="#cb169-2364" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2365"><a href="#cb169-2365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2366"><a href="#cb169-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2367"><a href="#cb169-2367" aria-hidden="true" tabindex="-1"></a>Studentized residuals for each observation.</span>
<span id="cb169-2368"><a href="#cb169-2368" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2369"><a href="#cb169-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2370"><a href="#cb169-2370" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-3}</span>
<span id="cb169-2373"><a href="#cb169-2373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2374"><a href="#cb169-2374" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2375"><a href="#cb169-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2376"><a href="#cb169-2376" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb169-2377"><a href="#cb169-2377" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb169-2378"><a href="#cb169-2378" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb169-2379"><a href="#cb169-2379" aria-hidden="true" tabindex="-1"></a>    <span class="at">std =</span> stats<span class="sc">::</span><span class="fu">rstudent</span>(fit_engine)</span>
<span id="cb169-2380"><a href="#cb169-2380" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-2381"><a href="#cb169-2381" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, std)) <span class="sc">+</span></span>
<span id="cb169-2382"><a href="#cb169-2382" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-2383"><a href="#cb169-2383" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2384"><a href="#cb169-2384" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb169-2385"><a href="#cb169-2385" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2386"><a href="#cb169-2386" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-2387"><a href="#cb169-2387" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb169-2388"><a href="#cb169-2388" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2389"><a href="#cb169-2389" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted value"</span>,</span>
<span id="cb169-2390"><a href="#cb169-2390" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-2391"><a href="#cb169-2391" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2392"><a href="#cb169-2392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2393"><a href="#cb169-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2394"><a href="#cb169-2394" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and fitted values.</span>
<span id="cb169-2395"><a href="#cb169-2395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2396"><a href="#cb169-2396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2397"><a href="#cb169-2397" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-4}</span>
<span id="cb169-2400"><a href="#cb169-2400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2401"><a href="#cb169-2401" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2402"><a href="#cb169-2402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2403"><a href="#cb169-2403" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-2404"><a href="#cb169-2404" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2405"><a href="#cb169-2405" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_lev</span>(<span class="at">threshold =</span> <span class="dv">2</span>, <span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2406"><a href="#cb169-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2407"><a href="#cb169-2407" aria-hidden="true" tabindex="-1"></a>plot<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb169-2408"><a href="#cb169-2408" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2409"><a href="#cb169-2409" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-2410"><a href="#cb169-2410" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residual"</span></span>
<span id="cb169-2411"><a href="#cb169-2411" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2412"><a href="#cb169-2412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2413"><a href="#cb169-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2414"><a href="#cb169-2414" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and their leverage points.</span>
<span id="cb169-2415"><a href="#cb169-2415" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2416"><a href="#cb169-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2419"><a href="#cb169-2419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2420"><a href="#cb169-2420" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2421"><a href="#cb169-2421" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2422"><a href="#cb169-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2423"><a href="#cb169-2423" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud</span>()</span>
<span id="cb169-2424"><a href="#cb169-2424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2425"><a href="#cb169-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2428"><a href="#cb169-2428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2429"><a href="#cb169-2429" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2430"><a href="#cb169-2430" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2431"><a href="#cb169-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2432"><a href="#cb169-2432" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2433"><a href="#cb169-2433" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-2434"><a href="#cb169-2434" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"Studentized"</span>,</span>
<span id="cb169-2435"><a href="#cb169-2435" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-2436"><a href="#cb169-2436" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-2437"><a href="#cb169-2437" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2438"><a href="#cb169-2438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2439"><a href="#cb169-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2442"><a href="#cb169-2442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2443"><a href="#cb169-2443" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2444"><a href="#cb169-2444" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2445"><a href="#cb169-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2446"><a href="#cb169-2446" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_stud_fit</span>()</span>
<span id="cb169-2447"><a href="#cb169-2447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2448"><a href="#cb169-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2449"><a href="#cb169-2449" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Hat Values</span></span>
<span id="cb169-2450"><a href="#cb169-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2451"><a href="#cb169-2451" aria-hidden="true" tabindex="-1"></a>The hat value indicates how distinct an observation’s predictor values are from those of other observations. Observations with high hat values have high leverage and may be, though not necessarily, influential. There is no fixed threshold for what constitutes a “large” hat value; instead, the focus must be on observations with hat values significantly higher than the rest <span class="co">[</span><span class="ot">@nahhas2024; @hair2019, p. 261</span><span class="co">]</span>.</span>
<span id="cb169-2452"><a href="#cb169-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2455"><a href="#cb169-2455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2456"><a href="#cb169-2456" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2457"><a href="#cb169-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2458"><a href="#cb169-2458" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">hatvalues</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2459"><a href="#cb169-2459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2460"><a href="#cb169-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2461"><a href="#cb169-2461" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-5}</span>
<span id="cb169-2464"><a href="#cb169-2464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2465"><a href="#cb169-2465" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2466"><a href="#cb169-2466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2467"><a href="#cb169-2467" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-2468"><a href="#cb169-2468" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)),</span>
<span id="cb169-2469"><a href="#cb169-2469" aria-hidden="true" tabindex="-1"></a>  <span class="at">hat =</span> stats<span class="sc">::</span><span class="fu">hatvalues</span>(fit_engine)</span>
<span id="cb169-2470"><a href="#cb169-2470" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb169-2471"><a href="#cb169-2471" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb169-2472"><a href="#cb169-2472" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> hat, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> hat)</span>
<span id="cb169-2473"><a href="#cb169-2473" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2474"><a href="#cb169-2474" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_linerange</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb169-2475"><a href="#cb169-2475" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2476"><a href="#cb169-2476" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Observation"</span>,</span>
<span id="cb169-2477"><a href="#cb169-2477" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Hat value"</span></span>
<span id="cb169-2478"><a href="#cb169-2478" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2479"><a href="#cb169-2479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2480"><a href="#cb169-2480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2481"><a href="#cb169-2481" aria-hidden="true" tabindex="-1"></a>Hat values for each observation.</span>
<span id="cb169-2482"><a href="#cb169-2482" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2483"><a href="#cb169-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2486"><a href="#cb169-2486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2487"><a href="#cb169-2487" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2488"><a href="#cb169-2488" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2489"><a href="#cb169-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2490"><a href="#cb169-2490" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2491"><a href="#cb169-2491" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-2492"><a href="#cb169-2492" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"hat"</span>,</span>
<span id="cb169-2493"><a href="#cb169-2493" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-2494"><a href="#cb169-2494" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-2495"><a href="#cb169-2495" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2496"><a href="#cb169-2496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2497"><a href="#cb169-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2498"><a href="#cb169-2498" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Cook's Distance</span></span>
<span id="cb169-2499"><a href="#cb169-2499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2500"><a href="#cb169-2500" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Cook's D</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span> measures each observation's influence on the model's fitted values. It is considered one of the most representative metrics for assessing overall influence <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb169-2501"><a href="#cb169-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2502"><a href="#cb169-2502" aria-hidden="true" tabindex="-1"></a>A common practice is to flag observations with a Cook's distance of 1.0 or greater. However, a threshold of $4 / (n - k - 1)$, where $n$ is the sample size and $k$ is the number of independent variables, is suggested as a more conservative measure in small samples or for use with larger datasets <span class="co">[</span><span class="ot">@hair2019</span><span class="co">]</span>.</span>
<span id="cb169-2503"><a href="#cb169-2503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2504"><a href="#cb169-2504" aria-hidden="true" tabindex="-1"></a>Learn more about Cook's D in: @cook1977; @cook1979.</span>
<span id="cb169-2505"><a href="#cb169-2505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2508"><a href="#cb169-2508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2509"><a href="#cb169-2509" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2510"><a href="#cb169-2510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2511"><a href="#cb169-2511" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">cooks.distance</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2512"><a href="#cb169-2512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2513"><a href="#cb169-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2514"><a href="#cb169-2514" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-6}</span>
<span id="cb169-2517"><a href="#cb169-2517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2518"><a href="#cb169-2518" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2519"><a href="#cb169-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2520"><a href="#cb169-2520" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-2521"><a href="#cb169-2521" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2522"><a href="#cb169-2522" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_bar</span>(<span class="at">type =</span> <span class="dv">2</span>, <span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2523"><a href="#cb169-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2524"><a href="#cb169-2524" aria-hidden="true" tabindex="-1"></a><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span id="cb169-2525"><a href="#cb169-2525" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-2526"><a href="#cb169-2526" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-2527"><a href="#cb169-2527" aria-hidden="true" tabindex="-1"></a>q<span class="sc">$</span>data[[<span class="dv">5</span>]]<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb169-2528"><a href="#cb169-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2529"><a href="#cb169-2529" aria-hidden="true" tabindex="-1"></a>q <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-2530"><a href="#cb169-2530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2531"><a href="#cb169-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2532"><a href="#cb169-2532" aria-hidden="true" tabindex="-1"></a>Cook's distance for each observation along with a threshold line at $4 / (n - k - 1)$.</span>
<span id="cb169-2533"><a href="#cb169-2533" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2534"><a href="#cb169-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2535"><a href="#cb169-2535" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-7}</span>
<span id="cb169-2538"><a href="#cb169-2538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2539"><a href="#cb169-2539" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2540"><a href="#cb169-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2541"><a href="#cb169-2541" aria-hidden="true" tabindex="-1"></a>diag_sum_plots <span class="ot">&lt;-</span> </span>
<span id="cb169-2542"><a href="#cb169-2542" aria-hidden="true" tabindex="-1"></a>  fit_engine_2 <span class="sc">|&gt;</span> </span>
<span id="cb169-2543"><a href="#cb169-2543" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(</span>
<span id="cb169-2544"><a href="#cb169-2544" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-2545"><a href="#cb169-2545" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>, <span class="st">"black"</span>)</span>
<span id="cb169-2546"><a href="#cb169-2546" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb169-2547"><a href="#cb169-2547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">|&gt;</span></span>
<span id="cb169-2548"><a href="#cb169-2548" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">::</span><span class="fu">shush</span>()</span>
<span id="cb169-2549"><a href="#cb169-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2550"><a href="#cb169-2550" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-2551"><a href="#cb169-2551" aria-hidden="true" tabindex="-1"></a>  diag_sum_plots<span class="sc">$</span>OUTLIERS <span class="sc">+</span></span>
<span id="cb169-2552"><a href="#cb169-2552" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2553"><a href="#cb169-2553" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-2554"><a href="#cb169-2554" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-2555"><a href="#cb169-2555" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb169-2556"><a href="#cb169-2556" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Studentized residuals"</span></span>
<span id="cb169-2557"><a href="#cb169-2557" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2558"><a href="#cb169-2558" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb169-2559"><a href="#cb169-2559" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb169-2560"><a href="#cb169-2560" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb169-2561"><a href="#cb169-2561" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"gray25"</span>),</span>
<span id="cb169-2562"><a href="#cb169-2562" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb169-2563"><a href="#cb169-2563" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb169-2564"><a href="#cb169-2564" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()</span>
<span id="cb169-2565"><a href="#cb169-2565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2566"><a href="#cb169-2566" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_build</span>()</span>
<span id="cb169-2567"><a href="#cb169-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2568"><a href="#cb169-2568" aria-hidden="true" tabindex="-1"></a><span class="co"># The following procedure changes the plot aesthetics.</span></span>
<span id="cb169-2569"><a href="#cb169-2569" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) {</span>
<span id="cb169-2570"><a href="#cb169-2570" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "#1b6ca8" "#3aaf85"</span></span>
<span id="cb169-2571"><a href="#cb169-2571" aria-hidden="true" tabindex="-1"></a>  plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb169-2572"><a href="#cb169-2572" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"blue"</span> <span class="sc">~</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">4</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>),</span>
<span id="cb169-2573"><a href="#cb169-2573" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"#1b6ca8"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb169-2574"><a href="#cb169-2574" aria-hidden="true" tabindex="-1"></a>    plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour <span class="sc">==</span> <span class="st">"darkgray"</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb169-2575"><a href="#cb169-2575" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> plot<span class="sc">$</span>data[[i]]<span class="sc">$</span>colour</span>
<span id="cb169-2576"><a href="#cb169-2576" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2577"><a href="#cb169-2577" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-2578"><a href="#cb169-2578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2579"><a href="#cb169-2579" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">|&gt;</span> ggplot2<span class="sc">::</span><span class="fu">ggplot_gtable</span>() <span class="sc">|&gt;</span> ggplotify<span class="sc">::</span><span class="fu">as.ggplot</span>()</span>
<span id="cb169-2580"><a href="#cb169-2580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2581"><a href="#cb169-2581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2582"><a href="#cb169-2582" aria-hidden="true" tabindex="-1"></a>Relation between studentized residuals and their leverage points. The blue line represents the <span class="co">[</span><span class="ot">Cook's distance</span><span class="co">](https://en.wikipedia.org/wiki/Cook%27s_distance)</span>. Any points outside the contour lines are influential observations.</span>
<span id="cb169-2583"><a href="#cb169-2583" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2584"><a href="#cb169-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2587"><a href="#cb169-2587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2588"><a href="#cb169-2588" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2589"><a href="#cb169-2589" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2590"><a href="#cb169-2590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2591"><a href="#cb169-2591" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_cooksd_chart</span>()</span>
<span id="cb169-2592"><a href="#cb169-2592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2593"><a href="#cb169-2593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2596"><a href="#cb169-2596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2597"><a href="#cb169-2597" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2598"><a href="#cb169-2598" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2599"><a href="#cb169-2599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2600"><a href="#cb169-2600" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2601"><a href="#cb169-2601" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">influenceIndexPlot</span>(</span>
<span id="cb169-2602"><a href="#cb169-2602" aria-hidden="true" tabindex="-1"></a>    <span class="at">vars =</span> <span class="st">"Cook"</span>,</span>
<span id="cb169-2603"><a href="#cb169-2603" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="cn">FALSE</span>,</span>
<span id="cb169-2604"><a href="#cb169-2604" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="cn">NULL</span></span>
<span id="cb169-2605"><a href="#cb169-2605" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2606"><a href="#cb169-2606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2607"><a href="#cb169-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2608"><a href="#cb169-2608" aria-hidden="true" tabindex="-1"></a><span class="fu">#####  Influence on Prediction (DFFITS)</span></span>
<span id="cb169-2609"><a href="#cb169-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2610"><a href="#cb169-2610" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFFITS</span><span class="co">](https://en.wikipedia.org/wiki/DFFITS)</span> (difference in fits) is a standardized measure of how much the prediction for a given observation would change if it were deleted from the model. Each observation’s DFFITS is standardized by the standard deviation of fit at that point <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb169-2611"><a href="#cb169-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2612"><a href="#cb169-2612" aria-hidden="true" tabindex="-1"></a>The best rule of thumb is to classify as influential any standardized values that exceed $2 \sqrt{(p / n)}$, where $p$ is the number of independent variables + 1 and $n$ is the sample size  <span class="co">[</span><span class="ot">@hair2019, p. 261</span><span class="co">]</span>.</span>
<span id="cb169-2613"><a href="#cb169-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2614"><a href="#cb169-2614" aria-hidden="true" tabindex="-1"></a>Learn more about DDFITS in: @welsch1977 and @belsley2004.</span>
<span id="cb169-2615"><a href="#cb169-2615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2618"><a href="#cb169-2618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2619"><a href="#cb169-2619" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2620"><a href="#cb169-2620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2621"><a href="#cb169-2621" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dffits</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2622"><a href="#cb169-2622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2623"><a href="#cb169-2623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2624"><a href="#cb169-2624" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-8}</span>
<span id="cb169-2627"><a href="#cb169-2627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2628"><a href="#cb169-2628" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2629"><a href="#cb169-2629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2630"><a href="#cb169-2630" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2631"><a href="#cb169-2631" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_dffits</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2632"><a href="#cb169-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2633"><a href="#cb169-2633" aria-hidden="true" tabindex="-1"></a>plot<span class="sc">$</span>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-2634"><a href="#cb169-2634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2635"><a href="#cb169-2635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2636"><a href="#cb169-2636" aria-hidden="true" tabindex="-1"></a>Standardized DFFITS (difference in fits) for each observation.</span>
<span id="cb169-2637"><a href="#cb169-2637" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2638"><a href="#cb169-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2639"><a href="#cb169-2639" aria-hidden="true" tabindex="-1"></a><span class="fu">#####  Influence on Parameter Estimates (DFBETAS)</span></span>
<span id="cb169-2640"><a href="#cb169-2640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2641"><a href="#cb169-2641" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">DFBETAS</span><span class="co">](https://en.wikipedia.org/wiki/Influential_observation#:~:text=measures%20of%20influence)</span> are a measure of the change in a regression coefficient when an observation is omitted from the regression analysis. **The value of the DFBETA is in terms of the coefficient itself** <span class="co">[</span><span class="ot">@hair2019, p. 261</span><span class="co">]</span>. A cutoff for what is considered a large DFBETAS value is $2 / \sqrt{n}$, where $n$ is the number of observations. <span class="co">[</span><span class="ot">@struck2024</span><span class="co">]</span>.</span>
<span id="cb169-2642"><a href="#cb169-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2643"><a href="#cb169-2643" aria-hidden="true" tabindex="-1"></a>Learn more about DFBETAS in: @welsch1977 and @belsley2004.</span>
<span id="cb169-2644"><a href="#cb169-2644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2647"><a href="#cb169-2647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2648"><a href="#cb169-2648" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2649"><a href="#cb169-2649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2650"><a href="#cb169-2650" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">dfbeta</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb169-2651"><a href="#cb169-2651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2652"><a href="#cb169-2652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2655"><a href="#cb169-2655" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2656"><a href="#cb169-2656" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb169-2657"><a href="#cb169-2657" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb169-2658"><a href="#cb169-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2659"><a href="#cb169-2659" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb169-2660"><a href="#cb169-2660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel_tabset_coef_dfbetas</span>(</span>
<span id="cb169-2661"><a href="#cb169-2661" aria-hidden="true" tabindex="-1"></a>    <span class="at">heading =</span> <span class="st">"######"</span>,</span>
<span id="cb169-2662"><a href="#cb169-2662" aria-hidden="true" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">"sm-5-full-model"</span></span>
<span id="cb169-2663"><a href="#cb169-2663" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2664"><a href="#cb169-2664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2665"><a href="#cb169-2665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2666"><a href="#cb169-2666" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../qmd/_panel-tabset-coef-dfbetas-sm-5-full-model.qmd &gt;}}</span>
<span id="cb169-2667"><a href="#cb169-2667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2668"><a href="#cb169-2668" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Hadi's Measure</span></span>
<span id="cb169-2669"><a href="#cb169-2669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2670"><a href="#cb169-2670" aria-hidden="true" tabindex="-1"></a>Hadi’s measure of influence is based on the idea that influential observations can occur in either the response variable, the predictors, or both.</span>
<span id="cb169-2671"><a href="#cb169-2671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2672"><a href="#cb169-2672" aria-hidden="true" tabindex="-1"></a>Learn more about Hadi's measure in: @chatterjee2012.</span>
<span id="cb169-2673"><a href="#cb169-2673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2674"><a href="#cb169-2674" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-12}</span>
<span id="cb169-2677"><a href="#cb169-2677" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2678"><a href="#cb169-2678" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2679"><a href="#cb169-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2680"><a href="#cb169-2680" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-2681"><a href="#cb169-2681" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2682"><a href="#cb169-2682" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_hadi</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2683"><a href="#cb169-2683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2684"><a href="#cb169-2684" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span></span>
<span id="cb169-2685"><a href="#cb169-2685" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb169-2686"><a href="#cb169-2686" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-2687"><a href="#cb169-2687" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Hadi's measure"</span></span>
<span id="cb169-2688"><a href="#cb169-2688" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2689"><a href="#cb169-2689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2690"><a href="#cb169-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2691"><a href="#cb169-2691" aria-hidden="true" tabindex="-1"></a>Hadi's influence measure for each observation.</span>
<span id="cb169-2692"><a href="#cb169-2692" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2693"><a href="#cb169-2693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2694"><a href="#cb169-2694" aria-hidden="true" tabindex="-1"></a>::: {#fig-sm-5-full-model-diag-influence-13}</span>
<span id="cb169-2697"><a href="#cb169-2697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2698"><a href="#cb169-2698" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2699"><a href="#cb169-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2700"><a href="#cb169-2700" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> </span>
<span id="cb169-2701"><a href="#cb169-2701" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span> </span>
<span id="cb169-2702"><a href="#cb169-2702" aria-hidden="true" tabindex="-1"></a>  olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_pot</span>(<span class="at">print_plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2703"><a href="#cb169-2703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2704"><a href="#cb169-2704" aria-hidden="true" tabindex="-1"></a>plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb169-2705"><a href="#cb169-2705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2706"><a href="#cb169-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2707"><a href="#cb169-2707" aria-hidden="true" tabindex="-1"></a>Potential-residual plot classifying unusual observations as high-leverage points, outliers, or a combination of both.</span>
<span id="cb169-2708"><a href="#cb169-2708" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2709"><a href="#cb169-2709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2710"><a href="#cb169-2710" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis Testing</span></span>
<span id="cb169-2711"><a href="#cb169-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2712"><a href="#cb169-2712" aria-hidden="true" tabindex="-1"></a>Following the criteria outlined in the methodology supplementary material, we now address the hypothesis for this test:</span>
<span id="cb169-2713"><a href="#cb169-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2714"><a href="#cb169-2714" aria-hidden="true" tabindex="-1"></a>__Hypothesis__</span>
<span id="cb169-2715"><a href="#cb169-2715" aria-hidden="true" tabindex="-1"></a>: *Latitude is associated with chronotype distributions*, with populations closer to the equator exhibiting, on average, a shorter or more morning-oriented circadian phenotype compared to those residing near the poles.</span>
<span id="cb169-2716"><a href="#cb169-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2717"><a href="#cb169-2717" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2718"><a href="#cb169-2718" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb169-2719"><a href="#cb169-2719" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \Delta \ \text{Adjusted} \ \text{R}^{2} \leq \text{MES} \quad \text{or} \quad \text{F-test is not significant} \ (\alpha \geq 0.05) <span class="sc">\\</span></span>
<span id="cb169-2720"><a href="#cb169-2720" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \Delta \ \text{Adjusted} \ \text{R}^{2} &gt; \text{MES} \quad \text{and} \quad \text{F-test is significant} \ (\alpha &lt; 0.05)</span>
<span id="cb169-2721"><a href="#cb169-2721" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb169-2722"><a href="#cb169-2722" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2723"><a href="#cb169-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2724"><a href="#cb169-2724" aria-hidden="true" tabindex="-1"></a><span class="fu">### F-test</span></span>
<span id="cb169-2725"><a href="#cb169-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2726"><a href="#cb169-2726" aria-hidden="true" tabindex="-1"></a>The results indicate that the F-test is significant ($\alpha &lt; 0.05$), meaning that the model including the latitude variables differs from the model without them.</span>
<span id="cb169-2727"><a href="#cb169-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2728"><a href="#cb169-2728" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2729"><a href="#cb169-2729" aria-hidden="true" tabindex="-1"></a>\text{F} = \cfrac{\text{R}^{2}_{f} - \text{R}^{2}_{r} / (k_{f} - k_{R})}{(1 - \text{R}^{2}_{f}) / (\text{N} - k_{f} - 1)}</span>
<span id="cb169-2730"><a href="#cb169-2730" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2731"><a href="#cb169-2731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2734"><a href="#cb169-2734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2735"><a href="#cb169-2735" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2736"><a href="#cb169-2736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2737"><a href="#cb169-2737" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stats<span class="sc">::</span><span class="fu">anova</span>(fit_engine_restricted, fit_engine_full))</span>
<span id="cb169-2738"><a href="#cb169-2738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2739"><a href="#cb169-2739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2742"><a href="#cb169-2742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2743"><a href="#cb169-2743" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb169-2744"><a href="#cb169-2744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2745"><a href="#cb169-2745" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R/utils-stats.R"</span>))</span>
<span id="cb169-2746"><a href="#cb169-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2747"><a href="#cb169-2747" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb169-2748"><a href="#cb169-2748" aria-hidden="true" tabindex="-1"></a>k_res <span class="ot">&lt;-</span> <span class="fu">length</span>(stats<span class="sc">::</span><span class="fu">coefficients</span>(fit_engine_restricted)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb169-2749"><a href="#cb169-2749" aria-hidden="true" tabindex="-1"></a>k_full <span class="ot">&lt;-</span> <span class="fu">length</span>(stats<span class="sc">::</span><span class="fu">coefficients</span>(fit_engine_full)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb169-2750"><a href="#cb169-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2751"><a href="#cb169-2751" aria-hidden="true" tabindex="-1"></a>((<span class="fu">r_squared</span>(fit_engine_full) <span class="sc">-</span> <span class="fu">r_squared</span>(fit_engine_restricted)) <span class="sc">/</span> </span>
<span id="cb169-2752"><a href="#cb169-2752" aria-hidden="true" tabindex="-1"></a>    (k_full <span class="sc">-</span> k_res)) <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">r_squared</span>(fit_engine_full)) <span class="sc">/</span> (n  <span class="sc">-</span> k_full <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb169-2753"><a href="#cb169-2753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2754"><a href="#cb169-2754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2755"><a href="#cb169-2755" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect Size</span></span>
<span id="cb169-2756"><a href="#cb169-2756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2757"><a href="#cb169-2757" aria-hidden="true" tabindex="-1"></a>The results show that the $\Delta \ \text{Adjusted} \ \text{R}^{2}$ value is below the Minimal Effect Size (MES) threshold ($\text{R}^{2} \approx 0.01960784$), indicating that adding latitude does not meaningfully improve the model’s fit.</span>
<span id="cb169-2758"><a href="#cb169-2758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2759"><a href="#cb169-2759" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2760"><a href="#cb169-2760" aria-hidden="true" tabindex="-1"></a>\text{Cohen's } f^2 = \cfrac{\text{R}^{2}_{f} - \text{R}^{2}_{r}}{1 - \text{R}^{2}_{f}} = \cfrac{\Delta \text{R}^{2}}{1 - \text{R}^{2}_{f}}</span>
<span id="cb169-2761"><a href="#cb169-2761" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2762"><a href="#cb169-2762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2763"><a href="#cb169-2763" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2764"><a href="#cb169-2764" aria-hidden="true" tabindex="-1"></a>\text{MES} = \text{Cohen's } f^2 \text{small threshold} = 0.02 <span class="sc">\\</span></span>
<span id="cb169-2765"><a href="#cb169-2765" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2766"><a href="#cb169-2766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2767"><a href="#cb169-2767" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2768"><a href="#cb169-2768" aria-hidden="true" tabindex="-1"></a>0.02 = \cfrac{\text{R}^{2}}{1 - \text{R}^{2}} \quad \text{or} \quad \text{R}^{2} = \cfrac{0.02}{1.02} \eqsim 0.01960784</span>
<span id="cb169-2769"><a href="#cb169-2769" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb169-2770"><a href="#cb169-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2771"><a href="#cb169-2771" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-hypothesis-test-1}</span>
<span id="cb169-2774"><a href="#cb169-2774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2775"><a href="#cb169-2775" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2776"><a href="#cb169-2776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2777"><a href="#cb169-2777" aria-hidden="true" tabindex="-1"></a>adj_r_squared_restricted <span class="ot">&lt;-</span> </span>
<span id="cb169-2778"><a href="#cb169-2778" aria-hidden="true" tabindex="-1"></a>  psychometric<span class="sc">::</span><span class="fu">CI.Rsq</span>(</span>
<span id="cb169-2779"><a href="#cb169-2779" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq =</span> <span class="fu">adj_r_squared</span>(fit_engine_restricted),</span>
<span id="cb169-2780"><a href="#cb169-2780" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">nrow</span>(data),</span>
<span id="cb169-2781"><a href="#cb169-2781" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">length</span>(fit_engine_restricted<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb169-2782"><a href="#cb169-2782" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb169-2783"><a href="#cb169-2783" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2784"><a href="#cb169-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2785"><a href="#cb169-2785" aria-hidden="true" tabindex="-1"></a>adj_r_squared_restricted</span>
<span id="cb169-2786"><a href="#cb169-2786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2787"><a href="#cb169-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2788"><a href="#cb169-2788" aria-hidden="true" tabindex="-1"></a>Confidence interval for the adjusted R-squared of the **restricted model**. LCL correspond to the lower limit, and UCL to the upper limit.</span>
<span id="cb169-2789"><a href="#cb169-2789" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2790"><a href="#cb169-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2791"><a href="#cb169-2791" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-hypothesis-test-2}</span>
<span id="cb169-2794"><a href="#cb169-2794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2795"><a href="#cb169-2795" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb169-2796"><a href="#cb169-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2797"><a href="#cb169-2797" aria-hidden="true" tabindex="-1"></a>adj_r_squared_full <span class="ot">&lt;-</span></span>
<span id="cb169-2798"><a href="#cb169-2798" aria-hidden="true" tabindex="-1"></a>  psychometric<span class="sc">::</span><span class="fu">CI.Rsq</span>(</span>
<span id="cb169-2799"><a href="#cb169-2799" aria-hidden="true" tabindex="-1"></a>    <span class="at">rsq =</span> <span class="fu">adj_r_squared</span>(fit_engine_full),</span>
<span id="cb169-2800"><a href="#cb169-2800" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">nrow</span>(data),</span>
<span id="cb169-2801"><a href="#cb169-2801" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="fu">length</span>(fit_engine_full<span class="sc">$</span>coefficients) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb169-2802"><a href="#cb169-2802" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb169-2803"><a href="#cb169-2803" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2804"><a href="#cb169-2804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2805"><a href="#cb169-2805" aria-hidden="true" tabindex="-1"></a>adj_r_squared_full</span>
<span id="cb169-2806"><a href="#cb169-2806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2807"><a href="#cb169-2807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2808"><a href="#cb169-2808" aria-hidden="true" tabindex="-1"></a>Confidence interval for the adjusted R-squared of the **full model**. LCL correspond to the lower limit, and UCL to the upper limit.</span>
<span id="cb169-2809"><a href="#cb169-2809" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2810"><a href="#cb169-2810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2811"><a href="#cb169-2811" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-hypothesis-test-3}</span>
<span id="cb169-2814"><a href="#cb169-2814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2815"><a href="#cb169-2815" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb169-2816"><a href="#cb169-2816" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb169-2817"><a href="#cb169-2817" aria-hidden="true" tabindex="-1"></a>    <span class="st">"adj_r_squared_res_lcl"</span>, </span>
<span id="cb169-2818"><a href="#cb169-2818" aria-hidden="true" tabindex="-1"></a>    <span class="st">"adj_r_squared_full_ucl"</span>, </span>
<span id="cb169-2819"><a href="#cb169-2819" aria-hidden="true" tabindex="-1"></a>    <span class="st">"diff"</span></span>
<span id="cb169-2820"><a href="#cb169-2820" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb169-2821"><a href="#cb169-2821" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(</span>
<span id="cb169-2822"><a href="#cb169-2822" aria-hidden="true" tabindex="-1"></a>    adj_r_squared_restricted<span class="sc">$</span>LCL, </span>
<span id="cb169-2823"><a href="#cb169-2823" aria-hidden="true" tabindex="-1"></a>    adj_r_squared_full<span class="sc">$</span>UCL, </span>
<span id="cb169-2824"><a href="#cb169-2824" aria-hidden="true" tabindex="-1"></a>    adj_r_squared_full<span class="sc">$</span>UCL <span class="sc">-</span> adj_r_squared_restricted<span class="sc">$</span>LCL</span>
<span id="cb169-2825"><a href="#cb169-2825" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2826"><a href="#cb169-2826" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-2827"><a href="#cb169-2827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2828"><a href="#cb169-2828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2829"><a href="#cb169-2829" aria-hidden="true" tabindex="-1"></a>Comparison between the coefficients of determination ($\text{R}^2$) of the restricted and full models.</span>
<span id="cb169-2830"><a href="#cb169-2830" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2831"><a href="#cb169-2831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2832"><a href="#cb169-2832" aria-hidden="true" tabindex="-1"></a>::: {#tbl-sm-5-hypothesis-test-4}</span>
<span id="cb169-2835"><a href="#cb169-2835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb169-2836"><a href="#cb169-2836" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_f_squared_summary</span>(</span>
<span id="cb169-2837"><a href="#cb169-2837" aria-hidden="true" tabindex="-1"></a>  adj_r_squared_restricted<span class="sc">$</span>LCL, </span>
<span id="cb169-2838"><a href="#cb169-2838" aria-hidden="true" tabindex="-1"></a>  adj_r_squared_full<span class="sc">$</span>UCL</span>
<span id="cb169-2839"><a href="#cb169-2839" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb169-2840"><a href="#cb169-2840" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb169-2841"><a href="#cb169-2841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2842"><a href="#cb169-2842" aria-hidden="true" tabindex="-1"></a>Effect size between the restricted and full models based on Cohen's $f^2$.</span>
<span id="cb169-2843"><a href="#cb169-2843" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2844"><a href="#cb169-2844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2845"><a href="#cb169-2845" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb169-2846"><a href="#cb169-2846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2847"><a href="#cb169-2847" aria-hidden="true" tabindex="-1"></a>Based on the hypothesis test results, **we must reject the alternative hypothesis in favor of the null hypothesis**.</span>
<span id="cb169-2848"><a href="#cb169-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2849"><a href="#cb169-2849" aria-hidden="true" tabindex="-1"></a>With reference to the criteria outlined in the methodology supplementary material, we can now address the following question:</span>
<span id="cb169-2850"><a href="#cb169-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2851"><a href="#cb169-2851" aria-hidden="true" tabindex="-1"></a>::: {style="text-align: center; font-size: 1.1em; font-weight: bold; color: #ea7701; padding-top: 1em; padding-bottom: 1em;"}</span>
<span id="cb169-2852"><a href="#cb169-2852" aria-hidden="true" tabindex="-1"></a>Is latitude associated with chronotype?</span>
<span id="cb169-2853"><a href="#cb169-2853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb169-2854"><a href="#cb169-2854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2855"><a href="#cb169-2855" aria-hidden="true" tabindex="-1"></a>The answer is **No**. Latitude does not significantly contribute to explaining the variance in chronotype, and therefore, it cannot be considered associated with the circadian phenotype.</span>
<span id="cb169-2856"><a href="#cb169-2856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2857"><a href="#cb169-2857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final Remarks</span></span>
<span id="cb169-2858"><a href="#cb169-2858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-2859"><a href="#cb169-2859" aria-hidden="true" tabindex="-1"></a>For any questions regarding these computations, please contact the author at <span class="ot">&lt;danvartan@mail.com&gt;</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/danielvartan/mastersthesis/edit/main/qmd/supplementary-material-5.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/mastersthesis/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>