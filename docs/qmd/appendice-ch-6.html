<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Daniel Vartanian">
<title>Ecology of sleep and circadian phenotypes of the Brazilian population - Appendix E — Appendice: Chapter 6 supplemental material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/appendice-ch-5.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/appendice-ch-2.html">Appendices</a></li><li class="breadcrumb-item"><a href="../qmd/appendice-ch-6.html"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Appendice: Chapter 6 supplemental material</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Ecology of sleep and circadian phenotypes of the Brazilian population</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/danielvartan/mastersthesis/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Preliminary Pages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/corrigendum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Corrigendum</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/inscription.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inscription</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/epigraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epigraph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/abstract.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/resumo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resumo (PT-BR abstract)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/thesis-outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thesis outline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/abbreviations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abbreviations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/terms-and-definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Terms and definitions</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Similarities between different versions of the MCTQ-PT</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The {mctq} R package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ecology of sleep and circadian phenotypes of the Brazilian population</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Rule-based model of the 24h light/dark cycle entrainment phenomenon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">A biological approach for the latitudinal cline of the chronotype</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/chapter-7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Discussion and conclusions</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/appendice-ch-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Appendice: Chapter 2 supplemental material</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/appendice-ch-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Appendice: Chapter 3 supplemental material</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/appendice-ch-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Appendice: Chapter 4 supplemental material</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/appendice-ch-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Appendice: Chapter 5 supplemental material</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/appendice-ch-6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Appendice: Chapter 6 supplemental material</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#hypothesis" id="toc-hypothesis" class="nav-link active" data-scroll-target="#hypothesis"><span class="header-section-number">E.1</span> Hypothesis</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">E.2</span> Assumptions</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">E.3</span> Data preparation</a></li>
  <li>
<a href="#restricted-model" id="toc-restricted-model" class="nav-link" data-scroll-target="#restricted-model"><span class="header-section-number">E.4</span> Restricted model</a>
  <ul class="collapse">
<li><a href="#residual-diagnostics" id="toc-residual-diagnostics" class="nav-link" data-scroll-target="#residual-diagnostics"><span class="header-section-number">E.4.1</span> Residual diagnostics</a></li>
  <li><a href="#heteroskedasticity" id="toc-heteroskedasticity" class="nav-link" data-scroll-target="#heteroskedasticity"><span class="header-section-number">E.4.2</span> Heteroskedasticity</a></li>
  <li><a href="#collinearity-diagnostics" id="toc-collinearity-diagnostics" class="nav-link" data-scroll-target="#collinearity-diagnostics"><span class="header-section-number">E.4.3</span> Collinearity diagnostics</a></li>
  <li><a href="#measures-of-influence" id="toc-measures-of-influence" class="nav-link" data-scroll-target="#measures-of-influence"><span class="header-section-number">E.4.4</span> Measures of influence</a></li>
  </ul>
</li>
  <li>
<a href="#full-model" id="toc-full-model" class="nav-link" data-scroll-target="#full-model"><span class="header-section-number">E.5</span> Full model</a>
  <ul class="collapse">
<li><a href="#residual-diagnostics-1" id="toc-residual-diagnostics-1" class="nav-link" data-scroll-target="#residual-diagnostics-1"><span class="header-section-number">E.5.1</span> Residual diagnostics</a></li>
  <li><a href="#heteroskedasticity-1" id="toc-heteroskedasticity-1" class="nav-link" data-scroll-target="#heteroskedasticity-1"><span class="header-section-number">E.5.2</span> Heteroskedasticity</a></li>
  <li><a href="#collinearity-diagnostics-1" id="toc-collinearity-diagnostics-1" class="nav-link" data-scroll-target="#collinearity-diagnostics-1"><span class="header-section-number">E.5.3</span> Collinearity diagnostics</a></li>
  <li><a href="#measures-of-influence-1" id="toc-measures-of-influence-1" class="nav-link" data-scroll-target="#measures-of-influence-1"><span class="header-section-number">E.5.4</span> Measures of influence</a></li>
  </ul>
</li>
  <li><a href="#nested-regression-models-test" id="toc-nested-regression-models-test" class="nav-link" data-scroll-target="#nested-regression-models-test"><span class="header-section-number">E.6</span> Nested regression models test</a></li>
  <li><a href="#group-test" id="toc-group-test" class="nav-link" data-scroll-target="#group-test"><span class="header-section-number">E.7</span> Group test</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Appendix E — Appendice: Chapter 6 supplemental material</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You are reading the work-in-progress of this thesis. This chapter should be readable but is currently undergoing final polishing.</p>
</div>
</div>
</div>
<!--
## Some references

See @allen1997; @bussab1988; @degroot2012; @hair2019; @johnson2013; @kuhn2022; @dudek2020; @dalpiaz; @fox2016 .

Other references :

* <https://olsrr.rsquaredacademy.com>
* <https://www.r-bloggers.com/2021/05/how-to-compare-nested-models-in-r/>
* <https://www.r-bloggers.com/2022/10/box-cox-transformation-in-r/>
* <https://online.stat.psu.edu/stat501/>
-->
<section id="hypothesis" class="level2" data-number="E.1"><h2 data-number="E.1" class="anchored" data-anchor-id="hypothesis">
<span class="header-section-number">E.1</span> Hypothesis</h2>
<blockquote class="blockquote">
<p>Populations residing near the equator (latitude 0°) exhibit, on average, a shorter/morning circadian phenotype when compared to populations residing near the poles of the planet <span class="citation" data-cites="horzum2015 hut2013 leocadio-miguel2017 leocadio-miguel2014 pittendrigh1991 randler2017">(<a href="references.html#ref-horzum2015" role="doc-biblioref">Horzum et al. 2015</a>; <a href="references.html#ref-hut2013" role="doc-biblioref">Hut et al. 2013</a>; <a href="references.html#ref-leocadio-miguel2017" role="doc-biblioref">Leocadio-Miguel et al. 2017</a>, <a href="references.html#ref-leocadio-miguel2014" role="doc-biblioref">2014</a>; <a href="references.html#ref-pittendrigh1991" role="doc-biblioref">Pittendrigh, Kyner, and Takamura 1991</a>; <a href="references.html#ref-randler2017" role="doc-biblioref">Randler and Rahafar 2017</a>)</span>.</p>
</blockquote>
<p>The study hypothesis was tested using nested models of multiple linear regressions. The main idea of nested models is to verify the effect of the inclusion of one or more predictors in the model variance explanation (i.e., the <span class="math inline">\(\text{R}^{2}\)</span>) <span class="citation" data-cites="allen1997">(<a href="references.html#ref-allen1997" role="doc-biblioref">Allen 1997</a>)</span>. This can be made by creating a restricted model and then comparing it with a full model. Hence, the hypothesis can be schematized as follows.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{R}^{2}_{\text{res}} &gt;= \text{R}^{2}_{\text{full}} \\
\text{H}_{a}: \text{R}^{2}_{\text{res}} &lt; \text{R}^{2}_{\text{full}}
\end{cases}
\]</span></p>
<p>The general equation for the F-test <span class="citation" data-cites="allen1997">(<a href="references.html#ref-allen1997" role="doc-biblioref">Allen 1997, 113</a>)</span> :</p>
<p><span class="math display">\[
\text{F} = \cfrac{\text{R}^{2}_{F} - \text{R}^{2}_{R} / (k_{F} - k_{R})}{(1 - \text{R}^{2}_{F}) / (\text{N} - k_{F} - 1)}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(\text{R}^{2}_{F}\)</span> = Coefficient of determination for the <strong>full</strong> model</li>
<li>
<span class="math inline">\(\text{R}^{2}_{R}\)</span> = Coefficient of determination for the <strong>restricted</strong> model</li>
<li>
<span class="math inline">\(k_{F}\)</span> = Number of independent variables in the full model</li>
<li>
<span class="math inline">\(k_{R}\)</span> = Number of independent variables in the restricted model</li>
<li>
<span class="math inline">\(\text{N}\)</span> = Number of observations in the sample</li>
</ul>
<p><span class="math display">\[
\text{F} = \cfrac{\text{Additional Var. Explained} / \text{Additional d.f. Expended}}{\text{Var. unexplained} / \text{d.f. Remaining}}
\]</span></p>
</section><section id="assumptions" class="level2" data-number="E.2"><h2 data-number="E.2" class="anchored" data-anchor-id="assumptions">
<span class="header-section-number">E.2</span> Assumptions</h2>
<p>See <span class="citation" data-cites="degroot2012">DeGroot and Schervish (<a href="references.html#ref-degroot2012" role="doc-biblioref">2012, 736–38</a>)</span> to learn more.</p>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>The predictor is known</strong>. Either the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> are known ahead of time, or they are the observed values of random vectors <span class="math inline">\(Z_{1}, \dots , Z_{n}\)</span> on whose values we condition before computing the joint distribution of (<span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span>).</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Normality</strong>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the conditional distribution of <span class="math inline">\(Y_{i}\)</span> given the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is a normal distribution (<strong>normality assumption</strong>).</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Linear mean</strong>. There is a vector of parameters <span class="math inline">\(\beta = (\beta_{0}, \dots, \beta_{p - 1})\)</span> such that the conditional mean of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> has the form</p>
<p><span class="math display">\[
z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, n\)</span> (<strong>zero error mean assumption</strong>).</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Common variance</strong>. The observations <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> have the same variance <span class="math inline">\(\sigma^{2}\)</span> (<strong>homoscedasticity assumption</strong>).</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Independence</strong>. The random variables <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> are independent given the observed <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> (<strong>independent errors assumption</strong>).</p>
</div>
</div>
</div>
</section><section id="data-preparation" class="level2" data-number="E.3"><h2 data-number="E.3" class="anchored" data-anchor-id="data-preparation">
<span class="header-section-number">E.3</span> Data preparation</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">utc_minus_3_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Amapá"</span>, <span class="st">"Pará"</span>, <span class="st">"Maranhão"</span>, <span class="st">"Tocantins"</span>, <span class="st">"Piauí"</span>, <span class="st">"Ceará"</span>,</span>
<span>  <span class="st">"Rio Grande do Norte"</span>, <span class="st">"Paraíba"</span>, <span class="st">"Pernambuco"</span>, <span class="st">"Alagoas"</span>, <span class="st">"Sergipe"</span>,</span>
<span>  <span class="st">"Bahia"</span>, <span class="st">"Distrito Federal"</span>, <span class="st">"Goiás"</span>, <span class="st">"Minas Gerais"</span>, <span class="st">"Espírito Santo"</span>,</span>
<span>  <span class="st">"Rio de Janeiro"</span>, <span class="st">"São Paulo"</span>, <span class="st">"Paraná"</span>, <span class="st">"Santa Catarina"</span>,</span>
<span>  <span class="st">"Rio Grande do Sul"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">targets</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html">tar_read</a></span><span class="op">(</span><span class="st">"geocoded_data"</span>, store <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"_targets"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">utc_minus_3_states</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">state</span>, <span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>msf_sc <span class="op">=</span> <span class="fu">transform_time</span><span class="op">(</span><span class="va">msf_sc</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">msf_sc</span>, <span class="va">age</span>, <span class="va">sex</span>, <span class="va">latitude</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="restricted-model" class="level2" data-number="E.4"><h2 data-number="E.4" class="anchored" data-anchor-id="restricted-model">
<span class="header-section-number">E.4</span> Restricted model</h2>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">box_cox</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">msf_sc</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">box_cox</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">box_cox</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">lambda</span></span>
<span><span class="co">#&gt; [1] -1.1111</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="op">(</span><span class="va">msf_sc</span><span class="op">^</span><span class="va">lambda</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">data</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ?broom::tidy.lm</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
513579298.250
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-65.128
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13.020
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ?broom::glance.lm</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
r.squared
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
statistic
</td>
<td style="text-align:right;">
2178.876
</td>
</tr>
<tr>
<td style="text-align:left;">
p.value
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
df
</td>
<td style="text-align:right;">
2.000
</td>
</tr>
<tr>
<td style="text-align:left;">
logLik
</td>
<td style="text-align:right;">
1106194.897
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:right;">
-2212381.794
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:right;">
-2212344.801
</td>
</tr>
<tr>
<td style="text-align:left;">
deviance
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
df.residual
</td>
<td style="text-align:right;">
76741.000
</td>
</tr>
<tr>
<td style="text-align:left;">
nobs
</td>
<td style="text-align:right;">
76744.000
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># res_model |&gt; olsrr::ols_regress()</span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ((msf_sc^lambda - 1)/lambda) ~ age + sex, </span></span>
<span><span class="co">#&gt;     data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;           Min            1Q        Median            3Q           Max </span></span>
<span><span class="co">#&gt; -0.0000004859 -0.0000000911 -0.0000000031  0.0000000916  0.0000004204 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                     Estimate       Std. Error     t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.8999976603602  0.0000000017524 513579298.2   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; age         -0.0000000033812  0.0000000000519       -65.1   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sexMale      0.0000000132309  0.0000000010162        13.0   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.000000133 on 76741 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0537, Adjusted R-squared:  0.0537 </span></span>
<span><span class="co">#&gt; F-statistic: 2.18e+03 on 2 and 76741 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="residual-diagnostics" class="level3" data-number="E.4.1"><h3 data-number="E.4.1" class="anchored" data-anchor-id="residual-diagnostics">
<span class="header-section-number">E.4.1</span> Residual diagnostics</h3>
<p>Normality and zero mean error assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/stats_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
76744
</td>
</tr>
<tr>
<td style="text-align:left;">
n_rm_na
</td>
<td style="text-align:left;">
76744
</td>
</tr>
<tr>
<td style="text-align:left;">
n_na
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
6.60699976667332e-23
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
0.0000000000000176852866826985
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
0.000000132986039427823
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
-0.000000485865195534305
</td>
</tr>
<tr>
<td style="text-align:left;">
q_1
</td>
<td style="text-align:left;">
-0.0000000911138016567908
</td>
</tr>
<tr>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
-0.00000000313530324787135
</td>
</tr>
<tr>
<td style="text-align:left;">
q_3
</td>
<td style="text-align:left;">
0.000000091553820345483
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
0.000000420368932360539
</td>
</tr>
<tr>
<td style="text-align:left;">
iqr
</td>
<td style="text-align:left;">
0.000000182667622002274
</td>
</tr>
<tr>
<td style="text-align:left;">
skewness
</td>
<td style="text-align:left;">
-0.0105262146639209
</td>
</tr>
<tr>
<td style="text-align:left;">
kurtosis
</td>
<td style="text-align:left;">
2.82813923301771
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># See `?moments::agostino.test` &amp; `?fBasics::dagoTest()` to learn more.</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/scm/viewvc.php/pkg/fBasics/?root=rmetrics">fBasics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/normality_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_sum</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
test
</th>
<th style="text-align:right;">
p_value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Anderson-Darling
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Bonett-Seier
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Cramer-von Mises
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Omnibus Test
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Skewness Test
</td>
<td style="text-align:right;">
0.234
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Kurtosis Test
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Jarque–Bera
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Lilliefors (K-S)
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Pearson chi-square
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Shapiro-Francia
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Shapiro-Wilk
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Correlation between observed residuals and expected residuals under normality.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_correlation.html">ols_test_correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.99929</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/test_normality.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># res_model |&gt; olsrr::ols_plot_resid_qq()</span></span>
<span></span>
<span><span class="va">qq_plot</span> <span class="op">&lt;-</span> <span class="va">res_model</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_qq</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hist_plot</span> <span class="op">&lt;-</span> <span class="va">res_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_hist</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hist_plot</span>, <span class="va">qq_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Linear mean assumption</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_fit.html">ols_plot_resid_fit</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section><section id="heteroskedasticity" class="level3" data-number="E.4.2"><h3 data-number="E.4.2" class="anchored" data-anchor-id="heteroskedasticity">
<span class="header-section-number">E.4.2</span> Heteroskedasticity</h3>
<p>Homoscedasticity assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "It test whether variance of errors from a regression is dependent on the values of a independent variable."</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Data                           </span></span>
<span><span class="co">#&gt;  --------------------------------------------------------</span></span>
<span><span class="co">#&gt;  Response : ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    70149.3586 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    0.0000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_score.html">ols_test_score</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Score Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  ---------------------------------</span></span>
<span><span class="co">#&gt;  Ho: Variance is homogenous</span></span>
<span><span class="co">#&gt;  Ha: Variance is not homogenous</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Test Summary       </span></span>
<span><span class="co">#&gt;  ------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    0.000 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    1.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="collinearity-diagnostics" class="level3" data-number="E.4.3"><h3 data-number="E.4.3" class="anchored" data-anchor-id="collinearity-diagnostics">
<span class="header-section-number">E.4.3</span> Collinearity diagnostics</h3>
<p>Independence assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_coll_diag</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tolerance and Variance Inflation Factor</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt;   Variables Tolerance    VIF</span></span>
<span><span class="co">#&gt; 1       age    0.9988 1.0012</span></span>
<span><span class="co">#&gt; 2   sexMale    0.9988 1.0012</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalue and Condition Index</span></span>
<span><span class="co">#&gt; ------------------------------</span></span>
<span><span class="co">#&gt;   Eigenvalue Condition Index intercept      age   sexMale</span></span>
<span><span class="co">#&gt; 1   2.422418          1.0000  0.011753 0.011936 0.0669897</span></span>
<span><span class="co">#&gt; 2   0.538450          2.1211  0.015824 0.018848 0.9280439</span></span>
<span><span class="co">#&gt; 3   0.039132          7.8679  0.972423 0.969216 0.0049664</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The variance inflation factor measures how much the behavior (variance) of an independent variable is influenced, or inflated, by its interaction/correlation with the other independent variables (e.g., VIF equal to 1 = variables are not correlated).</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    age    sex </span></span>
<span><span class="co">#&gt; 1.0012 1.0012</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="measures-of-influence" class="level3" data-number="E.4.4"><h3 data-number="E.4.4" class="anchored" data-anchor-id="measures-of-influence">
<span class="header-section-number">E.4.4</span> Measures of influence</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section></section><section id="full-model" class="level2" data-number="E.5"><h2 data-number="E.5" class="anchored" data-anchor-id="full-model">
<span class="header-section-number">E.5</span> Full model</h2>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">box_cox</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span></span>
<span>  <span class="va">msf_sc</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">latitude</span>, data <span class="op">=</span> <span class="va">data</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">box_cox</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">box_cox</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span> <span class="co"># lambda</span></span>
<span><span class="co">#&gt; [1] -1.1515</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lambda</span> <span class="co"># The same lambda of the restricted model</span></span>
<span><span class="co">#&gt; [1] -1.1111</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="op">(</span><span class="va">msf_sc</span><span class="op">^</span><span class="va">lambda</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">latitude</span>, </span>
<span>  data <span class="op">=</span> <span class="va">data</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ?broom::tidy.lm</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
391908052.847
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-66.928
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sexMale
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13.558
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
latitude
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-23.852
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ?broom::glance.lm</span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
r.squared
</td>
<td style="text-align:right;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
adj.r.squared
</td>
<td style="text-align:right;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
statistic
</td>
<td style="text-align:right;">
1652.979
</td>
</tr>
<tr>
<td style="text-align:left;">
p.value
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
df
</td>
<td style="text-align:right;">
3.000
</td>
</tr>
<tr>
<td style="text-align:left;">
logLik
</td>
<td style="text-align:right;">
1106478.331
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:right;">
-2212946.661
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:right;">
-2212900.420
</td>
</tr>
<tr>
<td style="text-align:left;">
deviance
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
df.residual
</td>
<td style="text-align:right;">
76740.000
</td>
</tr>
<tr>
<td style="text-align:left;">
nobs
</td>
<td style="text-align:right;">
76744.000
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># full_model |&gt; olsrr::ols_regress()</span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ((msf_sc^lambda - 1)/lambda) ~ age + sex + </span></span>
<span><span class="co">#&gt;     latitude, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;           Min            1Q        Median            3Q           Max </span></span>
<span><span class="co">#&gt; -0.0000004874 -0.0000000911 -0.0000000034  0.0000000912  0.0000004328 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                     Estimate       Std. Error     t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.8999976247783  0.0000000022965 391908052.9   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; age         -0.0000000034710  0.0000000000519       -66.9   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sexMale      0.0000000137296  0.0000000010127        13.6   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; latitude    -0.0000000018222  0.0000000000764       -23.9   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.000000132 on 76740 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0607, Adjusted R-squared:  0.0607 </span></span>
<span><span class="co">#&gt; F-statistic: 1.65e+03 on 3 and 76740 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="residual-diagnostics-1" class="level3" data-number="E.5.1"><h3 data-number="E.5.1" class="anchored" data-anchor-id="residual-diagnostics-1">
<span class="header-section-number">E.5.1</span> Residual diagnostics</h3>
<p>Normality and zero mean error assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/stats_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
76744
</td>
</tr>
<tr>
<td style="text-align:left;">
n_rm_na
</td>
<td style="text-align:left;">
76744
</td>
</tr>
<tr>
<td style="text-align:left;">
n_na
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
4.85272564733669e-24
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
0.0000000000000175551361304561
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
0.00000013249579665203
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
-0.000000487410752460545
</td>
</tr>
<tr>
<td style="text-align:left;">
q_1
</td>
<td style="text-align:left;">
-0.0000000910649425186321
</td>
</tr>
<tr>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
-0.000000003374344652286
</td>
</tr>
<tr>
<td style="text-align:left;">
q_3
</td>
<td style="text-align:left;">
0.0000000911899588839585
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
0.000000432826012898983
</td>
</tr>
<tr>
<td style="text-align:left;">
iqr
</td>
<td style="text-align:left;">
0.000000182254901402591
</td>
</tr>
<tr>
<td style="text-align:left;">
skewness
</td>
<td style="text-align:left;">
0.000655994107765645
</td>
</tr>
<tr>
<td style="text-align:left;">
kurtosis
</td>
<td style="text-align:left;">
2.82688323293117
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/normality_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_sum</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
test
</th>
<th style="text-align:right;">
p_value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Anderson-Darling
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Bonett-Seier
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Cramer-von Mises
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Omnibus Test
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Skewness Test
</td>
<td style="text-align:right;">
0.941
</td>
</tr>
<tr>
<td style="text-align:left;">
D’Agostino Kurtosis Test
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Jarque–Bera
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Lilliefors (K-S)
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Pearson chi-square
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Shapiro-Francia
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Shapiro-Wilk
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Correlation between observed residuals and expected residuals under normality.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_correlation.html">ols_test_correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.99929</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/test_normality.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># full_model |&gt; olsrr::ols_plot_resid_qq()</span></span>
<span></span>
<span><span class="va">hist_plot</span> <span class="op">&lt;-</span> <span class="va">full_model</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_hist</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qq_plot</span> <span class="op">&lt;-</span> <span class="va">full_model</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_qq</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hist_plot</span>, <span class="va">qq_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_fit.html">ols_plot_resid_fit</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section><section id="heteroskedasticity-1" class="level3" data-number="E.5.2"><h3 data-number="E.5.2" class="anchored" data-anchor-id="heteroskedasticity-1">
<span class="header-section-number">E.5.2</span> Heteroskedasticity</h3>
<p>Homoscedasticity assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Data                           </span></span>
<span><span class="co">#&gt;  --------------------------------------------------------</span></span>
<span><span class="co">#&gt;  Response : ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    70101.1634 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    0.0000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_score.html">ols_test_score</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Score Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  ---------------------------------</span></span>
<span><span class="co">#&gt;  Ho: Variance is homogenous</span></span>
<span><span class="co">#&gt;  Ha: Variance is not homogenous</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ((msf_sc^lambda - 1)/lambda) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Test Summary       </span></span>
<span><span class="co">#&gt;  ------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    0.000 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    1.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="collinearity-diagnostics-1" class="level3" data-number="E.5.3"><h3 data-number="E.5.3" class="anchored" data-anchor-id="collinearity-diagnostics-1">
<span class="header-section-number">E.5.3</span> Collinearity diagnostics</h3>
<p>Independence assumption.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_coll_diag</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tolerance and Variance Inflation Factor</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt;   Variables Tolerance    VIF</span></span>
<span><span class="co">#&gt; 1       age   0.99354 1.0065</span></span>
<span><span class="co">#&gt; 2   sexMale   0.99838 1.0016</span></span>
<span><span class="co">#&gt; 3  latitude   0.99441 1.0056</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalue and Condition Index</span></span>
<span><span class="co">#&gt; ------------------------------</span></span>
<span><span class="co">#&gt;   Eigenvalue Condition Index  intercept       age   sexMale  latitude</span></span>
<span><span class="co">#&gt; 1   3.312504          1.0000 0.00377395 0.0064918 0.0304493 0.0068553</span></span>
<span><span class="co">#&gt; 2   0.584652          2.3803 0.00328127 0.0064143 0.9588857 0.0083393</span></span>
<span><span class="co">#&gt; 3   0.073700          6.7042 0.00040414 0.5063551 0.0023826 0.5659326</span></span>
<span><span class="co">#&gt; 4   0.029145         10.6609 0.99254063 0.4807389 0.0082824 0.4188728</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The variance inflation factor measures how much the behavior (variance) of an independent variable is influenced, or inflated, by its interaction/correlation with the other independent variables (e.g., VIF equal to 1 = variables are not correlated).</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;      age      sex latitude </span></span>
<span><span class="co">#&gt;   1.0065   1.0016   1.0056</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="measures-of-influence-1" class="level3" data-number="E.5.4"><h3 data-number="E.5.4" class="anchored" data-anchor-id="measures-of-influence-1">
<span class="header-section-number">E.5.4</span> Measures of influence</h3>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_model</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="appendice-ch-6_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section></section><section id="nested-regression-models-test" class="level2" data-number="E.6"><h2 data-number="E.6" class="anchored" data-anchor-id="nested-regression-models-test">
<span class="header-section-number">E.6</span> Nested regression models test</h2>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{R}^{2}_{\text{res}} &gt;= \text{R}^{2}_{\text{full}} \\
\text{H}_{a}: \text{R}^{2}_{\text{res}} &lt; \text{R}^{2}_{\text{full}}
\end{cases}
\]</span></p>
<p><span class="math display">\[
\text{F} = \cfrac{\text{R}^{2}_{F} - \text{R}^{2}_{R} / (k_{F} - k_{R})}{(1 - \text{R}^{2}_{F}) / (\text{N} - k_{F} - 1)}
\]</span></p>
<p><span class="math display">\[
\text{F} = \cfrac{\text{Additional Var. Explained} / \text{Additional d.f. Expended}}{\text{Var. unexplained} / \text{d.f. Remaining}}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils-stats.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_squared_res"</span>, <span class="st">"r_squared_full"</span>, <span class="st">"diff"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu">r_squared</span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span>, <span class="fu">r_squared</span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span>, </span>
<span>  <span class="fu">r_squared</span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span> <span class="op">-</span> <span class="fu">r_squared</span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
r_squared_res
</td>
<td style="text-align:right;">
0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
r_squared_full
</td>
<td style="text-align:right;">
0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
diff
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">res_model</span>, <span class="va">full_model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
Res.Df
</th>
<th style="text-align:right;">
RSS
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum of Sq
</th>
<th style="text-align:right;">
F
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
76741
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
76740
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
568.94
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils-stats.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">k_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">k_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="op">(</span><span class="op">(</span><span class="fu">r_squared</span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span> <span class="op">-</span> <span class="fu">r_squared</span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">k_full</span> <span class="op">-</span> <span class="va">k_res</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">r_squared</span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span>  <span class="op">-</span> <span class="va">k_full</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 568.94</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[
f^{2} = \cfrac{\text{R}^{2}_{F} - \text{R}^{2}_{R}}{1 - \text{R}^{2}_{F}}
\]</span></p>
<p><span class="math display">\[
f^{2} = \cfrac{\text{Additional Var. Explained}}{\text{Var. unexplained}}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/cohens_f_squared.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils-stats.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cohens_f_squared_summary</span><span class="op">(</span></span>
<span>  <span class="fu">adj_r_squared</span><span class="op">(</span><span class="va">res_model</span><span class="op">)</span>, </span>
<span>  <span class="fu">adj_r_squared</span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
f_squared
</td>
<td style="text-align:left;">
0.00740068896515648
</td>
</tr>
<tr>
<td style="text-align:left;">
effect_size
</td>
<td style="text-align:left;">
Negligible
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="group-test" class="level2" data-number="E.7"><h2 data-number="E.7" class="anchored" data-anchor-id="group-test">
<span class="header-section-number">E.7</span> Group test</h2>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{MSF}^{0^{o}}_{\text{sc}} &gt;= \text{MSF}^{30^{o}}_{\text{sc}} \\
\text{H}_{a}: \text{MSF}^{0^{o}}_{\text{sc}} &lt; \text{MSF}^{30^{o}}_{\text{sc}}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/stats_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">group_1</span> <span class="op">&lt;-</span> <span class="st">"Amapá"</span> <span class="co"># Boa vista (0° 2′ 18.84″ N, 51° 3′ 59.1″ W)</span></span>
<span></span>
<span><span class="va">msf_sc_group_1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="va">group_1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"msf_sc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_sum_group_1</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="va">group_1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"msf_sc"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_sum_group_1</span> <span class="op">|&gt;</span> <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
113
</td>
</tr>
<tr>
<td style="text-align:left;">
n_rm_na
</td>
<td style="text-align:left;">
113
</td>
</tr>
<tr>
<td style="text-align:left;">
n_na
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
103564.475347661
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
28720417.6933099
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
5359.14337308771
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
92100
</td>
</tr>
<tr>
<td style="text-align:left;">
q_1
</td>
<td style="text-align:left;">
99000
</td>
</tr>
<tr>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
104164.285714286
</td>
</tr>
<tr>
<td style="text-align:left;">
q_3
</td>
<td style="text-align:left;">
107142.857142857
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
114450
</td>
</tr>
<tr>
<td style="text-align:left;">
iqr
</td>
<td style="text-align:left;">
8142.85714285714
</td>
</tr>
<tr>
<td style="text-align:left;">
skewness
</td>
<td style="text-align:left;">
-0.0419134073448402
</td>
</tr>
<tr>
<td style="text-align:left;">
kurtosis
</td>
<td style="text-align:left;">
2.19330502090315
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/stats_sum.R"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"R/utils.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">group_2</span> <span class="op">&lt;-</span> <span class="st">"Rio Grande do Sul"</span> <span class="co"># Porto Alegre (30° 01' 58" S, 51° 13' 48" O)</span></span>
<span></span>
<span><span class="va">msf_sc_group_2</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="va">group_2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"msf_sc"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_sum_group_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="va">group_2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract2</a></span><span class="op">(</span><span class="st">"msf_sc"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_sum_group_2</span> <span class="op">|&gt;</span> <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:left;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
4097
</td>
</tr>
<tr>
<td style="text-align:left;">
n_rm_na
</td>
<td style="text-align:left;">
4097
</td>
</tr>
<tr>
<td style="text-align:left;">
n_na
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:left;">
103651.485407441
</td>
</tr>
<tr>
<td style="text-align:left;">
var
</td>
<td style="text-align:left;">
26397872.5737977
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:left;">
5137.88600241361
</td>
</tr>
<tr>
<td style="text-align:left;">
min
</td>
<td style="text-align:left;">
88092.8571428571
</td>
</tr>
<tr>
<td style="text-align:left;">
q_1
</td>
<td style="text-align:left;">
99857.1428571429
</td>
</tr>
<tr>
<td style="text-align:left;">
median
</td>
<td style="text-align:left;">
103328.571428571
</td>
</tr>
<tr>
<td style="text-align:left;">
q_3
</td>
<td style="text-align:left;">
107057.142857143
</td>
</tr>
<tr>
<td style="text-align:left;">
max
</td>
<td style="text-align:left;">
117064.285714286
</td>
</tr>
<tr>
<td style="text-align:left;">
iqr
</td>
<td style="text-align:left;">
7200
</td>
</tr>
<tr>
<td style="text-align:left;">
skewness
</td>
<td style="text-align:left;">
0.263604552812467
</td>
</tr>
<tr>
<td style="text-align:left;">
kurtosis
</td>
<td style="text-align:left;">
2.69168212740063
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">msf_sc_group_1</span>, <span class="va">msf_sc_group_2</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  msf_sc_group_1 and msf_sc_group_2</span></span>
<span><span class="co">#&gt; t = -0.17, df = 118, p-value = 0.43</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is less than 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;    -Inf 759.34</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;    103564    103651</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean_group_1"</span>, <span class="st">"mean_group_2"</span>, <span class="st">"diff"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="va">stats_sum_group_1</span><span class="op">$</span><span class="va">mean</span>, <span class="va">stats_sum_group_2</span><span class="op">$</span><span class="va">mean</span>, </span>
<span>  <span class="va">stats_sum_group_2</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">stats_sum_group_1</span><span class="op">$</span><span class="va">mean</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mean_group_1
</td>
<td style="text-align:right;">
103564.48
</td>
</tr>
<tr>
<td style="text-align:left;">
mean_group_2
</td>
<td style="text-align:right;">
103651.49
</td>
</tr>
<tr>
<td style="text-align:left;">
diff
</td>
<td style="text-align:right;">
87.01
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>See <span class="citation" data-cites="frey2022">Frey (<a href="references.html#ref-frey2022" role="doc-biblioref">2022, 224–27</a>)</span> to learn more.</p>
<p><span class="math display">\[
d = \cfrac{\mu_{1} - \mu_{2}}{\sigma_{e}}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mtorchiano/effsize/">effsize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">effsize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/effsize/man/cohen.d.html">cohen.d</a></span><span class="op">(</span><span class="va">msf_sc_group_1</span>, <span class="va">msf_sc_group_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cohen's d</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; d estimate: -0.016915 (negligible)</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;    lower    upper </span></span>
<span><span class="co">#&gt; -0.20387  0.17004</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-allen1997" class="csl-entry" role="listitem">
Allen, Michael Patrick. 1997. <em>Understanding Regression Analysis</em>. New York: Plenum Press.
</div>
<div id="ref-degroot2012" class="csl-entry" role="listitem">
DeGroot, Morris H., and Mark J. Schervish. 2012. <em>Probability and Statistics</em>. 4th ed. Boston: Addison-Wesley.
</div>
<div id="ref-frey2022" class="csl-entry" role="listitem">
Frey, Bruce B., ed. 2022. <em>The SAGE Encyclopedia of Research Design</em>. 2nd ed. Thousand Oaks,&nbsp;CA: SAGE Publications. <a href="https://doi.org/10.4135/9781071812082">https://doi.org/10.4135/9781071812082</a>.
</div>
<div id="ref-horzum2015" class="csl-entry" role="listitem">
Horzum, Mehmet Barış, Christoph Randler, Ercan Masal, Şenol Beşoluk, İsmail Önder, and Christian Vollmer. 2015. <span>“Morningness–Eveningness and the Environment Hypothesis – a Cross-Cultural Comparison of Turkish and German Adolescents.”</span> <em>Chronobiology International</em> 32 (6): 814–21. <a href="https://doi.org/10.3109/07420528.2015.1041598">https://doi.org/10.3109/07420528.2015.1041598</a>.
</div>
<div id="ref-hut2013" class="csl-entry" role="listitem">
Hut, Roelof A., Silvia Paolucci, Roi Dor, Charalambos P. Kyriacou, and Serge Daan. 2013. <span>“Latitudinal Clines: An Evolutionary View on Biological Rhythms.”</span> <em>Proceedings of the Royal Society B: Biological Sciences</em> 280 (1765): 20130433. <a href="https://doi.org/10.1098/rspb.2013.0433">https://doi.org/10.1098/rspb.2013.0433</a>.
</div>
<div id="ref-leocadio-miguel2017" class="csl-entry" role="listitem">
Leocadio-Miguel, Mario André, Fernando Mazzili Louzada, Leandro Lourenção Duarte, Roberta Peixoto Areas, Marilene Alam, Marcelo Ventura Freire, John Fontenele-Araujo, Luiz Menna-Barreto, and Mario Pedrazzoli. 2017. <span>“Latitudinal Cline of Chronotype.”</span> <em>Scientific Reports</em> 7 (1): 5437. <a href="https://doi.org/10.1038/s41598-017-05797-w">https://doi.org/10.1038/s41598-017-05797-w</a>.
</div>
<div id="ref-leocadio-miguel2014" class="csl-entry" role="listitem">
Leocadio-Miguel, Mario André, Valéria Clarisse De Oliveira, Danyella Pereira, and Mario Pedrazzoli. 2014. <span>“Detecting Chronotype Differences Associated to Latitude: A Comparison Between Horne--Östberg and Munich Chronotype Questionnaires.”</span> <em>Annals of Human Biology</em> 41 (2): 107–10. <a href="https://doi.org/10.3109/03014460.2013.832795">https://doi.org/10.3109/03014460.2013.832795</a>.
</div>
<div id="ref-pittendrigh1991" class="csl-entry" role="listitem">
Pittendrigh, Colin S., Walter T. Kyner, and Tsuguhiko Takamura. 1991. <span>“The Amplitude of Circadian Oscillations: Temperature Dependence, Latitudinal Clines, and the Photoperiodic Time Measurement.”</span> <em>Journal of Biological Rhythms</em> 6 (4): 299–313. <a href="https://doi.org/10.1177/074873049100600402">https://doi.org/10.1177/074873049100600402</a>.
</div>
<div id="ref-randler2017" class="csl-entry" role="listitem">
Randler, Christoph, and Arash Rahafar. 2017. <span>“Latitude Affects Morningness-Eveningness: Evidence for the Environment Hypothesis Based on a Systematic Review.”</span> <em>Scientific Reports</em> 7 (1): 39976. <a href="https://doi.org/10.1038/srep39976">https://doi.org/10.1038/srep39976</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../qmd/appendice-ch-5.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Appendice: Chapter 5 supplemental material</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>